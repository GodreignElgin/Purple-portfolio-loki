import{A as yh,d as wh,e as Qh,f as xh,L as Sh,N as jc,g as $i,h as Eo,F as Lt,S as xe,i as re,B as ln,k as ye,l as oe,m as Ja,T as vh,n as Ya,o as $c,M as Pe,p as zs,q as Th,P as Vc,D as zc,s as et,t as je,w as Me,V as G,I as Rh,x as Mh,O as us,y as Kc,z as Dh,G as Lh,H as Ee,J as Ut,K as ft,Q as Ot,U as Fh,W as Li,X as kh,Y as Vi,Z as it,$ as Zs,a0 as _h,a1 as Ie,a2 as Nh,a3 as Wa,a4 as Gh,a5 as Uh,a6 as Fi,a7 as zi,a8 as Ki,a9 as Co,aa as Oh,ab as Ph,ac as Hh,ad as Bo,ae as ms,af as hn,ag as un,ah as dn,ai as gn,aj as pn,ak as Jc,al as yo,am as qh,an as Ji,ao as Oo,ap as Po,aq as Ho,ar as Rt,as as wo,at as jh,au as tt,av as ki,aw as $h,ax as Xa,ay as Yc,az as Vh,aA as Za,aB as zh,aC as Wc,aD as Kh,aE as eo,aF as Le,aG as Re,aH as dt,aI as Jh,aJ as Yh,aK as Ks,aL as Wh,aM as Xh,aN as Yi,aO as Gs,aP as Us,aQ as qo,aR as jo,aS as $o,aT as fn,aU as Zh,aV as eu,aW as tu,aX as ds,aY as su,aZ as Xc,a_ as iu,a$ as Qo,b0 as mn,b1 as _i,b2 as xo,b3 as Zc,b4 as nu,b5 as oi,b6 as So,b7 as au,b8 as ou,b9 as Vo,ba as to,bb as ru,bc as Au,bd as so,be as cu,bf as lu,bg as hu,bh as el,bi as uu,bj as du,bk as gu,bl as io,bm as Js,bn as Wi}from"./three-bundle-DaMA71Ob.js";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ni=globalThis,vo=Ni.ShadowRoot&&(Ni.ShadyCSS===void 0||Ni.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,tl=Symbol(),zo=new WeakMap;let pu=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==tl)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(vo&&e===void 0){const i=t!==void 0&&t.length===1;i&&(e=zo.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&zo.set(t,e))}return e}toString(){return this.cssText}};const fu=o=>new pu(typeof o=="string"?o:o+"",void 0,tl),mu=(o,e)=>{if(vo)o.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),s=Ni.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=t.cssText,o.appendChild(i)}},Ko=vo?o=>o:o=>o instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return fu(t)})(o):o;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:bu,defineProperty:Iu,getOwnPropertyDescriptor:Eu,getOwnPropertyNames:Cu,getOwnPropertySymbols:Bu,getPrototypeOf:yu}=Object,gt=globalThis,Jo=gt.trustedTypes,wu=Jo?Jo.emptyScript:"",xn=gt.reactiveElementPolyfillSupport,Ys=(o,e)=>o,Xi={toAttribute(o,e){switch(e){case Boolean:o=o?wu:null;break;case Object:case Array:o=o==null?o:JSON.stringify(o)}return o},fromAttribute(o,e){let t=o;switch(e){case Boolean:t=o!==null;break;case Number:t=o===null?null:Number(o);break;case Object:case Array:try{t=JSON.parse(o)}catch{t=null}}return t}},To=(o,e)=>!bu(o,e),Yo={attribute:!0,type:String,converter:Xi,reflect:!1,useDefault:!1,hasChanged:To};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),gt.litPropertyMetadata??(gt.litPropertyMetadata=new WeakMap);let Mt=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Yo){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,t);s!==void 0&&Iu(this.prototype,e,s)}}static getPropertyDescriptor(e,t,i){const{get:s,set:n}=Eu(this.prototype,e)??{get(){return this[t]},set(a){this[t]=a}};return{get:s,set(a){const r=s==null?void 0:s.call(this);n==null||n.call(this,a),this.requestUpdate(e,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Yo}static _$Ei(){if(this.hasOwnProperty(Ys("elementProperties")))return;const e=yu(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ys("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ys("properties"))){const t=this.properties,i=[...Cu(t),...Bu(t)];for(const s of i)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,s]of t)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const s=this._$Eu(t,i);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)t.unshift(Ko(s))}else e!==void 0&&t.push(Ko(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return mu(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostConnected)==null?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostDisconnected)==null?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$ET(e,t){var n;const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const a=(((n=i.converter)==null?void 0:n.toAttribute)!==void 0?i.converter:Xi).toAttribute(t,i.type);this._$Em=e,a==null?this.removeAttribute(s):this.setAttribute(s,a),this._$Em=null}}_$AK(e,t){var n,a;const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const r=i.getPropertyOptions(s),A=typeof r.converter=="function"?{fromAttribute:r.converter}:((n=r.converter)==null?void 0:n.fromAttribute)!==void 0?r.converter:Xi;this._$Em=s;const c=A.fromAttribute(t,r.type);this[s]=c??((a=this._$Ej)==null?void 0:a.get(s))??c,this._$Em=null}}requestUpdate(e,t,i){var s;if(e!==void 0){const n=this.constructor,a=this[e];if(i??(i=n.getPropertyOptions(e)),!((i.hasChanged??To)(a,t)||i.useDefault&&i.reflect&&a===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(n._$Eu(e,i))))return;this.C(e,t,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:i,reflect:s,wrapped:n},a){i&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,a??t??this[e]),n!==!0||a!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(t=void 0),this._$AL.set(e,t)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,a]of this._$Ep)this[n]=a;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[n,a]of s){const{wrapped:r}=a,A=this[n];r!==!0||this._$AL.has(n)||A===void 0||this.C(n,void 0,a,A)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(i=this._$EO)==null||i.forEach(s=>{var n;return(n=s.hostUpdate)==null?void 0:n.call(s)}),this.update(t)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};Mt.elementStyles=[],Mt.shadowRootOptions={mode:"open"},Mt[Ys("elementProperties")]=new Map,Mt[Ys("finalized")]=new Map,xn==null||xn({ReactiveElement:Mt}),(gt.reactiveElementVersions??(gt.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Qu={attribute:!0,type:String,converter:Xi,reflect:!1,hasChanged:To},xu=(o=Qu,e,t)=>{const{kind:i,metadata:s}=t;let n=globalThis.litPropertyMetadata.get(s);if(n===void 0&&globalThis.litPropertyMetadata.set(s,n=new Map),i==="setter"&&((o=Object.create(o)).wrapped=!0),n.set(t.name,o),i==="accessor"){const{name:a}=t;return{set(r){const A=e.get.call(this);e.set.call(this,r),this.requestUpdate(a,A,o)},init(r){return r!==void 0&&this.C(a,void 0,o,r),r}}}if(i==="setter"){const{name:a}=t;return function(r){const A=this[a];e.call(this,r),this.requestUpdate(a,A,o)}}throw Error("Unsupported decorator location: "+i)};function _(o){return(e,t)=>typeof t=="object"?xu(o,e,t):((i,s,n)=>{const a=s.hasOwnProperty(n);return s.constructor.createProperty(n,i),a?Object.getOwnPropertyDescriptor(s,n):void 0})(o,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ws=globalThis,Zi=Ws.trustedTypes,Wo=Zi?Zi.createPolicy("lit-html",{createHTML:o=>o}):void 0,sl="$lit$",ct=`lit$${Math.random().toFixed(9).slice(2)}$`,il="?"+ct,Su=`<${il}>`,kt=document,ei=()=>kt.createComment(""),ti=o=>o===null||typeof o!="object"&&typeof o!="function",Ro=Array.isArray,vu=o=>Ro(o)||typeof(o==null?void 0:o[Symbol.iterator])=="function",Sn=`[ 	
\f\r]`,Is=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Xo=/-->/g,Zo=/>/g,bt=RegExp(`>|${Sn}(?:([^\\s"'>=/]+)(${Sn}*=${Sn}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),er=/'/g,tr=/"/g,nl=/^(?:script|style|textarea|title)$/i,Tu=o=>(e,...t)=>({_$litType$:o,strings:e,values:t}),bn=Tu(1),gs=Symbol.for("lit-noChange"),se=Symbol.for("lit-nothing"),sr=new WeakMap,Dt=kt.createTreeWalker(kt,129);function al(o,e){if(!Ro(o)||!o.hasOwnProperty("raw"))throw Error("invalid template strings array");return Wo!==void 0?Wo.createHTML(e):e}const Ru=(o,e)=>{const t=o.length-1,i=[];let s,n=e===2?"<svg>":e===3?"<math>":"",a=Is;for(let r=0;r<t;r++){const A=o[r];let c,h,l=-1,d=0;for(;d<A.length&&(a.lastIndex=d,h=a.exec(A),h!==null);)d=a.lastIndex,a===Is?h[1]==="!--"?a=Xo:h[1]!==void 0?a=Zo:h[2]!==void 0?(nl.test(h[2])&&(s=RegExp("</"+h[2],"g")),a=bt):h[3]!==void 0&&(a=bt):a===bt?h[0]===">"?(a=s??Is,l=-1):h[1]===void 0?l=-2:(l=a.lastIndex-h[2].length,c=h[1],a=h[3]===void 0?bt:h[3]==='"'?tr:er):a===tr||a===er?a=bt:a===Xo||a===Zo?a=Is:(a=bt,s=void 0);const u=a===bt&&o[r+1].startsWith("/>")?" ":"";n+=a===Is?A+Su:l>=0?(i.push(c),A.slice(0,l)+sl+A.slice(l)+ct+u):A+ct+(l===-2?r:u)}return[al(o,n+(o[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};class si{constructor({strings:e,_$litType$:t},i){let s;this.parts=[];let n=0,a=0;const r=e.length-1,A=this.parts,[c,h]=Ru(e,t);if(this.el=si.createElement(c,i),Dt.currentNode=this.el.content,t===2||t===3){const l=this.el.content.firstChild;l.replaceWith(...l.childNodes)}for(;(s=Dt.nextNode())!==null&&A.length<r;){if(s.nodeType===1){if(s.hasAttributes())for(const l of s.getAttributeNames())if(l.endsWith(sl)){const d=h[a++],u=s.getAttribute(l).split(ct),g=/([.?@])?(.*)/.exec(d);A.push({type:1,index:n,name:g[2],strings:u,ctor:g[1]==="."?Du:g[1]==="?"?Lu:g[1]==="@"?Fu:In}),s.removeAttribute(l)}else l.startsWith(ct)&&(A.push({type:6,index:n}),s.removeAttribute(l));if(nl.test(s.tagName)){const l=s.textContent.split(ct),d=l.length-1;if(d>0){s.textContent=Zi?Zi.emptyScript:"";for(let u=0;u<d;u++)s.append(l[u],ei()),Dt.nextNode(),A.push({type:2,index:++n});s.append(l[d],ei())}}}else if(s.nodeType===8)if(s.data===il)A.push({type:2,index:n});else{let l=-1;for(;(l=s.data.indexOf(ct,l+1))!==-1;)A.push({type:7,index:n}),l+=ct.length-1}n++}}static createElement(e,t){const i=kt.createElement("template");return i.innerHTML=e,i}}function ps(o,e,t=o,i){var a,r;if(e===gs)return e;let s=i!==void 0?(a=t._$Co)==null?void 0:a[i]:t._$Cl;const n=ti(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==n&&((r=s==null?void 0:s._$AO)==null||r.call(s,!1),n===void 0?s=void 0:(s=new n(o),s._$AT(o,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=s:t._$Cl=s),s!==void 0&&(e=ps(o,s._$AS(o,e.values),s,i)),e}class Mu{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,s=((e==null?void 0:e.creationScope)??kt).importNode(t,!0);Dt.currentNode=s;let n=Dt.nextNode(),a=0,r=0,A=i[0];for(;A!==void 0;){if(a===A.index){let c;A.type===2?c=new Mo(n,n.nextSibling,this,e):A.type===1?c=new A.ctor(n,A.name,A.strings,this,e):A.type===6&&(c=new ku(n,this,e)),this._$AV.push(c),A=i[++r]}a!==(A==null?void 0:A.index)&&(n=Dt.nextNode(),a++)}return Dt.currentNode=kt,s}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}let Mo=class ol{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,s){this.type=2,this._$AH=se,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=ps(this,e,t),ti(e)?e===se||e==null||e===""?(this._$AH!==se&&this._$AR(),this._$AH=se):e!==this._$AH&&e!==gs&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):vu(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==se&&ti(this._$AH)?this._$AA.nextSibling.data=e:this.T(kt.createTextNode(e)),this._$AH=e}$(e){var n;const{values:t,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=si.createElement(al(i.h,i.h[0]),this.options)),i);if(((n=this._$AH)==null?void 0:n._$AD)===s)this._$AH.p(t);else{const a=new Mu(s,this),r=a.u(this.options);a.p(t),this.T(r),this._$AH=a}}_$AC(e){let t=sr.get(e.strings);return t===void 0&&sr.set(e.strings,t=new si(e)),t}k(e){Ro(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,s=0;for(const n of e)s===t.length?t.push(i=new ol(this.O(ei()),this.O(ei()),this,this.options)):i=t[s],i._$AI(n),s++;s<t.length&&(this._$AR(i&&i._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}};class In{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,s,n){this.type=1,this._$AH=se,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=se}_$AI(e,t=this,i,s){const n=this.strings;let a=!1;if(n===void 0)e=ps(this,e,t,0),a=!ti(e)||e!==this._$AH&&e!==gs,a&&(this._$AH=e);else{const r=e;let A,c;for(e=n[0],A=0;A<n.length-1;A++)c=ps(this,r[i+A],t,A),c===gs&&(c=this._$AH[A]),a||(a=!ti(c)||c!==this._$AH[A]),c===se?e=se:e!==se&&(e+=(c??"")+n[A+1]),this._$AH[A]=c}a&&!s&&this.j(e)}j(e){e===se?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Du extends In{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===se?void 0:e}}let Lu=class extends In{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==se)}};class Fu extends In{constructor(e,t,i,s,n){super(e,t,i,s,n),this.type=5}_$AI(e,t=this){if((e=ps(this,e,t,0)??se)===gs)return;const i=this._$AH,s=e===se&&i!==se||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==se&&(i===se||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class ku{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){ps(this,e)}}const vn=Ws.litHtmlPolyfillSupport;vn==null||vn(si,Mo),(Ws.litHtmlVersions??(Ws.litHtmlVersions=[])).push("3.3.1");const rl=(o,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let s=i._$litPart$;if(s===void 0){const n=(t==null?void 0:t.renderBefore)??null;i._$litPart$=s=new Mo(e.insertBefore(ei(),n),n,void 0,t??{})}return s._$AI(o),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ft=globalThis;let Gi=class extends Mt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=rl(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return gs}};var qc;Gi._$litElement$=!0,Gi.finalized=!0,(qc=Ft.litElementHydrateSupport)==null||qc.call(Ft,{LitElement:Gi});const Tn=Ft.litElementPolyfillSupport;Tn==null||Tn({LitElement:Gi});(Ft.litElementVersions??(Ft.litElementVersions=[])).push("4.2.1");/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=navigator.xr!=null&&self.XRSession!=null&&navigator.xr.isSessionSupported!=null,cl=Al&&self.XRSession.prototype.requestHitTestSource!=null,Rn=self.ResizeObserver!=null,Mn=self.IntersectionObserver!=null,ll=cl;(()=>{const o=navigator.userAgent||navigator.vendor||self.opera;let e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(o)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(e=!0),e})();const _u=/android/i.test(navigator.userAgent),Nu=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,Gu=/firefox/i.test(navigator.userAgent),Uu=/OculusBrowser/.test(navigator.userAgent),Ou=_u&&!Gu&&!Uu,Pu=!!(window.webkit&&window.webkit.messageHandlers),ir=(()=>{if(Nu){if(Pu)return!!/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent);{const o=document.createElement("a");return!!(o.relList&&o.relList.supports&&o.relList.supports("ar"))}}else return!1})();/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=o=>o&&o!=="null"?Hu(o):null,nr=()=>{if(ll)return;const o=[];throw Al||o.push("WebXR Device API"),cl||o.push("WebXR Hit Test API"),new Error(`The following APIs are required for AR, but are missing in this browser: ${o.join(", ")}`)},Hu=o=>new URL(o,window.location.toString()).toString(),qu=(o,e)=>{let t=null;const i=(...s)=>{t==null&&(o(...s),t=self.setTimeout(()=>t=null,e))};return i.flush=()=>{t!=null&&(self.clearTimeout(t),t=null)},i},ar=(o,e)=>{let t=null;return(...i)=>{t!=null&&self.clearTimeout(t),t=self.setTimeout(()=>{t=null,o(...i)},e)}},Ue=(o,e,t)=>Math.max(e,Math.min(t,o)),or=(()=>{const o="model-viewer-debug-mode",e=new RegExp(`[?&]${o}(&|$)`);return()=>self.ModelViewerElement&&self.ModelViewerElement.debugMode||self.location&&self.location.search&&self.location.search.match(e)})(),ju=(o=0)=>new Promise(e=>setTimeout(e,o)),$u=(o,e,t=null)=>new Promise(i=>{function s(n){(!t||t(n))&&(i(n),o.removeEventListener(e,s))}o.addEventListener(e,s)});/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const Vu=.5,zu=0,Ku=1,Ju=1,Os=Symbol("currentEnvironmentMap"),Ps=Symbol("currentBackground"),en=Symbol("updateEnvironment"),ri=Symbol("cancelEnvironmentUpdate"),Yu=o=>{var e,t,i;class s extends o{constructor(){super(...arguments),this.environmentImage=null,this.skyboxImage=null,this.shadowIntensity=zu,this.shadowSoftness=Ku,this.exposure=Ju,this.toneMapping="auto",this.skyboxHeight="0",this[e]=null,this[t]=null,this[i]=null}updated(a){super.updated(a),a.has("shadowIntensity")&&(this[x].setShadowIntensity(this.shadowIntensity*Vu),this[ne]()),a.has("shadowSoftness")&&(this[x].setShadowSoftness(this.shadowSoftness),this[ne]()),a.has("exposure")&&(this[x].exposure=this.exposure,this[ne]()),a.has("toneMapping")&&(this[x].toneMapping=this.toneMapping==="aces"?yh:this.toneMapping==="agx"?wh:this.toneMapping==="reinhard"?Qh:this.toneMapping==="cineon"?xh:this.toneMapping==="linear"?Sh:this.toneMapping==="none"?jc:$i,this[ne]()),(a.has("environmentImage")||a.has("skyboxImage"))&&this[fs]()&&this[en](),a.has("skyboxHeight")&&(this[x].setGroundedSkybox(),this[ne]())}hasBakedShadow(){return this[x].bakedShadows.size>0}async[(e=Os,t=Ps,i=ri,en)](){const{skyboxImage:a,environmentImage:r}=this;this[ri]!=null&&(this[ri](),this[ri]=null);const{textureUtils:A}=this[K];if(A==null)return;const c=this[_t].beginActivity("environment-update");try{const{environmentMap:h,skybox:l}=await A.generateEnvironmentMapAndSkybox(hl(a),r,d=>c(Ue(d,0,1)),this.withCredentials);this[Os]!==h&&(this[Os]=h,this.dispatchEvent(new CustomEvent("environment-change"))),l!=null?this[Ps]=l.name===h.name?h:l:this[Ps]=null,this[x].setEnvironmentAndSkybox(this[Os],this[Ps])}catch(h){if(h instanceof Error)throw this[x].setEnvironmentAndSkybox(null,null),h}finally{c(1)}}}return It([_({type:String,attribute:"environment-image"})],s.prototype,"environmentImage",void 0),It([_({type:String,attribute:"skybox-image"})],s.prototype,"skyboxImage",void 0),It([_({type:Number,attribute:"shadow-intensity"})],s.prototype,"shadowIntensity",void 0),It([_({type:Number,attribute:"shadow-softness"})],s.prototype,"shadowSoftness",void 0),It([_({type:Number})],s.prototype,"exposure",void 0),It([_({type:String,attribute:"tone-mapping"})],s.prototype,"toneMapping",void 0),It([_({type:String,attribute:"skybox-height"})],s.prototype,"skyboxHeight",void 0),s};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wu=bn`
<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000">
    <!-- NOTE(cdata): This SVG filter is a stop-gap until we can implement
         support for dynamic re-coloring of UI components -->
    <defs>
      <filter id="drop-shadow" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
        <feOffset dx="0" dy="0" result="offsetblur"/>
        <feFlood flood-color="#000000"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <path filter="url(#drop-shadow)" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=bn`
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="36">
    <defs>
        <path id="A" d="M.001.232h24.997V36H.001z" />
    </defs>
    <g transform="translate(-11 -4)" fill="none" fill-rule="evenodd">
        <path fill-opacity="0" fill="#fff" d="M0 0h44v44H0z" />
        <g transform="translate(11 3)">
            <path d="M8.733 11.165c.04-1.108.766-2.027 1.743-2.307a2.54 2.54 0 0 1 .628-.089c.16 0 .314.017.463.044 1.088.2 1.9 1.092 1.9 2.16v8.88h1.26c2.943-1.39 5-4.45 5-8.025a9.01 9.01 0 0 0-1.9-5.56l-.43-.5c-.765-.838-1.683-1.522-2.712-2-1.057-.49-2.226-.77-3.46-.77s-2.4.278-3.46.77c-1.03.478-1.947 1.162-2.71 2l-.43.5a9.01 9.01 0 0 0-1.9 5.56 9.04 9.04 0 0 0 .094 1.305c.03.21.088.41.13.617l.136.624c.083.286.196.56.305.832l.124.333a8.78 8.78 0 0 0 .509.953l.065.122a8.69 8.69 0 0 0 3.521 3.191l1.11.537v-9.178z" fill-opacity=".5" fill="#e4e4e4" />
            <path d="M22.94 26.218l-2.76 7.74c-.172.485-.676.8-1.253.8H12.24c-1.606 0-3.092-.68-3.98-1.82-1.592-2.048-3.647-3.822-6.11-5.27-.095-.055-.15-.137-.152-.23-.004-.1.046-.196.193-.297.56-.393 1.234-.6 1.926-.6a3.43 3.43 0 0 1 .691.069l4.922.994V10.972c0-.663.615-1.203 1.37-1.203s1.373.54 1.373 1.203v9.882h2.953c.273 0 .533.073.757.21l6.257 3.874c.027.017.045.042.07.06.41.296.586.77.426 1.22M4.1 16.614c-.024-.04-.042-.083-.065-.122a8.69 8.69 0 0 1-.509-.953c-.048-.107-.08-.223-.124-.333l-.305-.832c-.058-.202-.09-.416-.136-.624l-.13-.617a9.03 9.03 0 0 1-.094-1.305c0-2.107.714-4.04 1.9-5.56l.43-.5c.764-.84 1.682-1.523 2.71-2 1.058-.49 2.226-.77 3.46-.77s2.402.28 3.46.77c1.03.477 1.947 1.16 2.712 2l.428.5a9 9 0 0 1 1.901 5.559c0 3.577-2.056 6.636-5 8.026h-1.26v-8.882c0-1.067-.822-1.96-1.9-2.16-.15-.028-.304-.044-.463-.044-.22 0-.427.037-.628.09-.977.28-1.703 1.198-1.743 2.306v9.178l-1.11-.537C6.18 19.098 4.96 18 4.1 16.614M22.97 24.09l-6.256-3.874c-.102-.063-.218-.098-.33-.144 2.683-1.8 4.354-4.855 4.354-8.243 0-.486-.037-.964-.104-1.43a9.97 9.97 0 0 0-1.57-4.128l-.295-.408-.066-.092a10.05 10.05 0 0 0-.949-1.078c-.342-.334-.708-.643-1.094-.922-1.155-.834-2.492-1.412-3.94-1.65l-.732-.088-.748-.03a9.29 9.29 0 0 0-1.482.119c-1.447.238-2.786.816-3.94 1.65a9.33 9.33 0 0 0-.813.686 9.59 9.59 0 0 0-.845.877l-.385.437-.36.5-.288.468-.418.778-.04.09c-.593 1.28-.93 2.71-.93 4.222 0 3.832 2.182 7.342 5.56 8.938l1.437.68v4.946L5 25.64a4.44 4.44 0 0 0-.888-.086c-.017 0-.034.003-.05.003-.252.004-.503.033-.75.08a5.08 5.08 0 0 0-.237.056c-.193.046-.382.107-.568.18-.075.03-.15.057-.225.1-.25.114-.494.244-.723.405a1.31 1.31 0 0 0-.566 1.122 1.28 1.28 0 0 0 .645 1.051C4 29.925 5.96 31.614 7.473 33.563a5.06 5.06 0 0 0 .434.491c1.086 1.082 2.656 1.713 4.326 1.715h6.697c.748-.001 1.43-.333 1.858-.872.142-.18.256-.38.336-.602l2.757-7.74c.094-.26.13-.53.112-.794s-.088-.52-.203-.76a2.19 2.19 0 0 0-.821-.91" fill-opacity=".6" fill="#000" />
            <path d="M22.444 24.94l-6.257-3.874a1.45 1.45 0 0 0-.757-.211h-2.953v-9.88c0-.663-.616-1.203-1.373-1.203s-1.37.54-1.37 1.203v16.643l-4.922-.994a3.44 3.44 0 0 0-.692-.069 3.35 3.35 0 0 0-1.925.598c-.147.102-.198.198-.194.298.004.094.058.176.153.23 2.462 1.448 4.517 3.22 6.11 5.27.887 1.14 2.373 1.82 3.98 1.82h6.686c.577 0 1.08-.326 1.253-.8l2.76-7.74c.16-.448-.017-.923-.426-1.22-.025-.02-.043-.043-.07-.06z" fill="#fff" />
            <g transform="translate(0 .769)">
                <mask id="B" fill="#fff">
                    <use xlink:href="#A" />
                </mask>
                <path d="M23.993 24.992a1.96 1.96 0 0 1-.111.794l-2.758 7.74c-.08.22-.194.423-.336.602-.427.54-1.11.87-1.857.872h-6.698c-1.67-.002-3.24-.633-4.326-1.715-.154-.154-.3-.318-.434-.49C5.96 30.846 4 29.157 1.646 27.773c-.385-.225-.626-.618-.645-1.05a1.31 1.31 0 0 1 .566-1.122 4.56 4.56 0 0 1 .723-.405l.225-.1a4.3 4.3 0 0 1 .568-.18l.237-.056c.248-.046.5-.075.75-.08.018 0 .034-.003.05-.003.303-.001.597.027.89.086l3.722.752V20.68l-1.436-.68c-3.377-1.596-5.56-5.106-5.56-8.938 0-1.51.336-2.94.93-4.222.015-.03.025-.06.04-.09.127-.267.268-.525.418-.778.093-.16.186-.316.288-.468.063-.095.133-.186.2-.277L3.773 5c.118-.155.26-.29.385-.437.266-.3.544-.604.845-.877a9.33 9.33 0 0 1 .813-.686C6.97 2.167 8.31 1.59 9.757 1.35a9.27 9.27 0 0 1 1.481-.119 8.82 8.82 0 0 1 .748.031c.247.02.49.05.733.088 1.448.238 2.786.816 3.94 1.65.387.28.752.588 1.094.922a9.94 9.94 0 0 1 .949 1.078l.066.092c.102.133.203.268.295.408a9.97 9.97 0 0 1 1.571 4.128c.066.467.103.945.103 1.43 0 3.388-1.67 6.453-4.353 8.243.11.046.227.08.33.144l6.256 3.874c.37.23.645.55.82.9.115.24.185.498.203.76m.697-1.195c-.265-.55-.677-1.007-1.194-1.326l-5.323-3.297c2.255-2.037 3.564-4.97 3.564-8.114 0-2.19-.637-4.304-1.84-6.114-.126-.188-.26-.37-.4-.552-.645-.848-1.402-1.6-2.252-2.204C15.472.91 13.393.232 11.238.232A10.21 10.21 0 0 0 5.23 2.19c-.848.614-1.606 1.356-2.253 2.205-.136.18-.272.363-.398.55C1.374 6.756.737 8.87.737 11.06c0 4.218 2.407 8.08 6.133 9.842l.863.41v3.092l-2.525-.51c-.356-.07-.717-.106-1.076-.106a5.45 5.45 0 0 0-3.14.996c-.653.46-1.022 1.202-.99 1.983a2.28 2.28 0 0 0 1.138 1.872c2.24 1.318 4.106 2.923 5.543 4.772 1.26 1.62 3.333 2.59 5.55 2.592h6.698c1.42-.001 2.68-.86 3.134-2.138l2.76-7.74c.272-.757.224-1.584-.134-2.325" fill-opacity=".05" fill="#000" mask="url(#B)" />
            </g>
        </g>
    </g>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu=bn`
<svg version="1.1" id="view_x5F_in_x5F_AR_x5F_icon"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px"
	 viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<rect id="Bounding_Box" x="0" y="0" fill="none" width="24" height="24"/>
<g id="Art_layer">
	<path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.35,1,1,2.35,1,4v2h2V4z"/>
	<path d="M20,3c0.55,0,1,0.45,1,1v2h2V4c0-1.65-1.35-3-3-3h-2v2H20z"/>
	<path d="M4,21c-0.55,0-1-0.45-1-1v-2H1v2c0,1.65,1.35,3,3,3h2v-2H4z"/>
	<path d="M20,21c0.55,0,1-0.45,1-1v-2h2v2c0,1.65-1.35,3-3,3h-2v-2H20z"/>
	<g>
		<path d="M18.25,7.6l-5.5-3.18c-0.46-0.27-1.04-0.27-1.5,0L5.75,7.6C5.29,7.87,5,8.36,5,8.9v6.35c0,0.54,0.29,1.03,0.75,1.3
			l5.5,3.18c0.46,0.27,1.04,0.27,1.5,0l5.5-3.18c0.46-0.27,0.75-0.76,0.75-1.3V8.9C19,8.36,18.71,7.87,18.25,7.6z M7,14.96v-4.62
			l4,2.32v4.61L7,14.96z M12,10.93L8,8.61l4-2.31l4,2.31L12,10.93z M13,17.27v-4.61l4-2.32v4.62L13,17.27z"/>
	</g>
</g>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed=bn`
<style>
:host {
  display: block;
  position: relative;
  contain: strict;
  width: 300px;
  height: 150px;
}

.container {
  position: relative;
  overflow: hidden;
}

.userInput {
  width: 100%;
  height: 100%;
  display: none;
  position: relative;
  outline-offset: -1px;
  outline-width: 1px;
}

canvas {
  position: absolute;
  display: none;
  pointer-events: none;
  /* NOTE(cdata): Chrome 76 and below apparently have a bug
   * that causes our canvas not to display pixels unless it is
   * on its own render layer
   * @see https://github.com/google/model-viewer/pull/755#issuecomment-536597893
   */
  transform: translateZ(0);
}

.show {
  display: block;
}

/* Adapted from HTML5 Boilerplate
 *
 * @see https://github.com/h5bp/html5-boilerplate/blob/ceb4620c78fc82e13534fc44202a3f168754873f/dist/css/main.css#L122-L133 */
.screen-reader-only {
  border: 0;
  left: 0;
  top: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
  pointer-events: none;
}

.slot {
  position: absolute;
  pointer-events: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.slot > * {
  pointer-events: initial;
}

.annotation-wrapper ::slotted(*) {
  opacity: var(--max-hotspot-opacity, 1);
  transition: opacity 0.3s;
}

.pointer-tumbling .annotation-wrapper ::slotted(*) {
  pointer-events: none;
}

.annotation-wrapper ::slotted(*) {
  pointer-events: initial;
}

.annotation-wrapper.hide ::slotted(*) {
  opacity: var(--min-hotspot-opacity, 0.25);
}

.slot.poster {
  display: none;
  background-color: inherit;
}

.slot.poster.show {
  display: inherit;
}

.slot.poster > * {
  pointer-events: initial;
}

.slot.poster:not(.show) > * {
  pointer-events: none;
}

#default-poster {
  width: 100%;
  height: 100%;
  /* The default poster is a <button> so we need to set display
   * to prevent it from being affected by text-align: */
  display: block;
  position: absolute;
  border: none;
  padding: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #fff0;
}

#default-progress-bar {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

#default-progress-bar > .bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--progress-bar-height, 5px);
  background-color: var(--progress-bar-color, rgba(0, 0, 0, 0.4));
  transition: transform 0.09s;
  transform-origin: top left;
  transform: scaleX(0);
  overflow: hidden;
}

#default-progress-bar > .bar.hide {
  transition: opacity 0.3s 1s;
  opacity: 0;
}

.centered {
  align-items: center;
  justify-content: center;
}

.cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.slot.interaction-prompt {
  display: var(--interaction-prompt-display, flex);
  overflow: hidden;
  opacity: 0;
  will-change: opacity;
  transition: opacity 0.3s;
}

.slot.interaction-prompt.visible {
  opacity: 1;
}

.animated-container {
  will-change: transform, opacity;
  opacity: 0;
  transition: opacity 0.3s;
}

.slot.interaction-prompt > * {
  pointer-events: none;
}

.slot.ar-button {
  -moz-user-select: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;

  display: var(--ar-button-display, block);
}

.slot.ar-button:not(.enabled) {
  display: none;
}

.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: 40px;
  height: 40px;
  cursor: pointer;
  background-color: #fff;
  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.15);
  border-radius: 100px;
}

.fab > * {
  opacity: 0.87;
}

#default-ar-button {
  position: absolute;
  bottom: 16px;
  right: 16px;
  transform: scale(var(--ar-button-scale, 1));
  transform-origin: bottom right;
}

.slot.pan-target {
  display: block;
  position: absolute;
  width: 0;
  height: 0;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0);
  background-color: transparent;
  opacity: 0;
  transition: opacity 0.3s;
}

#default-pan-target {
  width: 6px;
  height: 6px;
  border-radius: 6px;
  border: 1px solid white;
  box-shadow: 0px 0px 2px 1px rgba(0, 0, 0, 0.8);
}

.slot.default {
  pointer-events: none;
}

.slot.progress-bar {
  pointer-events: none;
}

.slot.exit-webxr-ar-button {
  pointer-events: none;
}

.slot.exit-webxr-ar-button:not(.enabled) {
  display: none;
}

#default-exit-webxr-ar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: env(safe-area-inset-top, 16px);
  right: 16px;
  width: 40px;
  height: 40px;
  box-sizing: border-box;
}

#default-exit-webxr-ar-button > svg {
  fill: #fff;
}
</style>
<div class="container">
  <div class="userInput" tabindex="0" role="img"
      aria-label="3D model">
      <div class="slot canvas">
        <slot name="canvas">
          <canvas></canvas>
        </slot>
      </div>

  </div>

  <!-- NOTE(cdata): We need to wrap slots because browsers without ShadowDOM
        will have their <slot> elements removed by ShadyCSS -->
  <div class="slot poster">
    <slot name="poster">
      <button type="button" id="default-poster" aria-hidden="true" aria-label="Loading 3D model"></button>
    </slot>
  </div>

  <div class="slot ar-button">
    <slot name="ar-button">
      <a id="default-ar-button" part="default-ar-button" class="fab"
          tabindex="2"
          role="button"
          href="javascript:void(0);"
          aria-label="View in your space">
        ${Zu}
      </a>
    </slot>
  </div>

  <div class="slot pan-target">
    <slot name="pan-target">
      <div id="default-pan-target">
      </div>
    </slot>
  </div>

  <div class="slot interaction-prompt cover centered">
    <div id="prompt" class="animated-container">
      <slot name="interaction-prompt" aria-hidden="true">
        ${Xu}
      </slot>
    </div>
  </div>

  <div id="finger0" class="animated-container cover">
    <slot name="finger0" aria-hidden="true">
    </slot>
  </div>
  <div id="finger1" class="animated-container cover">
    <slot name="finger1" aria-hidden="true">
    </slot>
  </div>

  <div class="slot default">
    <slot></slot>

    <div class="slot progress-bar">
      <slot name="progress-bar">
        <div id="default-progress-bar" aria-hidden="true">
          <div class="bar" part="default-progress-bar"></div>
        </div>
      </slot>
    </div>

    <div class="slot exit-webxr-ar-button">
      <slot name="exit-webxr-ar-button">
        <a id="default-exit-webxr-ar-button" part="default-exit-webxr-ar-button"
            tabindex="3"
            aria-label="Exit AR"
            aria-hidden="true">
          ${Wu}
        </a>
      </slot>
    </div>
  </div>
</div>
<div class="screen-reader-only" role="region" aria-label="Live announcements">
  <span id="status" role="status"></span>
</div>`,td=o=>{rl(ed,o)};var rr=function(){var o="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq;w8Wqdbk;esezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9Uc;WFbGgocjdaocjd6EhDaicefhocbhqdnindndndnaeaq9nmbaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxalc9WGgmTmecbhPawcjdfhsaohzinaraz9Rax6mvarazaxfgo9RcK6mvczhlcbhHinalgic9WfgOawcj;cbffhldndndndndnazaOco4fRbbaHcoG4ciGPlbedibkal9cb83ibalcwf9cb83ibxikalaoRblaoRbbgOco4gAaAciSgAE86bbawcj;cbfaifglcGfaoclfaAfgARbbaOcl4ciGgCaCciSgCE86bbalcVfaAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc7faAaCfgARbbaOciGgOaOciSgOE86bbalctfaAaOfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkalaoRbwaoRbbgOcl4gAaAcsSgAE86bbawcj;cbfaifglcGfaocwfaAfgARbbaOcsGgOaOcsSgOE86bbalcVfaAaOfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekalao8Pbb83bbalcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaHcdfhHaiczfhlarao9RcL0mekkaiam6mvaoTmvdnakTmbawaPfRbbhHawcj;cbfhlashiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkkascefhsaohzaPcefgPad9hmbxikkcbc99arao9Radcaadca0ESEhoxlkaoaxad2fhCdnakmbadhlinaoTmlarao9Rax6mlaoaxfhoalcufglmbkaChoxekcbhmawcjdfhAinarao9Rax6miawamfRbbhHawcj;cbfhlaAhiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkaAcefhAaoaxfhoamcefgmad9hmbkaChokabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekc9:hokavcj;ebf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklzNbb",e="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq:p9sqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:N8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhlaicefhodnaeTmbadTmbalc;WFbGglcjdalcjd6EhwcbhDinawaeaD9RaDawfae6Egqcsfglc9WGgkci2hxakcethmalcl4cifcd4hPabaDad2fhsakc;ab6hzcbhHincbhOaohAdndninaraA9RaP6meavcj;cbfaOak2fhCaAaPfhocbhidnazmbarao9Rc;Gb6mbcbhlinaCalfhidndndndndnaAalco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklbaoczfhokdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklzaoczfhokdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklaaoczfhokdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaoclfaYpQbfaXc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaocwfaYpQbfaXc:q:yjjbfRbbfhoxekaiaopbbbpkl8Waoczfhokalc;abfhialcjefak0meaihlarao9Rc;Fb0mbkkdnaiak9pmbaici4hlinarao9RcK6miaCaifhXdndndndndnaAaico4fRbbalcoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpkbbxikaXaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaXaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaXaopbbbpkbbaoczfhokalcdfhlaiczfgiak6mbkkaoTmeaohAaOcefgOclSmdxbkkc9:hoxlkdnakTmbavcjdfaHfhiavaHfpbdbhYcbhXinaiavcj;cbfaXfglpblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLalakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEalamfpblbg3cep9Ta3aQp9op9Hp9rg3alaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfhiaXczfgXak6mbkkaHclfgHad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfgDae6mbkkcbc99arao9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var s=WebAssembly.validate(t)?r(e):r(o),n,a=WebAssembly.instantiate(s,{}).then(function(m){n=m.instance,n.exports.__wasm_call_ctors()});function r(m){for(var I=new Uint8Array(m.length),C=0;C<m.length;++C){var E=m.charCodeAt(C);I[C]=E>96?E-97:E>64?E-39:E+4}for(var b=0,C=0;C<m.length;++C)I[b++]=I[C]<60?i[I[C]]:(I[C]-60)*64+I[++C];return I.buffer.slice(0,b)}function A(m,I,C,E,b,y,w){var B=m.exports.sbrk,Q=E+3&-4,S=B(Q*b),R=B(y.length),D=new Uint8Array(m.exports.memory.buffer);D.set(y,R);var k=I(S,E,b,R,y.length);if(k==0&&w&&w(S,Q,b),C.set(D.subarray(S,S+E*b)),B(S-B(0)),k!=0)throw new Error("Malformed buffer data: "+k)}var c={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},l=[],d=0;function u(m){var I={object:new Worker(m),pending:0,requests:{}};return I.object.onmessage=function(C){var E=C.data;I.pending-=E.count,I.requests[E.id][E.action](E.value),delete I.requests[E.id]},I}function g(m){for(var I="self.ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(s)+"]), {}).then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });self.onmessage = "+f.name+";"+A.toString()+f.toString(),C=new Blob([I],{type:"text/javascript"}),E=URL.createObjectURL(C),b=l.length;b<m;++b)l[b]=u(E);for(var b=m;b<l.length;++b)l[b].object.postMessage({});l.length=m,URL.revokeObjectURL(E)}function p(m,I,C,E,b){for(var y=l[0],w=1;w<l.length;++w)l[w].pending<y.pending&&(y=l[w]);return new Promise(function(B,Q){var S=new Uint8Array(C),R=++d;y.pending+=m,y.requests[R]={resolve:B,reject:Q},y.object.postMessage({id:R,count:m,size:I,source:S,mode:E,filter:b},[S.buffer])})}function f(m){var I=m.data;if(!I.id)return self.close();self.ready.then(function(C){try{var E=new Uint8Array(I.count*I.size);A(C,C.exports[I.mode],E,I.count,I.size,I.source,C.exports[I.filter]),self.postMessage({id:I.id,count:I.count,action:"resolve",value:E},[E.buffer])}catch(b){self.postMessage({id:I.id,count:I.count,action:"reject",value:b})}})}return{ready:a,supported:!0,useWorkers:function(m){g(m)},decodeVertexBuffer:function(m,I,C,E,b){A(n,n.exports.meshopt_decodeVertexBuffer,m,I,C,E,n.exports[c[b]])},decodeIndexBuffer:function(m,I,C,E){A(n,n.exports.meshopt_decodeIndexBuffer,m,I,C,E)},decodeIndexSequence:function(m,I,C,E){A(n,n.exports.meshopt_decodeIndexSequence,m,I,C,E)},decodeGltfBuffer:function(m,I,C,E,b,y){A(n,n.exports[h[b]],m,I,C,E,n.exports[c[y]])},decodeGltfBufferAsync:function(m,I,C,E,b){return l.length>0?p(m,I,C,h[E],c[b]):a.then(function(){var y=new Uint8Array(m*I);return A(n,n.exports[h[E]],y,m,I,C,n.exports[c[b]]),y})}}}();const Dn=new WeakMap;class sd extends Eo{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,s){const n=new Lt(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,a=>{this.parse(a,t,s)},i,s)}parse(e,t,i=()=>{}){this.decodeDracoFile(e,t,null,null,xe,i).catch(i)}decodeDracoFile(e,t,i,s,n=re,a=()=>{}){const r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:n};return this.decodeGeometry(e,r).then(t).catch(a)}decodeGeometry(e,t){const i=JSON.stringify(t);if(Dn.has(e)){const A=Dn.get(e);if(A.key===i)return A.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const n=this.workerNextTaskID++,a=e.byteLength,r=this._getWorker(n,a).then(A=>(s=A,new Promise((c,h)=>{s._callbacks[n]={resolve:c,reject:h},s.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(A=>this._createGeometry(A.geometry));return r.catch(()=>!0).then(()=>{s&&n&&this._releaseTask(s,n)}),Dn.set(e,{key:i,promise:r}),r}_createGeometry(e){const t=new ln;e.index&&t.setIndex(new ye(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i],n=s.name,a=s.array,r=s.itemSize,A=new ye(a,r);n==="color"&&(this._assignVertexColorSpace(A,s.vertexColorSpace),A.normalized=!(a instanceof Float32Array)),t.setAttribute(n,A)}return t}_assignVertexColorSpace(e,t){if(t!==xe)return;const i=new oe;for(let s=0,n=e.count;s<n;s++)i.fromBufferAttribute(e,s),Ja.colorSpaceToWorking(i,xe),e.setXYZ(s,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new Lt(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((s,n)=>{i.load(e,s,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const s=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const n=id.toString(),a=["/* draco decoder */",s,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(n){const a=n.data;switch(a.type){case"decode":s._callbacks[a.id].resolve(a);break;case"error":s._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,n){return s._taskLoad>n._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function id(){let o,e;onmessage=function(a){const r=a.data;switch(r.type){case"init":o=r.decoderConfig,e=new Promise(function(h){o.onModuleLoaded=function(l){h({draco:l})},DracoDecoderModule(o)});break;case"decode":const A=r.buffer,c=r.taskConfig;e.then(h=>{const l=h.draco,d=new l.Decoder;try{const u=t(l,d,new Int8Array(A),c),g=u.attributes.map(p=>p.array.buffer);u.index&&g.push(u.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:u},g)}catch(u){console.error(u),self.postMessage({type:"error",id:r.id,error:u.message})}finally{l.destroy(d)}});break}};function t(a,r,A,c){const h=c.attributeIDs,l=c.attributeTypes;let d,u;const g=r.GetEncodedGeometryType(A);if(g===a.TRIANGULAR_MESH)d=new a.Mesh,u=r.DecodeArrayToMesh(A,A.byteLength,d);else if(g===a.POINT_CLOUD)d=new a.PointCloud,u=r.DecodeArrayToPointCloud(A,A.byteLength,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!u.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+u.error_msg());const p={index:null,attributes:[]};for(const f in h){const m=self[l[f]];let I,C;if(c.useUniqueIDs)C=h[f],I=r.GetAttributeByUniqueId(d,C);else{if(C=r.GetAttributeId(d,a[h[f]]),C===-1)continue;I=r.GetAttribute(d,C)}const E=s(a,r,d,f,m,I);f==="color"&&(E.vertexColorSpace=c.vertexColorSpace),p.attributes.push(E)}return g===a.TRIANGULAR_MESH&&(p.index=i(a,r,d)),a.destroy(d),p}function i(a,r,A){const h=A.num_faces()*3,l=h*4,d=a._malloc(l);r.GetTrianglesUInt32Array(A,l,d);const u=new Uint32Array(a.HEAPF32.buffer,d,h).slice();return a._free(d),{array:u,itemSize:1}}function s(a,r,A,c,h,l){const d=l.num_components(),g=A.num_points()*d,p=g*h.BYTES_PER_ELEMENT,f=n(a,h),m=a._malloc(p);r.GetAttributeDataArrayForAllPoints(A,l,f,p,m);const I=new h(a.HEAPF32.buffer,m,g).slice();return a._free(m),{name:c,array:I,itemSize:d}}function n(a,r){switch(r){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}function Ar(o,e){if(e===vh)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Ya||e===$c){let t=o.getIndex();if(t===null){const a=[],r=o.getAttribute("position");if(r!==void 0){for(let A=0;A<r.count;A++)a.push(A);o.setIndex(a),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const i=t.count-2,s=[];if(e===Ya)for(let a=1;a<=i;a++)s.push(t.getX(0)),s.push(t.getX(a)),s.push(t.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(s.push(t.getX(a)),s.push(t.getX(a+1)),s.push(t.getX(a+2))):(s.push(t.getX(a+2)),s.push(t.getX(a+1)),s.push(t.getX(a)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const n=o.clone();return n.setIndex(s),n.clearGroups(),n}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}class nd extends Eo{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new cd(t)}),this.register(function(t){return new ld(t)}),this.register(function(t){return new Id(t)}),this.register(function(t){return new Ed(t)}),this.register(function(t){return new Cd(t)}),this.register(function(t){return new ud(t)}),this.register(function(t){return new dd(t)}),this.register(function(t){return new gd(t)}),this.register(function(t){return new pd(t)}),this.register(function(t){return new Ad(t)}),this.register(function(t){return new fd(t)}),this.register(function(t){return new hd(t)}),this.register(function(t){return new bd(t)}),this.register(function(t){return new md(t)}),this.register(function(t){return new od(t)}),this.register(function(t){return new Bd(t)}),this.register(function(t){return new yd(t)})}load(e,t,i,s){const n=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const c=zs.extractUrlBase(e);a=zs.resolveURL(c,this.path)}else a=zs.extractUrlBase(e);this.manager.itemStart(e);const r=function(c){s?s(c):console.error(c),n.manager.itemError(e),n.manager.itemEnd(e)},A=new Lt(this.manager);A.setPath(this.path),A.setResponseType("arraybuffer"),A.setRequestHeader(this.requestHeader),A.setWithCredentials(this.withCredentials),A.load(e,function(c){try{n.parse(c,a,function(h){t(h),n.manager.itemEnd(e)},r)}catch(h){r(h)}},i,r)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){let n;const a={},r={},A=new TextDecoder;if(typeof e=="string")n=JSON.parse(e);else if(e instanceof ArrayBuffer)if(A.decode(new Uint8Array(e,0,4))===ul){try{a[P.KHR_BINARY_GLTF]=new wd(e)}catch(l){s&&s(l);return}n=JSON.parse(a[P.KHR_BINARY_GLTF].content)}else n=JSON.parse(A.decode(e));else n=e;if(n.asset===void 0||n.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new Nd(n,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const l=this.pluginCallbacks[h](c);l.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),r[l.name]=l,a[l.name]=!0}if(n.extensionsUsed)for(let h=0;h<n.extensionsUsed.length;++h){const l=n.extensionsUsed[h],d=n.extensionsRequired||[];switch(l){case P.KHR_MATERIALS_UNLIT:a[l]=new rd;break;case P.KHR_DRACO_MESH_COMPRESSION:a[l]=new Qd(n,this.dracoLoader);break;case P.KHR_TEXTURE_TRANSFORM:a[l]=new xd;break;case P.KHR_MESH_QUANTIZATION:a[l]=new Sd;break;default:d.indexOf(l)>=0&&r[l]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+l+'".')}}c.setExtensions(a),c.setPlugins(r),c.parse(i,s)}parseAsync(e,t){const i=this;return new Promise(function(s,n){i.parse(e,t,s,n)})}}function ad(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const P={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class od{constructor(e){this.parser=e,this.name=P.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){const n=t[i];n.extensions&&n.extensions[this.name]&&n.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let s=t.cache.get(i);if(s)return s;const n=t.json,A=((n.extensions&&n.extensions[this.name]||{}).lights||[])[e];let c;const h=new oe(16777215);A.color!==void 0&&h.setRGB(A.color[0],A.color[1],A.color[2],re);const l=A.range!==void 0?A.range:0;switch(A.type){case"directional":c=new zc(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Vc(h),c.distance=l;break;case"spot":c=new Th(h),c.distance=l,A.spot=A.spot||{},A.spot.innerConeAngle=A.spot.innerConeAngle!==void 0?A.spot.innerConeAngle:0,A.spot.outerConeAngle=A.spot.outerConeAngle!==void 0?A.spot.outerConeAngle:Math.PI/4,c.angle=A.spot.outerConeAngle,c.penumbra=1-A.spot.innerConeAngle/A.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+A.type)}return c.position.set(0,0,0),Ze(c,A),A.intensity!==void 0&&(c.intensity=A.intensity),c.name=t.createUniqueName(A.name||"light_"+e),s=Promise.resolve(c),t.cache.add(i,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,n=i.json.nodes[e],r=(n.extensions&&n.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(A){return i._getNodeRef(t.cache,r,A)})}}let rd=class{constructor(){this.name=P.KHR_MATERIALS_UNLIT}getMaterialType(){return et}extendParams(e,t,i){const s=[];e.color=new oe(1,1,1),e.opacity=1;const n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){const a=n.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],re),e.opacity=a[3]}n.baseColorTexture!==void 0&&s.push(i.assignTexture(e,"map",n.baseColorTexture,xe))}return Promise.all(s)}},Ad=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=s.extensions[this.name].emissiveStrength;return n!==void 0&&(t.emissiveIntensity=n),Promise.resolve()}},cd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&n.push(i.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&n.push(i.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(n.push(i.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const r=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Me(r,r)}return Promise.all(n)}},ld=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=s.extensions[this.name];return t.dispersion=n.dispersion!==void 0?n.dispersion:0,Promise.resolve()}},hd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&n.push(i.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&n.push(i.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(n)}},ud=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[];t.sheenColor=new oe(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=s.extensions[this.name];if(a.sheenColorFactor!==void 0){const r=a.sheenColorFactor;t.sheenColor.setRGB(r[0],r[1],r[2],re)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&n.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,xe)),a.sheenRoughnessTexture!==void 0&&n.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(n)}},dd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&n.push(i.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(n)}},gd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&n.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const r=a.attenuationColor||[1,1,1];return t.attenuationColor=new oe().setRGB(r[0],r[1],r[2],re),Promise.all(n)}},pd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=s.extensions[this.name];return t.ior=n.ior!==void 0?n.ior:1.5,Promise.resolve()}},fd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&n.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const r=a.specularColorFactor||[1,1,1];return t.specularColor=new oe().setRGB(r[0],r[1],r[2],re),a.specularColorTexture!==void 0&&n.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,xe)),Promise.all(n)}},md=class{constructor(e){this.parser=e,this.name=P.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&n.push(i.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(n)}},bd=class{constructor(e){this.parser=e,this.name=P.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:je}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&n.push(i.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(n)}};class Id{constructor(e){this.parser=e,this.name=P.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const n=s.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,n.source,a)}}class Ed{constructor(e){this.parser=e,this.name=P.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,i=this.parser,s=i.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;const a=n.extensions[t],r=s.images[a.source];let A=i.textureLoader;if(r.uri){const c=i.options.manager.getHandler(r.uri);c!==null&&(A=c)}return i.loadTextureImage(e,a.source,A)}}class Cd{constructor(e){this.parser=e,this.name=P.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,i=this.parser,s=i.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;const a=n.extensions[t],r=s.images[a.source];let A=i.textureLoader;if(r.uri){const c=i.options.manager.getHandler(r.uri);c!==null&&(A=c)}return i.loadTextureImage(e,a.source,A)}}class Bd{constructor(e){this.name=P.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],n=this.parser.getDependency("buffer",s.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(r){const A=s.byteOffset||0,c=s.byteLength||0,h=s.count,l=s.byteStride,d=new Uint8Array(r,A,c);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(h,l,d,s.mode,s.filter).then(function(u){return u.buffer}):a.ready.then(function(){const u=new ArrayBuffer(h*l);return a.decodeGltfBuffer(new Uint8Array(u),h,l,d,s.mode,s.filter),u})})}else return null}}let yd=class{constructor(e){this.name=P.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const s=t.meshes[i.mesh];for(const c of s.primitives)if(c.mode!==ve.TRIANGLES&&c.mode!==ve.TRIANGLE_STRIP&&c.mode!==ve.TRIANGLE_FAN&&c.mode!==void 0)return null;const a=i.extensions[this.name].attributes,r=[],A={};for(const c in a)r.push(this.parser.getDependency("accessor",a[c]).then(h=>(A[c]=h,A[c])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(c=>{const h=c.pop(),l=h.isGroup?h.children:[h],d=c[0].count,u=[];for(const g of l){const p=new Pe,f=new G,m=new ms,I=new G(1,1,1),C=new Rh(g.geometry,g.material,d);for(let E=0;E<d;E++)A.TRANSLATION&&f.fromBufferAttribute(A.TRANSLATION,E),A.ROTATION&&m.fromBufferAttribute(A.ROTATION,E),A.SCALE&&I.fromBufferAttribute(A.SCALE,E),C.setMatrixAt(E,p.compose(f,m,I));for(const E in A)if(E==="_COLOR_0"){const b=A[E];C.instanceColor=new Mh(b.array,b.itemSize,b.normalized)}else E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&g.geometry.setAttribute(E,A[E]);us.prototype.copy.call(C,g),this.parser.assignFinalMaterial(C),u.push(C)}return h.isGroup?(h.clear(),h.add(...u),h):u[0]}))}};const ul="glTF",Es=12,cr={JSON:1313821514,BIN:5130562};class wd{constructor(e){this.name=P.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Es),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ul)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-Es,n=new DataView(e,Es);let a=0;for(;a<s;){const r=n.getUint32(a,!0);a+=4;const A=n.getUint32(a,!0);if(a+=4,A===cr.JSON){const c=new Uint8Array(e,Es+a,r);this.content=i.decode(c)}else if(A===cr.BIN){const c=Es+a;this.body=e.slice(c,c+r)}a+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Qd{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=P.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,s=this.dracoLoader,n=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,r={},A={},c={};for(const h in a){const l=no[h]||h.toLowerCase();r[l]=a[h]}for(const h in e.attributes){const l=no[h]||h.toLowerCase();if(a[h]!==void 0){const d=i.accessors[e.attributes[h]],u=cs[d.componentType];c[l]=u.name,A[l]=d.normalized===!0}}return t.getDependency("bufferView",n).then(function(h){return new Promise(function(l,d){s.decodeDracoFile(h,function(u){for(const g in u.attributes){const p=u.attributes[g],f=A[g];f!==void 0&&(p.normalized=f)}l(u)},r,c,re,d)})})}}class xd{constructor(){this.name=P.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Sd{constructor(){this.name=P.KHR_MESH_QUANTIZATION}}class dl extends jh{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,n=e*s*3+s;for(let a=0;a!==s;a++)t[a]=i[n+a];return t}interpolate_(e,t,i,s){const n=this.resultBuffer,a=this.sampleValues,r=this.valueSize,A=r*2,c=r*3,h=s-t,l=(i-t)/h,d=l*l,u=d*l,g=e*c,p=g-c,f=-2*u+3*d,m=u-d,I=1-f,C=m-d+l;for(let E=0;E!==r;E++){const b=a[p+E+r],y=a[p+E+A]*h,w=a[g+E+r],B=a[g+E]*h;n[E]=I*b+C*y+f*w+m*B}return n}}const vd=new ms;class Td extends dl{interpolate_(e,t,i,s){const n=super.interpolate_(e,t,i,s);return vd.fromArray(n).normalize().toArray(n),n}}const ve={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},cs={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},lr={9728:Ot,9729:Ee,9984:hn,9985:un,9986:dn,9987:Ut},hr={33071:gn,33648:pn,10497:ft},Ln={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},no={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},nt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Rd={CUBICSPLINE:void 0,LINEAR:Bo,STEP:Jc},Fn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Md(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new Vi({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:yo})),o.DefaultMaterial}function Et(o,e,t){for(const i in t.extensions)o[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Ze(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Dd(o,e,t){let i=!1,s=!1,n=!1;for(let c=0,h=e.length;c<h;c++){const l=e[c];if(l.POSITION!==void 0&&(i=!0),l.NORMAL!==void 0&&(s=!0),l.COLOR_0!==void 0&&(n=!0),i&&s&&n)break}if(!i&&!s&&!n)return Promise.resolve(o);const a=[],r=[],A=[];for(let c=0,h=e.length;c<h;c++){const l=e[c];if(i){const d=l.POSITION!==void 0?t.getDependency("accessor",l.POSITION):o.attributes.position;a.push(d)}if(s){const d=l.NORMAL!==void 0?t.getDependency("accessor",l.NORMAL):o.attributes.normal;r.push(d)}if(n){const d=l.COLOR_0!==void 0?t.getDependency("accessor",l.COLOR_0):o.attributes.color;A.push(d)}}return Promise.all([Promise.all(a),Promise.all(r),Promise.all(A)]).then(function(c){const h=c[0],l=c[1],d=c[2];return i&&(o.morphAttributes.position=h),s&&(o.morphAttributes.normal=l),n&&(o.morphAttributes.color=d),o.morphTargetsRelative=!0,o})}function Ld(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let i=0,s=t.length;i<s;i++)o.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Fd(o){let e;const t=o.extensions&&o.extensions[P.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+kn(t.attributes):e=o.indices+":"+kn(o.attributes)+":"+o.mode,o.targets!==void 0)for(let i=0,s=o.targets.length;i<s;i++)e+=":"+kn(o.targets[i]);return e}function kn(o){let e="";const t=Object.keys(o).sort();for(let i=0,s=t.length;i<s;i++)e+=t[i]+":"+o[t[i]]+";";return e}function ao(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function kd(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":o.search(/\.ktx2($|\?)/i)>0||o.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const _d=new Pe;class Nd{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ad,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=-1,n=!1,a=-1;if(typeof navigator<"u"){const r=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(r)===!0;const A=r.match(/Version\/(\d+)/);s=i&&A?parseInt(A[1],10):-1,n=r.indexOf("Firefox")>-1,a=n?r.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&s<17||n&&a<98?this.textureLoader=new Kc(this.options.manager):this.textureLoader=new Dh(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Lt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,s=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const r={scene:a[0][s.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:s.asset,parser:i,userData:{}};return Et(n,r,s),Ze(r,s),Promise.all(i._invokeAll(function(A){return A.afterRoot&&A.afterRoot(r)})).then(function(){for(const A of r.scenes)A.updateMatrixWorld();e(r)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let s=0,n=t.length;s<n;s++){const a=t[s].joints;for(let r=0,A=a.length;r<A;r++)e[a[r]].isBone=!0}for(let s=0,n=e.length;s<n;s++){const a=e[s];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(i[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const s=i.clone(),n=(a,r)=>{const A=this.associations.get(a);A!=null&&this.associations.set(r,A);for(const[c,h]of a.children.entries())n(h,r.children[c])};return n(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const s=e(t[i]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let s=0;s<t.length;s++){const n=e(t[s]);n&&i.push(n)}return i}getDependency(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(n){return n.loadNode&&n.loadNode(t)});break;case"mesh":s=this._invokeOne(function(n){return n.loadMesh&&n.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(n){return n.loadBufferView&&n.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(n){return n.loadMaterial&&n.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(n){return n.loadTexture&&n.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(n){return n.loadAnimation&&n.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(n,a){return i.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[P.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(n,a){i.load(zs.resolveURL(t.uri,s.path),n,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteLength||0,n=t.byteOffset||0;return i.slice(n,n+s)})}loadAccessor(e){const t=this,i=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const a=Ln[s.type],r=cs[s.componentType],A=s.normalized===!0,c=new r(s.count*a);return Promise.resolve(new ye(c,a,A))}const n=[];return s.bufferView!==void 0?n.push(this.getDependency("bufferView",s.bufferView)):n.push(null),s.sparse!==void 0&&(n.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(n).then(function(a){const r=a[0],A=Ln[s.type],c=cs[s.componentType],h=c.BYTES_PER_ELEMENT,l=h*A,d=s.byteOffset||0,u=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,g=s.normalized===!0;let p,f;if(u&&u!==l){const m=Math.floor(d/u),I="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+m+":"+s.count;let C=t.cache.get(I);C||(p=new c(r,m*u,s.count*u/h),C=new Lh(p,u/h),t.cache.add(I,C)),f=new qh(C,A,d%u/h,g)}else r===null?p=new c(s.count*A):p=new c(r,d,s.count*A),f=new ye(p,A,g);if(s.sparse!==void 0){const m=Ln.SCALAR,I=cs[s.sparse.indices.componentType],C=s.sparse.indices.byteOffset||0,E=s.sparse.values.byteOffset||0,b=new I(a[1],C,s.sparse.count*m),y=new c(a[2],E,s.sparse.count*A);r!==null&&(f=new ye(f.array.slice(),f.itemSize,f.normalized)),f.normalized=!1;for(let w=0,B=b.length;w<B;w++){const Q=b[w];if(f.setX(Q,y[w*A]),A>=2&&f.setY(Q,y[w*A+1]),A>=3&&f.setZ(Q,y[w*A+2]),A>=4&&f.setW(Q,y[w*A+3]),A>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}f.normalized=g}return f})}loadTexture(e){const t=this.json,i=this.options,n=t.textures[e].source,a=t.images[n];let r=this.textureLoader;if(a.uri){const A=i.manager.getHandler(a.uri);A!==null&&(r=A)}return this.loadTextureImage(e,n,r)}loadTextureImage(e,t,i){const s=this,n=this.json,a=n.textures[e],r=n.images[t],A=(r.uri||r.bufferView)+":"+a.sampler;if(this.textureCache[A])return this.textureCache[A];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=a.name||r.name||"",h.name===""&&typeof r.uri=="string"&&r.uri.startsWith("data:image/")===!1&&(h.name=r.uri);const d=(n.samplers||{})[a.sampler]||{};return h.magFilter=lr[d.magFilter]||Ee,h.minFilter=lr[d.minFilter]||Ut,h.wrapS=hr[d.wrapS]||ft,h.wrapT=hr[d.wrapT]||ft,h.generateMipmaps=!h.isCompressedTexture&&h.minFilter!==Ot&&h.minFilter!==Ee,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[A]=c,c}loadImageSource(e,t){const i=this,s=this.json,n=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(l=>l.clone());const a=s.images[e],r=self.URL||self.webkitURL;let A=a.uri||"",c=!1;if(a.bufferView!==void 0)A=i.getDependency("bufferView",a.bufferView).then(function(l){c=!0;const d=new Blob([l],{type:a.mimeType});return A=r.createObjectURL(d),A});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(A).then(function(l){return new Promise(function(d,u){let g=d;t.isImageBitmapLoader===!0&&(g=function(p){const f=new Ji(p);f.needsUpdate=!0,d(f)}),t.load(zs.resolveURL(l,n.path),g,void 0,u)})}).then(function(l){return c===!0&&r.revokeObjectURL(A),Ze(l,a),l.userData.mimeType=a.mimeType||kd(a.uri),l}).catch(function(l){throw console.error("THREE.GLTFLoader: Couldn't load texture",A),l});return this.sourceCache[e]=h,h}assignTexture(e,t,i,s){const n=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(a=a.clone(),a.channel=i.texCoord),n.extensions[P.KHR_TEXTURE_TRANSFORM]){const r=i.extensions!==void 0?i.extensions[P.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const A=n.associations.get(a);a=n.extensions[P.KHR_TEXTURE_TRANSFORM].extendTexture(a,r),n.associations.set(a,A)}}return s!==void 0&&(a.colorSpace=s),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const s=t.attributes.tangent===void 0,n=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const r="PointsMaterial:"+i.uuid;let A=this.cache.get(r);A||(A=new Fh,Li.prototype.copy.call(A,i),A.color.copy(i.color),A.map=i.map,A.sizeAttenuation=!1,this.cache.add(r,A)),i=A}else if(e.isLine){const r="LineBasicMaterial:"+i.uuid;let A=this.cache.get(r);A||(A=new kh,Li.prototype.copy.call(A,i),A.color.copy(i.color),A.map=i.map,this.cache.add(r,A)),i=A}if(s||n||a){let r="ClonedMaterial:"+i.uuid+":";s&&(r+="derivative-tangents:"),n&&(r+="vertex-colors:"),a&&(r+="flat-shading:");let A=this.cache.get(r);A||(A=i.clone(),n&&(A.vertexColors=!0),a&&(A.flatShading=!0),s&&(A.normalScale&&(A.normalScale.y*=-1),A.clearcoatNormalScale&&(A.clearcoatNormalScale.y*=-1)),this.cache.add(r,A),this.associations.set(A,this.associations.get(i))),i=A}e.material=i}getMaterialType(){return Vi}loadMaterial(e){const t=this,i=this.json,s=this.extensions,n=i.materials[e];let a;const r={},A=n.extensions||{},c=[];if(A[P.KHR_MATERIALS_UNLIT]){const l=s[P.KHR_MATERIALS_UNLIT];a=l.getMaterialType(),c.push(l.extendParams(r,n,t))}else{const l=n.pbrMetallicRoughness||{};if(r.color=new oe(1,1,1),r.opacity=1,Array.isArray(l.baseColorFactor)){const d=l.baseColorFactor;r.color.setRGB(d[0],d[1],d[2],re),r.opacity=d[3]}l.baseColorTexture!==void 0&&c.push(t.assignTexture(r,"map",l.baseColorTexture,xe)),r.metalness=l.metallicFactor!==void 0?l.metallicFactor:1,r.roughness=l.roughnessFactor!==void 0?l.roughnessFactor:1,l.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(r,"metalnessMap",l.metallicRoughnessTexture)),c.push(t.assignTexture(r,"roughnessMap",l.metallicRoughnessTexture))),a=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,r)})))}n.doubleSided===!0&&(r.side=it);const h=n.alphaMode||Fn.OPAQUE;if(h===Fn.BLEND?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,h===Fn.MASK&&(r.alphaTest=n.alphaCutoff!==void 0?n.alphaCutoff:.5)),n.normalTexture!==void 0&&a!==et&&(c.push(t.assignTexture(r,"normalMap",n.normalTexture)),r.normalScale=new Me(1,1),n.normalTexture.scale!==void 0)){const l=n.normalTexture.scale;r.normalScale.set(l,l)}if(n.occlusionTexture!==void 0&&a!==et&&(c.push(t.assignTexture(r,"aoMap",n.occlusionTexture)),n.occlusionTexture.strength!==void 0&&(r.aoMapIntensity=n.occlusionTexture.strength)),n.emissiveFactor!==void 0&&a!==et){const l=n.emissiveFactor;r.emissive=new oe().setRGB(l[0],l[1],l[2],re)}return n.emissiveTexture!==void 0&&a!==et&&c.push(t.assignTexture(r,"emissiveMap",n.emissiveTexture,xe)),Promise.all(c).then(function(){const l=new a(r);return n.name&&(l.name=n.name),Ze(l,n),t.associations.set(l,{materials:e}),n.extensions&&Et(s,l,n),l})}createUniqueName(e){const t=Zs.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,s=this.primitiveCache;function n(r){return i[P.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,t).then(function(A){return ur(A,r,t)})}const a=[];for(let r=0,A=e.length;r<A;r++){const c=e[r],h=Fd(c),l=s[h];if(l)a.push(l.promise);else{let d;c.extensions&&c.extensions[P.KHR_DRACO_MESH_COMPRESSION]?d=n(c):d=ur(new ln,c,t),s[h]={primitive:c,promise:d},a.push(d)}}return Promise.all(a)}loadMesh(e){const t=this,i=this.json,s=this.extensions,n=i.meshes[e],a=n.primitives,r=[];for(let A=0,c=a.length;A<c;A++){const h=a[A].material===void 0?Md(this.cache):this.getDependency("material",a[A].material);r.push(h)}return r.push(t.loadGeometries(a)),Promise.all(r).then(function(A){const c=A.slice(0,A.length-1),h=A[A.length-1],l=[];for(let u=0,g=h.length;u<g;u++){const p=h[u],f=a[u];let m;const I=c[u];if(f.mode===ve.TRIANGLES||f.mode===ve.TRIANGLE_STRIP||f.mode===ve.TRIANGLE_FAN||f.mode===void 0)m=n.isSkinnedMesh===!0?new _h(p,I):new Ie(p,I),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),f.mode===ve.TRIANGLE_STRIP?m.geometry=Ar(m.geometry,$c):f.mode===ve.TRIANGLE_FAN&&(m.geometry=Ar(m.geometry,Ya));else if(f.mode===ve.LINES)m=new Nh(p,I);else if(f.mode===ve.LINE_STRIP)m=new Wa(p,I);else if(f.mode===ve.LINE_LOOP)m=new Gh(p,I);else if(f.mode===ve.POINTS)m=new Uh(p,I);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(m.geometry.morphAttributes).length>0&&Ld(m,n),m.name=t.createUniqueName(n.name||"mesh_"+e),Ze(m,n),f.extensions&&Et(s,m,f),t.assignFinalMaterial(m),l.push(m)}for(let u=0,g=l.length;u<g;u++)t.associations.set(l[u],{meshes:e,primitives:u});if(l.length===1)return n.extensions&&Et(s,l[0],n),l[0];const d=new Fi;n.extensions&&Et(s,d,n),t.associations.set(d,{meshes:e});for(let u=0,g=l.length;u<g;u++)d.add(l[u]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new zi(Ki.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(t=new Co(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Ze(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let s=0,n=t.joints.length;s<n;s++)i.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){const n=s.pop(),a=s,r=[],A=[];for(let c=0,h=a.length;c<h;c++){const l=a[c];if(l){r.push(l);const d=new Pe;n!==null&&d.fromArray(n.array,c*16),A.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Oh(r,A)})}loadAnimation(e){const t=this.json,i=this,s=t.animations[e],n=s.name?s.name:"animation_"+e,a=[],r=[],A=[],c=[],h=[];for(let l=0,d=s.channels.length;l<d;l++){const u=s.channels[l],g=s.samplers[u.sampler],p=u.target,f=p.node,m=s.parameters!==void 0?s.parameters[g.input]:g.input,I=s.parameters!==void 0?s.parameters[g.output]:g.output;p.node!==void 0&&(a.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",m)),A.push(this.getDependency("accessor",I)),c.push(g),h.push(p))}return Promise.all([Promise.all(a),Promise.all(r),Promise.all(A),Promise.all(c),Promise.all(h)]).then(function(l){const d=l[0],u=l[1],g=l[2],p=l[3],f=l[4],m=[];for(let I=0,C=d.length;I<C;I++){const E=d[I],b=u[I],y=g[I],w=p[I],B=f[I];if(E===void 0)continue;E.updateMatrix&&E.updateMatrix();const Q=i._createAnimationTracks(E,b,y,w,B);if(Q)for(let S=0;S<Q.length;S++)m.push(Q[S])}return new Ph(n,void 0,m)})}createNodeMesh(e){const t=this.json,i=this,s=t.nodes[e];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(n){const a=i._getNodeRef(i.meshCache,s.mesh,n);return s.weights!==void 0&&a.traverse(function(r){if(r.isMesh)for(let A=0,c=s.weights.length;A<c;A++)r.morphTargetInfluences[A]=s.weights[A]}),a})}loadNode(e){const t=this.json,i=this,s=t.nodes[e],n=i._loadNodeShallow(e),a=[],r=s.children||[];for(let c=0,h=r.length;c<h;c++)a.push(i.getDependency("node",r[c]));const A=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([n,Promise.all(a),A]).then(function(c){const h=c[0],l=c[1],d=c[2];d!==null&&h.traverse(function(u){u.isSkinnedMesh&&u.bind(d,_d)});for(let u=0,g=l.length;u<g;u++)h.add(l[u]);return h})}_loadNodeShallow(e){const t=this.json,i=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const n=t.nodes[e],a=n.name?s.createUniqueName(n.name):"",r=[],A=s._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return A&&r.push(A),n.camera!==void 0&&r.push(s.getDependency("camera",n.camera).then(function(c){return s._getNodeRef(s.cameraCache,n.camera,c)})),s._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){r.push(c)}),this.nodeCache[e]=Promise.all(r).then(function(c){let h;if(n.isBone===!0?h=new Hh:c.length>1?h=new Fi:c.length===1?h=c[0]:h=new us,h!==c[0])for(let l=0,d=c.length;l<d;l++)h.add(c[l]);if(n.name&&(h.userData.name=n.name,h.name=a),Ze(h,n),n.extensions&&Et(i,h,n),n.matrix!==void 0){const l=new Pe;l.fromArray(n.matrix),h.applyMatrix4(l)}else n.translation!==void 0&&h.position.fromArray(n.translation),n.rotation!==void 0&&h.quaternion.fromArray(n.rotation),n.scale!==void 0&&h.scale.fromArray(n.scale);if(!s.associations.has(h))s.associations.set(h,{});else if(n.mesh!==void 0&&s.meshCache.refs[n.mesh]>1){const l=s.associations.get(h);s.associations.set(h,{...l})}return s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],s=this,n=new Fi;i.name&&(n.name=s.createUniqueName(i.name)),Ze(n,i),i.extensions&&Et(t,n,i);const a=i.nodes||[],r=[];for(let A=0,c=a.length;A<c;A++)r.push(s.getDependency("node",a[A]));return Promise.all(r).then(function(A){for(let h=0,l=A.length;h<l;h++)n.add(A[h]);const c=h=>{const l=new Map;for(const[d,u]of s.associations)(d instanceof Li||d instanceof Ji)&&l.set(d,u);return h.traverse(d=>{const u=s.associations.get(d);u!=null&&l.set(d,u)}),l};return s.associations=c(n),n})}_createAnimationTracks(e,t,i,s,n){const a=[],r=e.name?e.name:e.uuid,A=[];nt[n.path]===nt.weights?e.traverse(function(d){d.morphTargetInfluences&&A.push(d.name?d.name:d.uuid)}):A.push(r);let c;switch(nt[n.path]){case nt.weights:c=Po;break;case nt.rotation:c=Ho;break;case nt.translation:case nt.scale:c=Oo;break;default:switch(i.itemSize){case 1:c=Po;break;case 2:case 3:default:c=Oo;break}break}const h=s.interpolation!==void 0?Rd[s.interpolation]:Bo,l=this._getArrayFromAccessor(i);for(let d=0,u=A.length;d<u;d++){const g=new c(A[d]+"."+nt[n.path],t.array,l,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),a.push(g)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=ao(t.constructor),s=new Float32Array(t.length);for(let n=0,a=t.length;n<a;n++)s[n]=t[n]*i;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const s=this instanceof Ho?Td:dl;return new s(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Gd(o,e,t){const i=e.attributes,s=new Rt;if(i.POSITION!==void 0){const r=t.json.accessors[i.POSITION],A=r.min,c=r.max;if(A!==void 0&&c!==void 0){if(s.set(new G(A[0],A[1],A[2]),new G(c[0],c[1],c[2])),r.normalized){const h=ao(cs[r.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const n=e.targets;if(n!==void 0){const r=new G,A=new G;for(let c=0,h=n.length;c<h;c++){const l=n[c];if(l.POSITION!==void 0){const d=t.json.accessors[l.POSITION],u=d.min,g=d.max;if(u!==void 0&&g!==void 0){if(A.setX(Math.max(Math.abs(u[0]),Math.abs(g[0]))),A.setY(Math.max(Math.abs(u[1]),Math.abs(g[1]))),A.setZ(Math.max(Math.abs(u[2]),Math.abs(g[2]))),d.normalized){const p=ao(cs[d.componentType]);A.multiplyScalar(p)}r.max(A)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(r)}o.boundingBox=s;const a=new wo;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,o.boundingSphere=a}function ur(o,e,t){const i=e.attributes,s=[];function n(a,r){return t.getDependency("accessor",a).then(function(A){o.setAttribute(r,A)})}for(const a in i){const r=no[a]||a.toLowerCase();r in o.attributes||s.push(n(i[a],r))}if(e.indices!==void 0&&!o.index){const a=t.getDependency("accessor",e.indices).then(function(r){o.setIndex(r)});s.push(a)}return Ja.workingColorSpace!==re&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Ja.workingColorSpace}" not supported.`),Ze(o,e),Gd(o,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Dd(o,e.targets,t):o})}class Ud{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0,this.workerCreator=null}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:s,msg:n,transfer:a}=this.queue.shift();this.workersResolve[e]=s,this.workers[e].postMessage(n,a)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const s=this._getIdleWorker();s!==-1?(this._initWorker(s),this.workerStatus|=1<<s,this.workersResolve[s]=i,this.workers[s].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const Od=0,dr=2,Pd=1,gr=2,Hd=0,qd=1,jd=10,$d=0,gl=9,pl=15,fl=16,ml=22,bl=37,Il=43,El=76,Cl=83,Bl=97,yl=100,wl=103,Ql=109,Vd=131,zd=132,Kd=133,Jd=134,Yd=137,Wd=138,Xd=141,Zd=142,eg=145,tg=146,xl=148,Sl=152,sg=157,ig=158,vl=165,Tl=166,Do=1000066e3;class ng{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Cs{constructor(e,t,i,s){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=s,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t){t===void 0&&(t=0);const i=this._offset;let s=0;for(;this._dataView.getUint8(this._offset)!==t&&s<e;)s++,this._offset++;return s<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,s)}}const de=[171,75,84,88,32,50,48,187,13,10,26,10];function pr(o){return new TextDecoder().decode(o)}function ag(o){const e=new Uint8Array(o.buffer,o.byteOffset,de.length);if(e[0]!==de[0]||e[1]!==de[1]||e[2]!==de[2]||e[3]!==de[3]||e[4]!==de[4]||e[5]!==de[5]||e[6]!==de[6]||e[7]!==de[7]||e[8]!==de[8]||e[9]!==de[9]||e[10]!==de[10]||e[11]!==de[11])throw new Error("Missing KTX 2.0 identifier.");const t=new ng,i=17*Uint32Array.BYTES_PER_ELEMENT,s=new Cs(o,de.length,i,!0);t.vkFormat=s._nextUint32(),t.typeSize=s._nextUint32(),t.pixelWidth=s._nextUint32(),t.pixelHeight=s._nextUint32(),t.pixelDepth=s._nextUint32(),t.layerCount=s._nextUint32(),t.faceCount=s._nextUint32();const n=s._nextUint32();t.supercompressionScheme=s._nextUint32();const a=s._nextUint32(),r=s._nextUint32(),A=s._nextUint32(),c=s._nextUint32(),h=s._nextUint64(),l=s._nextUint64(),d=new Cs(o,de.length+i,3*n*8,!0);for(let F=0;F<n;F++)t.levels.push({levelData:new Uint8Array(o.buffer,o.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});const u=new Cs(o,a,r,!0),g={vendorId:u._skip(4)._nextUint16(),descriptorType:u._nextUint16(),versionNumber:u._nextUint16(),descriptorBlockSize:u._nextUint16(),colorModel:u._nextUint8(),colorPrimaries:u._nextUint8(),transferFunction:u._nextUint8(),flags:u._nextUint8(),texelBlockDimension:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],bytesPlane:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],samples:[]},p=(g.descriptorBlockSize/4-6)/4;for(let F=0;F<p;F++){const q={bitOffset:u._nextUint16(),bitLength:u._nextUint8(),channelType:u._nextUint8(),samplePosition:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&q.channelType?(q.sampleLower=u._nextInt32(),q.sampleUpper=u._nextInt32()):(q.sampleLower=u._nextUint32(),q.sampleUpper=u._nextUint32()),g.samples[F]=q}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(g);const f=new Cs(o,A,c,!0);for(;f._offset<c;){const F=f._nextUint32(),q=f._scan(F),H=pr(q);if(t.keyValue[H]=f._nextUint8Array(F-q.byteLength-1),H.match(/^ktx/i)){const J=pr(t.keyValue[H]);t.keyValue[H]=J.substring(0,J.lastIndexOf("\0"))}f._skip(F%4?4-F%4:0)}if(l<=0)return t;const m=new Cs(o,h,l,!0),I=m._nextUint16(),C=m._nextUint16(),E=m._nextUint32(),b=m._nextUint32(),y=m._nextUint32(),w=m._nextUint32(),B=[];for(let F=0;F<n;F++)B.push({imageFlags:m._nextUint32(),rgbSliceByteOffset:m._nextUint32(),rgbSliceByteLength:m._nextUint32(),alphaSliceByteOffset:m._nextUint32(),alphaSliceByteLength:m._nextUint32()});const Q=h+m._offset,S=Q+E,R=S+b,D=R+y,k=new Uint8Array(o.buffer,o.byteOffset+Q,E),v=new Uint8Array(o.buffer,o.byteOffset+S,b),M=new Uint8Array(o.buffer,o.byteOffset+R,y),L=new Uint8Array(o.buffer,o.byteOffset+D,w);return t.globalData={endpointCount:I,selectorCount:C,imageDescs:B,endpointsData:k,selectorsData:v,tablesData:M,extendedData:L},t}let _n,Xe,oo;const Nn={env:{emscripten_notify_memory_growth:function(o){oo=new Uint8Array(Xe.exports.memory.buffer)}}};class og{init(){return _n||(_n=typeof fetch<"u"?fetch("data:application/wasm;base64,"+fr).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,Nn)).then(this._init):WebAssembly.instantiate(Buffer.from(fr,"base64"),Nn).then(this._init),_n)}_init(e){Xe=e.instance,Nn.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Xe)throw new Error("ZSTDDecoder: Await .init() before decoding.");const i=e.byteLength,s=Xe.exports.malloc(i);oo.set(e,s),t=t||Number(Xe.exports.ZSTD_findDecompressedSize(s,i));const n=Xe.exports.malloc(t),a=Xe.exports.ZSTD_decompress(n,t,s,i),r=oo.slice(n,n+a);return Xe.exports.free(s),Xe.exports.free(n),r}}const fr="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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",rg="display-p3",Ag="display-p3-linear",Gn=new WeakMap;let Un=0,On;class Te extends Eo{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new Ud,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}async detectSupportAsync(e){return this.workerConfig={astcSupported:await e.hasFeatureAsync("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:await e.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await e.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await e.hasFeatureAsync("texture-compression-bc"),bptcSupported:await e.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await e.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(e){return e.isWebGPURenderer===!0?this.workerConfig={astcSupported:e.hasFeature("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:e.hasFeature("texture-compression-etc1"),etc2Supported:e.hasFeature("texture-compression-etc2"),dxtSupported:e.hasFeature("texture-compression-bc"),bptcSupported:e.hasFeature("texture-compression-bptc"),pvrtcSupported:e.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:e.extensions.has("WEBGL_compressed_texture_astc")&&e.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const e=new Lt(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),i=new Lt(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const s=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,s]).then(([n,a])=>{const r=Te.BasisWorker.toString(),A=["/* constants */","let _EngineFormat = "+JSON.stringify(Te.EngineFormat),"let _EngineType = "+JSON.stringify(Te.EngineType),"let _TranscoderFormat = "+JSON.stringify(Te.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Te.BasisFormat),"/* basis_transcoder.js */",n,"/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([A])),this.transcoderBinary=a,this.workerPool.setWorkerCreator(()=>{const c=new Worker(this.workerSourceURL),h=this.transcoderBinary.slice(0);return c.postMessage({type:"init",config:this.workerConfig,transcoderBinary:h},[h]),c})}),Un>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Un++}return this.transcoderPending}load(e,t,i,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const n=new Lt(this.manager);n.setPath(this.path),n.setCrossOrigin(this.crossOrigin),n.setWithCredentials(this.withCredentials),n.setResponseType("arraybuffer"),n.load(e,a=>{this.parse(a,t,s)},i,s)}parse(e,t,i){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(Gn.has(e))return Gn.get(e).promise.then(t).catch(i);this._createTexture(e).then(s=>t?t(s):null).catch(i)}_createTextureFrom(e,t){const{type:i,error:s,data:{faces:n,width:a,height:r,format:A,type:c,dfdFlags:h}}=e;if(i==="error")return Promise.reject(s);let l;if(t.faceCount===6)l=new Jh(n,A,c);else{const d=n[0].mipmaps;l=t.layerCount>1?new Yh(d,a,r,t.layerCount,A,c):new Ks(d,a,r,A,c)}return l.minFilter=n[0].mipmaps.length===1?Ee:Ut,l.magFilter=Ee,l.generateMipmaps=!1,l.needsUpdate=!0,l.colorSpace=Rl(t),l.premultiplyAlpha=!!(h&Pd),l}async _createTexture(e,t={}){const i=ag(new Uint8Array(e)),s=i.vkFormat===Do&&i.dataFormatDescriptor[0].colorModel===167;if(!(i.vkFormat===$d||s&&!this.workerConfig.astcHDRSupported))return lg(i);const a=t,r=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:a},[e])).then(A=>this._createTextureFrom(A.data,i));return Gn.set(e,{promise:r}),r}dispose(){this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Un--}}Te.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2};Te.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25};Te.EngineFormat={RGBAFormat:tt,RGBA_ASTC_4x4_Format:ki,RGB_BPTC_UNSIGNED_Format:$h,RGBA_BPTC_Format:Xa,RGBA_ETC2_EAC_Format:Yc,RGBA_PVRTC_4BPPV1_Format:Vh,RGBA_S3TC_DXT5_Format:Za,RGB_ETC1_Format:zh,RGB_ETC2_Format:Wc,RGB_PVRTC_4BPPV1_Format:Kh,RGBA_S3TC_DXT1_Format:eo};Te.EngineType={UnsignedByteType:Le,HalfFloatType:Re,FloatType:dt};Te.BasisWorker=function(){let o,e,t;const i=_EngineFormat,s=_EngineType,n=_TranscoderFormat,a=_BasisFormat;self.addEventListener("message",function(g){const p=g.data;switch(p.type){case"init":o=p.config,r(p.transcoderBinary);break;case"transcode":e.then(()=>{try{const{faces:f,buffers:m,width:I,height:C,hasAlpha:E,format:b,type:y,dfdFlags:w}=A(p.buffer);self.postMessage({type:"transcode",id:p.id,data:{faces:f,width:I,height:C,hasAlpha:E,format:b,type:y,dfdFlags:w}},m)}catch(f){console.error(f),self.postMessage({type:"error",id:p.id,error:f.message})}});break}});function r(g){e=new Promise(p=>{t={wasmBinary:g,onRuntimeInitialized:p},BASIS(t)}).then(()=>{t.initializeBasis(),t.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function A(g){const p=new t.KTX2File(new Uint8Array(g));function f(){p.close(),p.delete()}if(!p.isValid())throw f(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let m;if(p.isUASTC())m=a.UASTC;else if(p.isETC1S())m=a.ETC1S;else if(p.isHDR())m=a.UASTC_HDR;else throw new Error("THREE.KTX2Loader: Unknown Basis encoding");const I=p.getWidth(),C=p.getHeight(),E=p.getLayers()||1,b=p.getLevels(),y=p.getFaces(),w=p.getHasAlpha(),B=p.getDFDFlags(),{transcoderFormat:Q,engineFormat:S,engineType:R}=l(m,I,C,w);if(!I||!C||!b)throw f(),new Error("THREE.KTX2Loader:	Invalid texture");if(!p.startTranscoding())throw f(),new Error("THREE.KTX2Loader: .startTranscoding failed");const D=[],k=[];for(let v=0;v<y;v++){const M=[];for(let L=0;L<b;L++){const F=[];let q,H;for(let $=0;$<E;$++){const V=p.getImageLevelInfo(L,$,v);v===0&&L===0&&$===0&&(V.origWidth%4!==0||V.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),b>1?(q=V.origWidth,H=V.origHeight):(q=V.width,H=V.height);let Y=new Uint8Array(p.getImageTranscodedSizeInBytes(L,$,0,Q));const ue=p.transcodeImage(Y,L,$,v,Q,0,-1,-1);if(R===s.HalfFloatType&&(Y=new Uint16Array(Y.buffer,Y.byteOffset,Y.byteLength/Uint16Array.BYTES_PER_ELEMENT)),!ue)throw f(),new Error("THREE.KTX2Loader: .transcodeImage failed.");F.push(Y)}const J=u(F);M.push({data:J,width:q,height:H}),k.push(J.buffer)}D.push({mipmaps:M,width:I,height:C,format:S,type:R})}return f(),{faces:D,buffers:k,width:I,height:C,hasAlpha:w,dfdFlags:B,format:S,type:R}}const c=[{if:"astcSupported",basisFormat:[a.UASTC],transcoderFormat:[n.ASTC_4x4,n.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],engineType:[s.UnsignedByteType],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.BC7_M5,n.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],engineType:[s.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.BC1,n.BC3],engineFormat:[i.RGBA_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],engineType:[s.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.ETC1,n.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],engineType:[s.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.ETC1],engineFormat:[i.RGB_ETC1_Format],engineType:[s.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.PVRTC1_4_RGB,n.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],engineType:[s.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0},{if:"bptcSupported",basisFormat:[a.UASTC_HDR],transcoderFormat:[n.BC6H],engineFormat:[i.RGB_BPTC_UNSIGNED_Format],engineType:[s.HalfFloatType],priorityHDR:1,needsPowerOfTwo:!1},{basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[n.RGBA32,n.RGBA32],engineFormat:[i.RGBAFormat,i.RGBAFormat],engineType:[s.UnsignedByteType,s.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:!1},{basisFormat:[a.UASTC_HDR],transcoderFormat:[n.RGBA_HALF],engineFormat:[i.RGBAFormat],engineType:[s.HalfFloatType],priorityHDR:100,needsPowerOfTwo:!1}],h={[a.ETC1S]:c.filter(g=>g.basisFormat.includes(a.ETC1S)).sort((g,p)=>g.priorityUASTC-p.priorityUASTC),[a.UASTC]:c.filter(g=>g.basisFormat.includes(a.UASTC)).sort((g,p)=>g.priorityUASTC-p.priorityUASTC),[a.UASTC_HDR]:c.filter(g=>g.basisFormat.includes(a.UASTC_HDR)).sort((g,p)=>g.priorityHDR-p.priorityHDR)};function l(g,p,f,m){const I=h[g];for(let C=0;C<I.length;C++){const E=I[C];if(E.if&&!o[E.if]||!E.basisFormat.includes(g)||m&&E.transcoderFormat.length<2||E.needsPowerOfTwo&&!(d(p)&&d(f)))continue;const b=E.transcoderFormat[m?1:0],y=E.engineFormat[m?1:0],w=E.engineType[0];return{transcoderFormat:b,engineFormat:y,engineType:w}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}function d(g){return g<=2?!0:(g&g-1)===0&&g!==0}function u(g){if(g.length===1)return g[0];let p=0;for(let I=0;I<g.length;I++){const C=g[I];p+=C.byteLength}const f=new Uint8Array(p);let m=0;for(let I=0;I<g.length;I++){const C=g[I];f.set(C,m),m+=C.byteLength}return f}};const cg=new Set([tt,Gs,Us]),Pn={[Ql]:tt,[Bl]:tt,[bl]:tt,[Il]:tt,[wl]:Gs,[Cl]:Gs,[fl]:Gs,[ml]:Gs,[yl]:Us,[El]:Us,[pl]:Us,[gl]:Us,[xl]:Wc,[Sl]:Yc,[Do]:ki,[ig]:ki,[sg]:ki,[Tl]:qo,[vl]:qo,[Kd]:eo,[Jd]:eo,[Vd]:jo,[zd]:jo,[Wd]:$o,[Yd]:$o,[Zd]:Za,[Xd]:Za,[tg]:Xa,[eg]:Xa},Hn={[Ql]:dt,[Bl]:Re,[bl]:Le,[Il]:Le,[wl]:dt,[Cl]:Re,[fl]:Le,[ml]:Le,[yl]:dt,[El]:Re,[pl]:Le,[gl]:Le,[xl]:Le,[Sl]:Le,[Do]:Re,[Tl]:Le,[vl]:Le};async function lg(o){const{vkFormat:e}=o;if(Pn[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let t;o.supercompressionScheme===dr&&(On||(On=new Promise(async n=>{const a=new og;await a.init(),n(a)})),t=await On);const i=[];for(let n=0;n<o.levels.length;n++){const a=Math.max(1,o.pixelWidth>>n),r=Math.max(1,o.pixelHeight>>n),A=o.pixelDepth?Math.max(1,o.pixelDepth>>n):0,c=o.levels[n];let h;if(o.supercompressionScheme===Od)h=c.levelData;else if(o.supercompressionScheme===dr)h=t.decode(c.levelData,c.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let l;Hn[e]===dt?l=new Float32Array(h.buffer,h.byteOffset,h.byteLength/Float32Array.BYTES_PER_ELEMENT):Hn[e]===Re?l=new Uint16Array(h.buffer,h.byteOffset,h.byteLength/Uint16Array.BYTES_PER_ELEMENT):l=h,i.push({data:l,width:a,height:r,depth:A})}let s;if(cg.has(Pn[e]))s=o.pixelDepth===0?new Wh(i[0].data,o.pixelWidth,o.pixelHeight):new Xh(i[0].data,o.pixelWidth,o.pixelHeight,o.pixelDepth);else{if(o.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");s=new Ks(i,o.pixelWidth,o.pixelHeight),s.minFilter=i.length===1?Ee:Ut,s.magFilter=Ee}return s.mipmaps=i,s.type=Hn[e],s.format=Pn[e],s.colorSpace=Rl(o),s.needsUpdate=!0,Promise.resolve(s)}function Rl(o){const e=o.dataFormatDescriptor[0];return e.colorPrimaries===qd?e.transferFunction===gr?xe:re:e.colorPrimaries===jd?e.transferFunction===gr?rg:Ag:e.colorPrimaries===Hd?Yi:(console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${e.colorPrimaries}"`),Yi)}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mr,br;const De=Symbol("retainerCount"),$e=Symbol("recentlyUsed"),Ai=Symbol("evict"),Bs=Symbol("evictionThreshold"),qn=Symbol("cache");class hg{constructor(e,t=5){this[mr]=new Map,this[br]=[],this[qn]=e,this[Bs]=t}set evictionThreshold(e){this[Bs]=e,this[Ai]()}get evictionThreshold(){return this[Bs]}get cache(){return this[qn]}retainerCount(e){return this[De].get(e)||0}reset(){this[De].clear(),this[$e]=[]}retain(e){this[De].has(e)||this[De].set(e,0),this[De].set(e,this[De].get(e)+1);const t=this[$e].indexOf(e);t!==-1&&this[$e].splice(t,1),this[$e].unshift(e),this[Ai]()}release(e){this[De].has(e)&&this[De].set(e,Math.max(this[De].get(e)-1,0)),this[Ai]()}[(mr=De,br=$e,Ai)](){if(!(this[$e].length<this[Bs]))for(let e=this[$e].length-1;e>=this[Bs];--e){const t=this[$e][e];this[De].get(t)===0&&(this[qn].delete(t),this[$e].splice(e,1))}}}/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug=o=>{const e=[],t=new Set;for(const i of o){let s=i,n=0;for(;t.has(s);)s=i+"."+ ++n;t.add(s),e.push(s)}return e},dg=o=>{const e=new Map;for(const t of o.mappings)for(const i of t.variants)e.set(i,{material:null,gltfMaterialIndex:t.material});return e};class gg{constructor(e){this.parser=e,this.name="KHR_materials_variants"}afterRoot(e){const t=this.parser,i=t.json;if(i.extensions===void 0||i.extensions[this.name]===void 0)return null;const n=i.extensions[this.name].variants||[],a=ug(n.map(r=>r.name));for(const r of e.scenes)r.traverse(A=>{const c=A;if(!c.material)return;const h=t.associations.get(c);if(h==null||h.meshes==null||h.primitives==null)return;const g=i.meshes[h.meshes].primitives[h.primitives].extensions;!g||!g[this.name]||(c.userData.variantMaterials=dg(g[this.name]))});return e.userData.variants=a,Promise.resolve()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ml,Ir;Ji.DEFAULT_ANISOTROPY=4;const pg=(o,e,t=()=>{})=>{const i=s=>{const n=s.loaded/s.total;t(Math.max(0,Math.min(1,isFinite(n)?n:1)))};return new Promise((s,n)=>{e.load(o,s,i,n)})},fg=o=>new Promise((e,t)=>{const i=document.createElement("script");document.body.appendChild(i),i.onload=e,i.onerror=t,i.async=!0,i.src=o}),Ve=new Map,jn=new Map;let Er;const Cr=new sd;let Br;const $n=new Te;let Vn,zn;const Qt=Symbol("loader"),At=Symbol("evictionPolicy"),yr=Symbol("GLTFInstance");class pe extends fn{static setDRACODecoderLocation(e){Er=e,Cr.setDecoderPath(e)}static getDRACODecoderLocation(){return Er}static setKTX2TranscoderLocation(e){Br=e,$n.setTranscoderPath(e)}static getKTX2TranscoderLocation(){return Br}static setMeshoptDecoderLocation(e){Vn!==e&&(Vn=e,zn=fg(e).then(()=>rr.ready).then(()=>rr))}static getMeshoptDecoderLocation(){return Vn}static initializeKTX2Loader(e){$n.detectSupport(e)}static get cache(){return Ve}static clearCache(){Ve.forEach((e,t)=>{this.delete(t)}),this[At].reset()}static has(e){return Ve.has(e)}static async delete(e){if(!this.has(e))return;const t=Ve.get(e);jn.delete(e),Ve.delete(e),(await t).dispose()}static hasFinishedLoading(e){return!!jn.get(e)}constructor(e){super(),this[Ir]=new nd().register(t=>new gg(t)),this[yr]=e,this[Qt].setDRACOLoader(Cr),this[Qt].setKTX2Loader($n)}get[(Ml=At,Ir=Qt,At)](){return this.constructor[At]}async preload(e,t,i=()=>{}){if(this[Qt].setWithCredentials(t.withCredentials),this.dispatchEvent({type:"preload",element:t,src:e}),!Ve.has(e)){zn!=null&&this[Qt].setMeshoptDecoder(await zn);const s=pg(e,this[Qt],r=>{i(r*.8)}),n=this[yr],a=s.then(r=>n.prepare(r)).then(r=>(i(.9),new n(r))).catch(r=>(console.error(r),new n));Ve.set(e,a)}await Ve.get(e),jn.set(e,!0),i&&i(1)}async load(e,t,i=()=>{}){await this.preload(e,t,i);const n=await(await Ve.get(e)).clone();return this[At].retain(e),n.dispose=()=>{this[At].release(e)},n}}pe[Ml]=new hg(pe);class mg extends us{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Me(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Ht=new G,wr=new Pe,Qr=new Pe,xr=new G,Sr=new G;class bg{constructor(e={}){const t=this;let i,s,n,a;const r={objects:new WeakMap},A=e.element!==void 0?e.element:document.createElement("div");A.style.overflow="hidden",this.domElement=A,this.getSize=function(){return{width:i,height:s}},this.render=function(g,p){g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),p.parent===null&&p.matrixWorldAutoUpdate===!0&&p.updateMatrixWorld(),wr.copy(p.matrixWorldInverse),Qr.multiplyMatrices(p.projectionMatrix,wr),h(g,g,p),u(g)},this.setSize=function(g,p){i=g,s=p,n=i/2,a=s/2,A.style.width=g+"px",A.style.height=p+"px"};function c(g){g.isCSS2DObject&&(g.element.style.display="none");for(let p=0,f=g.children.length;p<f;p++)c(g.children[p])}function h(g,p,f){if(g.visible===!1){c(g);return}if(g.isCSS2DObject){Ht.setFromMatrixPosition(g.matrixWorld),Ht.applyMatrix4(Qr);const m=Ht.z>=-1&&Ht.z<=1&&g.layers.test(f.layers)===!0,I=g.element;I.style.display=m===!0?"":"none",m===!0&&(g.onBeforeRender(t,p,f),I.style.transform="translate("+-100*g.center.x+"%,"+-100*g.center.y+"%)translate("+(Ht.x*n+n)+"px,"+(-Ht.y*a+a)+"px)",I.parentNode!==A&&A.appendChild(I),g.onAfterRender(t,p,f));const C={distanceToCameraSquared:l(f,g)};r.objects.set(g,C)}for(let m=0,I=g.children.length;m<I;m++)h(g.children[m],p,f)}function l(g,p){return xr.setFromMatrixPosition(g.matrixWorld),Sr.setFromMatrixPosition(p.matrixWorld),xr.distanceToSquared(Sr)}function d(g){const p=[];return g.traverseVisible(function(f){f.isCSS2DObject&&p.push(f)}),p}function u(g){const p=d(g).sort(function(m,I){if(m.renderOrder!==I.renderOrder)return I.renderOrder-m.renderOrder;const C=r.objects.get(m).distanceToCameraSquared,E=r.objects.get(I).distanceToCameraSquared;return C-E}),f=p.length;for(let m=0,I=p.length;m<I;m++)p[m].element.style.zIndex=f-m}}}function ci(o,e,t){let i=t;const s=new G;return o.updateWorldMatrix(!0,!0),o.traverseVisible(n=>{const{geometry:a}=n;if(a!==void 0){const{position:r}=a.attributes;if(r!==void 0)for(let A=0,c=r.count;A<c;A++)n.isMesh?n.getVertexPosition(A,s):s.fromBufferAttribute(r,A),n.isSkinnedMesh||s.applyMatrix4(n.matrixWorld),i=e(i,s)}}),i}const vr={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class tn{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(e){return new Tg(e)}),this.register(function(e){return new Rg(e)}),this.register(function(e){return new Fg(e)}),this.register(function(e){return new kg(e)}),this.register(function(e){return new _g(e)}),this.register(function(e){return new Ng(e)}),this.register(function(e){return new Mg(e)}),this.register(function(e){return new Dg(e)}),this.register(function(e){return new Lg(e)}),this.register(function(e){return new Gg(e)}),this.register(function(e){return new Ug(e)}),this.register(function(e){return new Og(e)}),this.register(function(e){return new Pg(e)}),this.register(function(e){return new Hg(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,t,i,s){const n=new vg,a=[];for(let r=0,A=this.pluginCallbacks.length;r<A;r++)a.push(this.pluginCallbacks[r](n));n.setPlugins(a),n.setTextureUtils(this.textureUtils),n.writeAsync(e,t,s).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(s,n){i.parse(e,s,n,t)})}}const O={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Kn="KHR_mesh_quantization",we={};we[Ot]=O.NEAREST;we[hn]=O.NEAREST_MIPMAP_NEAREST;we[dn]=O.NEAREST_MIPMAP_LINEAR;we[Ee]=O.LINEAR;we[un]=O.LINEAR_MIPMAP_NEAREST;we[Ut]=O.LINEAR_MIPMAP_LINEAR;we[gn]=O.CLAMP_TO_EDGE;we[ft]=O.REPEAT;we[pn]=O.MIRRORED_REPEAT;const Tr={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ig=new oe,Rr=12,Eg=1179937895,Cg=2,Mr=8,Bg=1313821514,yg=5130562;function Hs(o,e){return o.length===e.length&&o.every(function(t,i){return t===e[i]})}function wg(o){return new TextEncoder().encode(o).buffer}function Qg(o){return Hs(o.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function xg(o,e,t){const i={min:new Array(o.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(o.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let s=e;s<e+t;s++)for(let n=0;n<o.itemSize;n++){let a;o.itemSize>4?a=o.array[s*o.itemSize+n]:(n===0?a=o.getX(s):n===1?a=o.getY(s):n===2?a=o.getZ(s):n===3&&(a=o.getW(s)),o.normalized===!0&&(a=Ki.normalize(a,o.array))),i.min[n]=Math.min(i.min[n],a),i.max[n]=Math.max(i.max[n],a)}return i}function Dl(o){return Math.ceil(o/4)*4}function Jn(o,e=0){const t=Dl(o.byteLength);if(t!==o.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(o)),e!==0)for(let s=o.byteLength;s<t;s++)i[s]=e;return i.buffer}return o}function Dr(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Sg(o,e){if(o.toBlob!==void 0)return new Promise(i=>o.toBlob(i,e));let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),o.convertToBlob({type:e,quality:t})}class vg{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+Zh}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,t,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const s=this,n=s.buffers,a=s.json;i=s.options;const r=s.extensionsUsed,A=s.extensionsRequired,c=new Blob(n,{type:"application/octet-stream"}),h=Object.keys(r),l=Object.keys(A);if(h.length>0&&(a.extensionsUsed=h),l.length>0&&(a.extensionsRequired=l),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=c.size),i.binary===!0){const d=new FileReader;d.readAsArrayBuffer(c),d.onloadend=function(){const u=Jn(d.result),g=new DataView(new ArrayBuffer(Mr));g.setUint32(0,u.byteLength,!0),g.setUint32(4,yg,!0);const p=Jn(wg(JSON.stringify(a)),32),f=new DataView(new ArrayBuffer(Mr));f.setUint32(0,p.byteLength,!0),f.setUint32(4,Bg,!0);const m=new ArrayBuffer(Rr),I=new DataView(m);I.setUint32(0,Eg,!0),I.setUint32(4,Cg,!0);const C=Rr+f.byteLength+p.byteLength+g.byteLength+u.byteLength;I.setUint32(8,C,!0);const E=new Blob([m,f,p,g,u],{type:"application/octet-stream"}),b=new FileReader;b.readAsArrayBuffer(E),b.onloadend=function(){t(b.result)}}}else if(a.buffers&&a.buffers.length>0){const d=new FileReader;d.readAsDataURL(c),d.onloadend=function(){const u=d.result;a.buffers[0].uri=u,t(a)}}else t(a)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const i=this.options,s=this.extensionsUsed;try{const n=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&n.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const a in n.gltfExtensions)t.extensions[a]=n.gltfExtensions[a],s[a]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(n){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+n.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const s=new Map;s.set(!0,this.uid++),s.set(!1,this.uid++),this.uids.set(e,s)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new G;for(let s=0,n=e.count;s<n;s++)if(Math.abs(i.fromBufferAttribute(e,s).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),s=new G;for(let n=0,a=i.count;n<a;n++)s.fromBufferAttribute(i,n),s.x===0&&s.y===0&&s.z===0?s.setX(1):s.normalize(),i.setXYZ(n,s.x,s.y,s.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const s={};(t.offset.x!==0||t.offset.y!==0)&&(s.offset=t.offset.toArray(),i=!0),t.rotation!==0&&(s.rotation=t.rotation,i=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(s.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,t){if(e===t)return e;function i(u){return u.colorSpace===xe?function(p){return p<.04045?p*.0773993808:Math.pow(p*.9478672986+.0521327014,2.4)}:function(p){return p}}e instanceof Ks&&(e=await this.decompressTextureAsync(e)),t instanceof Ks&&(t=await this.decompressTextureAsync(t));const s=e?e.image:null,n=t?t.image:null,a=Math.max(s?s.width:0,n?n.width:0),r=Math.max(s?s.height:0,n?n.height:0),A=Dr();A.width=a,A.height=r;const c=A.getContext("2d",{willReadFrequently:!0});c.fillStyle="#00ffff",c.fillRect(0,0,a,r);const h=c.getImageData(0,0,a,r);if(s){c.drawImage(s,0,0,a,r);const u=i(e),g=c.getImageData(0,0,a,r).data;for(let p=2;p<g.length;p+=4)h.data[p]=u(g[p]/256)*256}if(n){c.drawImage(n,0,0,a,r);const u=i(t),g=c.getImageData(0,0,a,r).data;for(let p=1;p<g.length;p+=4)h.data[p]=u(g[p]/256)*256}c.putImageData(h,0,0);const d=(e||t).clone();return d.source=new eu(A),d.colorSpace=Yi,d.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),d}async decompressTextureAsync(e,t=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,t)}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,s,n){const a=this.json;a.bufferViews||(a.bufferViews=[]);let r;switch(t){case O.BYTE:case O.UNSIGNED_BYTE:r=1;break;case O.SHORT:case O.UNSIGNED_SHORT:r=2;break;default:r=4}let A=e.itemSize*r;n===O.ARRAY_BUFFER&&(A=Math.ceil(A/4)*4);const c=Dl(s*A),h=new DataView(new ArrayBuffer(c));let l=0;for(let g=i;g<i+s;g++){for(let p=0;p<e.itemSize;p++){let f;e.itemSize>4?f=e.array[g*e.itemSize+p]:(p===0?f=e.getX(g):p===1?f=e.getY(g):p===2?f=e.getZ(g):p===3&&(f=e.getW(g)),e.normalized===!0&&(f=Ki.normalize(f,e.array))),t===O.FLOAT?h.setFloat32(l,f,!0):t===O.INT?h.setInt32(l,f,!0):t===O.UNSIGNED_INT?h.setUint32(l,f,!0):t===O.SHORT?h.setInt16(l,f,!0):t===O.UNSIGNED_SHORT?h.setUint16(l,f,!0):t===O.BYTE?h.setInt8(l,f):t===O.UNSIGNED_BYTE&&h.setUint8(l,f),l+=r}l%A!==0&&(l+=A-l%A)}const d={buffer:this.processBuffer(h.buffer),byteOffset:this.byteOffset,byteLength:c};return n!==void 0&&(d.target=n),n===O.ARRAY_BUFFER&&(d.byteStride=A),this.byteOffset+=c,a.bufferViews.push(d),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(s){const n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){const a=Jn(n.result),r={buffer:t.processBuffer(a),byteOffset:t.byteOffset,byteLength:a.byteLength};t.byteOffset+=a.byteLength,s(i.bufferViews.push(r)-1)}})}processAccessor(e,t,i,s){const n=this.json,a={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let r;if(e.array.constructor===Float32Array)r=O.FLOAT;else if(e.array.constructor===Int32Array)r=O.INT;else if(e.array.constructor===Uint32Array)r=O.UNSIGNED_INT;else if(e.array.constructor===Int16Array)r=O.SHORT;else if(e.array.constructor===Uint16Array)r=O.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)r=O.BYTE;else if(e.array.constructor===Uint8Array)r=O.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(i===void 0&&(i=0),(s===void 0||s===1/0)&&(s=e.count),s===0)return null;const A=xg(e,i,s);let c;t!==void 0&&(c=e===t.index?O.ELEMENT_ARRAY_BUFFER:O.ARRAY_BUFFER);const h=this.processBufferView(e,r,i,s,c),l={bufferView:h.id,byteOffset:h.byteOffset,componentType:r,count:s,max:A.max,min:A.min,type:a[e.itemSize]};return e.normalized===!0&&(l.normalized=!0),n.accessors||(n.accessors=[]),n.accessors.push(l)-1}processImage(e,t,i,s="image/png"){if(e!==null){const n=this,a=n.cache,r=n.json,A=n.options,c=n.pending;a.images.has(e)||a.images.set(e,{});const h=a.images.get(e),l=s+":flipY/"+i.toString();if(h[l]!==void 0)return h[l];r.images||(r.images=[]);const d={mimeType:s},u=Dr();u.width=Math.min(e.width,A.maxTextureSize),u.height=Math.min(e.height,A.maxTextureSize);const g=u.getContext("2d",{willReadFrequently:!0});if(i===!0&&(g.translate(0,u.height),g.scale(1,-1)),e.data!==void 0){t!==tt&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>A.maxTextureSize||e.height>A.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const f=new Uint8ClampedArray(e.height*e.width*4);for(let m=0;m<f.length;m+=4)f[m+0]=e.data[m+0],f[m+1]=e.data[m+1],f[m+2]=e.data[m+2],f[m+3]=e.data[m+3];g.putImageData(new ImageData(f,e.width,e.height),0,0)}else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)g.drawImage(e,0,0,u.width,u.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");A.binary===!0?c.push(Sg(u,s).then(f=>n.processBufferViewImage(f)).then(f=>{d.bufferView=f})):d.uri=tu.getDataURL(u,s);const p=r.images.push(d)-1;return h[l]=p,p}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const i={magFilter:we[e.magFilter],minFilter:we[e.minFilter],wrapS:we[e.wrapS],wrapT:we[e.wrapT]};return t.samplers.push(i)-1}async processTextureAsync(e){const i=this.options,s=this.cache,n=this.json;if(s.textures.has(e))return s.textures.get(e);n.textures||(n.textures=[]),e instanceof Ks&&(e=await this.decompressTextureAsync(e,i.maxTextureSize));let a=e.userData.mimeType;a==="image/webp"&&(a="image/png");const r={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,a)};e.name&&(r.name=e.name),await this._invokeAllAsync(async function(c){c.writeTexture&&await c.writeTexture(e,r)});const A=n.textures.push(r)-1;return s.textures.set(e,A),A}async processMaterialAsync(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const s={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const n=e.color.toArray().concat([e.opacity]);if(Hs(n,[1,1,1,1])||(s.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(s.pbrMetallicRoughness.metallicFactor=e.metalness,s.pbrMetallicRoughness.roughnessFactor=e.roughness):(s.pbrMetallicRoughness.metallicFactor=0,s.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const r=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),A={index:await this.processTextureAsync(r),texCoord:r.channel};this.applyTextureTransform(A,r),s.pbrMetallicRoughness.metallicRoughnessTexture=A}if(e.map){const r={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(r,e.map),s.pbrMetallicRoughness.baseColorTexture=r}if(e.emissive){const r=e.emissive;if(Math.max(r.r,r.g,r.b)>0&&(s.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const c={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(c,e.emissiveMap),s.emissiveTexture=c}}if(e.normalMap){const r={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(r.scale=e.normalScale.x),this.applyTextureTransform(r,e.normalMap),s.normalTexture=r}if(e.aoMap){const r={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(r.strength=e.aoMapIntensity),this.applyTextureTransform(r,e.aoMap),s.occlusionTexture=r}e.transparent?s.alphaMode="BLEND":e.alphaTest>0&&(s.alphaMode="MASK",s.alphaCutoff=e.alphaTest),e.side===it&&(s.doubleSided=!0),e.name!==""&&(s.name=e.name),this.serializeUserData(e,s),await this._invokeAllAsync(async function(r){r.writeMaterialAsync&&await r.writeMaterialAsync(e,s)});const a=i.materials.push(s)-1;return t.materials.set(e,a),a}async processMeshAsync(e){const t=this.cache,i=this.json,s=[e.geometry.uuid];if(Array.isArray(e.material))for(let E=0,b=e.material.length;E<b;E++)s.push(e.material[E].uuid);else s.push(e.material.uuid);const n=s.join(":");if(t.meshes.has(n))return t.meshes.get(n);const a=e.geometry;let r;e.isLineSegments?r=O.LINES:e.isLineLoop?r=O.LINE_LOOP:e.isLine?r=O.LINE_STRIP:e.isPoints?r=O.POINTS:r=e.material.wireframe?O.LINES:O.TRIANGLES;const A={},c={},h=[],l=[],d={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},u=a.getAttribute("normal");u!==void 0&&!this.isNormalizedNormalAttribute(u)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(u)));let g=null;for(let E in a.attributes){if(E.slice(0,5)==="morph")continue;const b=a.attributes[E];if(E=d[E]||E.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(E)||(E="_"+E),t.attributes.has(this.getUID(b))){c[E]=t.attributes.get(this.getUID(b));continue}g=null;const w=b.array;E==="JOINTS_0"&&!(w instanceof Uint16Array)&&!(w instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),g=new ye(new Uint16Array(w),b.itemSize,b.normalized)):(w instanceof Uint32Array||w instanceof Int32Array)&&!E.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${E}" converted to type FLOAT.`),g=tn.Utils.toFloat32BufferAttribute(b));const B=this.processAccessor(g||b,a);B!==null&&(E.startsWith("_")||this.detectMeshQuantization(E,b),c[E]=B,t.attributes.set(this.getUID(b),B))}if(u!==void 0&&a.setAttribute("normal",u),Object.keys(c).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const E=[],b=[],y={};if(e.morphTargetDictionary!==void 0)for(const w in e.morphTargetDictionary)y[e.morphTargetDictionary[w]]=w;for(let w=0;w<e.morphTargetInfluences.length;++w){const B={};let Q=!1;for(const S in a.morphAttributes){if(S!=="position"&&S!=="normal"){Q||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Q=!0);continue}const R=a.morphAttributes[S][w],D=S.toUpperCase(),k=a.attributes[S];if(t.attributes.has(this.getUID(R,!0))){B[D]=t.attributes.get(this.getUID(R,!0));continue}const v=R.clone();if(!a.morphTargetsRelative)for(let M=0,L=R.count;M<L;M++)for(let F=0;F<R.itemSize;F++)F===0&&v.setX(M,R.getX(M)-k.getX(M)),F===1&&v.setY(M,R.getY(M)-k.getY(M)),F===2&&v.setZ(M,R.getZ(M)-k.getZ(M)),F===3&&v.setW(M,R.getW(M)-k.getW(M));B[D]=this.processAccessor(v,a),t.attributes.set(this.getUID(k,!0),B[D])}l.push(B),E.push(e.morphTargetInfluences[w]),e.morphTargetDictionary!==void 0&&b.push(y[w])}A.weights=E,b.length>0&&(A.extras={},A.extras.targetNames=b)}const p=Array.isArray(e.material);if(p&&a.groups.length===0)return null;let f=!1;if(p&&a.index===null){const E=[];for(let b=0,y=a.attributes.position.count;b<y;b++)E[b]=b;a.setIndex(E),f=!0}const m=p?e.material:[e.material],I=p?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let E=0,b=I.length;E<b;E++){const y={mode:r,attributes:c};if(this.serializeUserData(a,y),l.length>0&&(y.targets=l),a.index!==null){let B=this.getUID(a.index);(I[E].start!==void 0||I[E].count!==void 0)&&(B+=":"+I[E].start+":"+I[E].count),t.attributes.has(B)?y.indices=t.attributes.get(B):(y.indices=this.processAccessor(a.index,a,I[E].start,I[E].count),t.attributes.set(B,y.indices)),y.indices===null&&delete y.indices}const w=await this.processMaterialAsync(m[I[E].materialIndex]);w!==null&&(y.material=w),h.push(y)}f===!0&&a.setIndex(null),A.primitives=h,i.meshes||(i.meshes=[]),await this._invokeAllAsync(function(E){E.writeMesh&&E.writeMesh(e,A)});const C=i.meshes.push(A)-1;return t.meshes.set(n,C),C}detectMeshQuantization(e,t){if(this.extensionsUsed[Kn])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const s=e.split("_",1)[0];vr[s]&&vr[s].includes(i)&&(this.extensionsUsed[Kn]=!0,this.extensionsRequired[Kn]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,s={type:i?"orthographic":"perspective"};return i?s.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:s.perspective={aspectRatio:e.aspect,yfov:Ki.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(s.name=e.type),t.cameras.push(s)-1}processAnimation(e,t){const i=this.json,s=this.nodeMap;i.animations||(i.animations=[]),e=tn.Utils.mergeMorphTargetTracks(e.clone(),t);const n=e.tracks,a=[],r=[];for(let A=0;A<n.length;++A){const c=n[A],h=Zs.parseTrackName(c.name);let l=Zs.findNode(t,h.nodeName);const d=Tr[h.propertyName];if(h.objectName==="bones"&&(l.isSkinnedMesh===!0?l=l.skeleton.getBoneByName(h.objectIndex):l=void 0),!l||!d){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',c.name);continue}const u=1;let g=c.values.length/c.times.length;d===Tr.morphTargetInfluences&&(g/=l.morphTargetInfluences.length);let p;c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(p="CUBICSPLINE",g/=3):c.getInterpolation()===Jc?p="STEP":p="LINEAR",r.push({input:this.processAccessor(new ye(c.times,u)),output:this.processAccessor(new ye(c.values,g)),interpolation:p}),a.push({sampler:r.length-1,target:{node:s.get(l),path:d}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:r,channels:a}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,s=t.nodes[i.get(e)],n=e.skeleton;if(n===void 0)return null;const a=e.skeleton.bones[0];if(a===void 0)return null;const r=[],A=new Float32Array(n.bones.length*16),c=new Pe;for(let l=0;l<n.bones.length;++l)r.push(i.get(n.bones[l])),c.copy(n.boneInverses[l]),c.multiply(e.bindMatrix).toArray(A,l*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new ye(A,16)),joints:r,skeleton:i.get(a)}),s.skin=t.skins.length-1}async processNodeAsync(e){const t=this.json,i=this.options,s=this.nodeMap;t.nodes||(t.nodes=[]);const n={};if(i.trs){const r=e.quaternion.toArray(),A=e.position.toArray(),c=e.scale.toArray();Hs(r,[0,0,0,1])||(n.rotation=r),Hs(A,[0,0,0])||(n.translation=A),Hs(c,[1,1,1])||(n.scale=c)}else e.matrixAutoUpdate&&e.updateMatrix(),Qg(e.matrix)===!1&&(n.matrix=e.matrix.elements);if(e.name!==""&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){const r=await this.processMeshAsync(e);r!==null&&(n.mesh=r)}else e.isCamera&&(n.camera=this.processCamera(e));e.isSkinnedMesh&&this.skins.push(e);const a=t.nodes.push(n)-1;if(s.set(e,a),e.children.length>0){const r=[];for(let A=0,c=e.children.length;A<c;A++){const h=e.children[A];if(h.visible||i.onlyVisible===!1){const l=await this.processNodeAsync(h);l!==null&&r.push(l)}}r.length>0&&(n.children=r)}return await this._invokeAllAsync(function(r){r.writeNode&&r.writeNode(e,n)}),a}async processSceneAsync(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const s={};e.name!==""&&(s.name=e.name),t.scenes.push(s);const n=[];for(let a=0,r=e.children.length;a<r;a++){const A=e.children[a];if(A.visible||i.onlyVisible===!1){const c=await this.processNodeAsync(A);c!==null&&n.push(c)}}n.length>0&&(s.nodes=n),this.serializeUserData(e,s)}async processObjectsAsync(e){const t=new ds;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);await this.processSceneAsync(t)}async processInputAsync(e){const t=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync(function(s){s.beforeParse&&s.beforeParse(e)});const i=[];for(let s=0;s<e.length;s++)e[s]instanceof ds?await this.processSceneAsync(e[s]):i.push(e[s]);i.length>0&&await this.processObjectsAsync(i);for(let s=0;s<this.skins.length;++s)this.processSkin(this.skins[s]);for(let s=0;s<t.animations.length;++s)this.processAnimation(t.animations[s],e[0]);await this._invokeAllAsync(function(s){s.afterParse&&s.afterParse(e)})}async _invokeAllAsync(e){for(let t=0,i=this.plugins.length;t<i;t++)await e(this.plugins[t])}}class Tg{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const i=this.writer,s=i.json,n=i.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(1-e.penumbra)*e.angle,a.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},n[this.name]=!0);const r=s.extensions[this.name].lights;r.push(a),t.extensions=t.extensions||{},t.extensions[this.name]={light:r.length-1}}}class Rg{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,t){if(!e.isMeshBasicMaterial)return;const s=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},s[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class Mg{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.clearcoat===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){const a={index:await i.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(a,e.clearcoatMap),n.clearcoatTexture=a}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const a={index:await i.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(a,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=a}if(e.clearcoatNormalMap){const a={index:await i.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};e.clearcoatNormalScale.x!==1&&(a.scale=e.clearcoatNormalScale.x),i.applyTextureTransform(a,e.clearcoatNormalMap),n.clearcoatNormalTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Dg{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.dispersion===0)return;const s=this.writer.extensionsUsed,n={};n.dispersion=e.dispersion,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Lg{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.iridescence===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){const a={index:await i.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(a,e.iridescenceMap),n.iridescenceTexture=a}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const a={index:await i.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(a,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Fg{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){const a={index:await i.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(a,e.transmissionMap),n.transmissionTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class kg{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){const a={index:await i.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(a,e.thicknessMap),n.thicknessTexture=a}e.attenuationDistance!==1/0&&(n.attenuationDistance=e.attenuationDistance),n.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class _g{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.ior===1.5)return;const s=this.writer.extensionsUsed,n={};n.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Ng{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.specularIntensity===1&&e.specularColor.equals(Ig)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.specularIntensityMap){const a={index:await i.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(a,e.specularIntensityMap),n.specularTexture=a}if(e.specularColorMap){const a={index:await i.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(a,e.specularColorMap),n.specularColorTexture=a}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Gg{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.sheen==0)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.sheenRoughnessMap){const a={index:await i.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(a,e.sheenRoughnessMap),n.sheenRoughnessTexture=a}if(e.sheenColorMap){const a={index:await i.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(a,e.sheenColorMap),n.sheenColorTexture=a}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Ug{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.anisotropy==0)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.anisotropyMap){const a={index:await i.processTextureAsync(e.anisotropyMap)};i.applyTextureTransform(a,e.anisotropyMap),n.anisotropyTexture=a}n.anisotropyStrength=e.anisotropy,n.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Og{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||e.emissiveIntensity===1)return;const s=this.writer.extensionsUsed,n={};n.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Pg{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||e.bumpScale===1&&!e.bumpMap)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.bumpMap){const a={index:await i.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(a,e.bumpMap),n.bumpTexture=a}n.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Hg{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,s=e,n=new Float32Array(s.count*3),a=new Float32Array(s.count*4),r=new Float32Array(s.count*3),A=new Pe,c=new G,h=new ms,l=new G;for(let u=0;u<s.count;u++)s.getMatrixAt(u,A),A.decompose(c,h,l),c.toArray(n,u*3),h.toArray(a,u*4),l.toArray(r,u*3);const d={TRANSLATION:i.processAccessor(new ye(n,3)),ROTATION:i.processAccessor(new ye(a,4)),SCALE:i.processAccessor(new ye(r,3))};s.instanceColor&&(d._COLOR_0=i.processAccessor(s.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:d},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}tn.Utils={insertKeyframe:function(o,e){const i=o.getValueSize(),s=new o.TimeBufferType(o.times.length+1),n=new o.ValueBufferType(o.values.length+i),a=o.createInterpolant(new o.ValueBufferType(i));let r;if(o.times.length===0){s[0]=e;for(let A=0;A<i;A++)n[A]=0;r=0}else if(e<o.times[0]){if(Math.abs(o.times[0]-e)<.001)return 0;s[0]=e,s.set(o.times,1),n.set(a.evaluate(e),0),n.set(o.values,i),r=0}else if(e>o.times[o.times.length-1]){if(Math.abs(o.times[o.times.length-1]-e)<.001)return o.times.length-1;s[s.length-1]=e,s.set(o.times,0),n.set(o.values,0),n.set(a.evaluate(e),o.values.length),r=s.length-1}else for(let A=0;A<o.times.length;A++){if(Math.abs(o.times[A]-e)<.001)return A;if(o.times[A]<e&&o.times[A+1]>e){s.set(o.times.slice(0,A+1),0),s[A+1]=e,s.set(o.times.slice(A+1),A+2),n.set(o.values.slice(0,(A+1)*i),0),n.set(a.evaluate(e),(A+1)*i),n.set(o.values.slice((A+1)*i),(A+2)*i),r=A+1;break}}return o.times=s,o.values=n,r},mergeMorphTargetTracks:function(o,e){const t=[],i={},s=o.tracks;for(let n=0;n<s.length;++n){let a=s[n];const r=Zs.parseTrackName(a.name),A=Zs.findNode(e,r.nodeName);if(r.propertyName!=="morphTargetInfluences"||r.propertyIndex===void 0){t.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(Bo)}const c=A.morphTargetInfluences.length,h=A.morphTargetDictionary[r.propertyIndex];if(h===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+r.propertyIndex);let l;if(i[A.uuid]===void 0){l=a.clone();const u=new l.ValueBufferType(c*l.times.length);for(let g=0;g<l.times.length;g++)u[g*c+h]=l.values[g];l.name=(r.nodeName||"")+".morphTargetInfluences",l.values=u,i[A.uuid]=l,t.push(l);continue}const d=a.createInterpolant(new a.ValueBufferType(1));l=i[A.uuid];for(let u=0;u<l.times.length;u++)l.values[u*c+h]=d.evaluate(l.times[u]);for(let u=0;u<a.times.length;u++){const g=this.insertKeyframe(l,a.times[u]);l.values[g*c+h]=a.values[u]}}return o.tracks=t,o},toFloat32BufferAttribute:function(o){const e=new ye(new Float32Array(o.count*o.itemSize),o.itemSize,!1);if(!o.normalized&&!o.isInterleavedBufferAttribute)return e.array.set(o.array),e;for(let t=0,i=o.count;t<i;t++)for(let s=0;s<o.itemSize;s++)e.setComponent(t,s,o.getComponent(t,s));return e}};/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr=o=>o.material!==void 0&&o.userData&&o.userData.variantMaterials&&!!Array.from(o.userData.variantMaterials.values()).filter(e=>Ui(e.material)),Ui=o=>o&&o.isMaterial&&!Array.isArray(o);class qg{constructor(e){this.writer=e,this.name="KHR_materials_variants",this.variantNames=[]}beforeParse(e){const t=new Set,i=s=>{if(!Lr(s))return;const n=s.userData.variantMaterials,a=s.userData.variantData;for(const[r,A]of a){const c=n.get(A.index);c&&Ui(c.material)&&t.add(r)}};if(Array.isArray(e))for(const s of e)s.traverse(i);else e.traverse(i);t.forEach(s=>this.variantNames.push(s))}async writeMesh(e,t){if(!Lr(e))return;const i=e.userData,s=i.variantMaterials,n=i.variantData,a=new Map,r=new Map,A=Array.from(n.values()).sort((l,d)=>l.index-d.index);for(const[l,d]of A.entries())r.set(d.index,l);for(const l of n.values()){const d=s.get(l.index);if(!d||!Ui(d.material))continue;const u=await this.writer.processMaterialAsync(d.material);a.has(u)||a.set(u,{material:u,variants:[]}),a.get(u).variants.push(r.get(l.index))}const c=Array.from(a.values()).map(l=>l.variants.sort((d,u)=>d-u)&&l).sort((l,d)=>l.material-d.material);if(c.length===0)return;const h=Ui(i.originalMaterial)?await this.writer.processMaterialAsync(i.originalMaterial):-1;for(const l of t.primitives)h>=0&&(l.material=h),l.extensions=l.extensions||{},l.extensions[this.name]={mappings:c}}afterParse(){if(this.variantNames.length===0)return;const e=this.writer.json;e.extensions=e.extensions||{};const t=this.variantNames.map(i=>({name:i}));e.extensions[this.name]={variants:t},this.writer.extensionsUsed[this.name]=!0}}class jg{constructor(e,t,i,s,n){this.xrLight=e,this.renderer=t,this.lightProbe=i,this.xrWebGLBinding=null,this.estimationStartCallback=n,this.frameCallback=this.onXRFrame.bind(this);const a=t.xr.getSession();if(s&&"XRWebGLBinding"in window){const r=new Xc(16);e.environment=r.texture;const A=t.getContext();switch(a.preferredReflectionFormat){case"srgba8":A.getExtension("EXT_sRGB");break;case"rgba16f":A.getExtension("OES_texture_half_float");break}this.xrWebGLBinding=new XRWebGLBinding(a,A),this.lightProbe.addEventListener("reflectionchange",()=>{this.updateReflection()})}a.requestAnimationFrame(this.frameCallback)}updateReflection(){const e=this.renderer.properties.get(this.xrLight.environment);if(e){const t=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);t&&(e.__webglTexture=t,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(e,t){if(!this.xrLight)return;t.session.requestAnimationFrame(this.frameCallback);const s=t.getLightEstimate(this.lightProbe);if(s){this.xrLight.lightProbe.sh.fromArray(s.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const n=Math.max(1,Math.max(s.primaryLightIntensity.x,Math.max(s.primaryLightIntensity.y,s.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(s.primaryLightIntensity.x/n,s.primaryLightIntensity.y/n,s.primaryLightIntensity.z/n),this.xrLight.directionalLight.intensity=n,this.xrLight.directionalLight.position.copy(s.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class $g extends Fi{constructor(e,t=!0){super(),this.lightProbe=new su,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new zc,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let i=null,s=!1;e.xr.addEventListener("sessionstart",()=>{const n=e.xr.getSession();"requestLightProbe"in n&&n.requestLightProbe({reflectionFormat:n.preferredReflectionFormat}).then(a=>{i=new jg(this,e,a,t,()=>{s=!0,this.dispatchEvent({type:"estimationstart"})})})}),e.xr.addEventListener("sessionend",()=>{i&&(i.dispose(),i=null),s&&this.dispatchEvent({type:"estimationend"})}),this.dispose=()=>{i&&(i.dispose(),i=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=1e4,Vg=.001,Fl=50;class fe{constructor(e=Fl){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(e)}setDecayTime(e){this.naturalFrequency=1/Math.max(Vg,e)}update(e,t,i,s){const n=2e-4*this.naturalFrequency;if(e==null||s===0||e===t&&this.velocity===0)return t;if(i<0)return e;const a=e-t,r=this.velocity+this.naturalFrequency*a,A=a+i*r,c=Math.exp(-this.naturalFrequency*i),h=(r-this.naturalFrequency*A)*c,l=-this.naturalFrequency*(h+r*c);return Math.abs(h)<n*Math.abs(s)&&l*a>=0?(this.velocity=0,t):(this.velocity=h,t+A*c)}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ge=.2,Fr=.03,zg=.75,kl=12,Kg=Math.PI/(2*kl),kr=new Me,li=(o,e,t)=>{let i=e>0?t>0?0:-Math.PI/2:t>0?Math.PI/2:Math.PI;for(let s=0;s<=kl;++s)o.push(e+(Ge-Fr)*Math.cos(i),t+(Ge-Fr)*Math.sin(i),0,e+Ge*Math.cos(i),t+Ge*Math.sin(i),0),i+=Kg};class _r extends Ie{constructor(e,t){const i=new ln,s=[],n=[],{size:a,boundingBox:r}=e,A=a.x/2,c=(t==="back"?a.y:a.z)/2;li(n,A,c),li(n,-A,c),li(n,-A,-c),li(n,A,-c);const h=n.length/3;for(let u=0;u<h-2;u+=2)s.push(u,u+1,u+3,u,u+3,u+2);const l=h-2;s.push(l,l+1,1,l,1,0),i.setAttribute("position",new iu(n,3)),i.setIndex(s),super(i),this.side=t;const d=this.material;switch(d.side=it,d.transparent=!0,d.opacity=0,this.goalOpacity=0,this.opacityDamper=new fe,this.hitPlane=new Ie(new Qo(2*(A+Ge),2*(c+Ge))),this.hitPlane.visible=!1,this.hitPlane.material.side=it,this.add(this.hitPlane),this.hitBox=new Ie(new mn(a.x+2*Ge,a.y+Ge,a.z+2*Ge)),this.hitBox.visible=!1,this.hitBox.material.side=it,this.add(this.hitBox),r.getCenter(this.position),t){case"bottom":this.rotateX(-Math.PI/2),this.shadowHeight=r.min.y,this.position.y=this.shadowHeight;break;case"back":this.shadowHeight=r.min.z,this.position.z=this.shadowHeight}e.target.add(this),this.hitBox.position.y=(a.y+Ge)/2+r.min.y,e.target.add(this.hitBox),this.offsetHeight=0}getHit(e,t,i){kr.set(t,-i),this.hitPlane.visible=!0;const s=e.positionAndNormalFromPoint(kr,this.hitPlane);return this.hitPlane.visible=!1,s==null?null:s.position}getExpandedHit(e,t,i){this.hitPlane.scale.set(1e3,1e3,1e3),this.hitPlane.updateMatrixWorld();const s=this.getHit(e,t,i);return this.hitPlane.scale.set(1,1,1),s}controllerIntersection(e,t){this.hitBox.visible=!0;const i=e.hitFromController(t,this.hitBox);return this.hitBox.visible=!1,i}set offsetHeight(e){e-=.001,this.side==="back"?this.position.z=this.shadowHeight+e:this.position.y=this.shadowHeight+e}get offsetHeight(){return this.side==="back"?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(e){this.goalOpacity=e?zg:0}updateOpacity(e){const t=this.material;t.opacity=this.opacityDamper.update(t.opacity,this.goalOpacity,e,1),this.visible=t.opacity>0}dispose(){const{geometry:e,material:t}=this.hitPlane;e.dispose(),t.dispose(),this.hitBox.geometry.dispose(),this.hitBox.material.dispose(),this.geometry.dispose(),this.material.dispose(),this.hitBox.removeFromParent(),this.removeFromParent()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=(o,e)=>({type:"number",number:o,unit:e}),st=(()=>{const o={};return t=>{const i=t;if(i in o)return o[i];const s=[];let n=0;for(;t;){if(++n>1e3){t="";break}const a=_l(t),r=a.nodes[0];if(r==null||r.terms.length===0)break;s.push(r),t=a.remainingInput}return o[i]=s}})(),_l=(()=>{const o=/^(\-\-|[a-z\u0240-\uffff])/i,e=/^([\*\+\/]|[\-]\s)/i,t=/^[\),]/,i="(",s="#";return n=>{const a=[];for(;n.length&&(n=n.trim(),!t.test(n));)if(n[0]===i){const{nodes:r,remainingInput:A}=Nr(n);n=A,a.push({type:"function",name:{type:"ident",value:"calc"},arguments:r})}else if(o.test(n)){const r=Jg(n),A=r.nodes[0];if(n=r.remainingInput,n[0]===i){const{nodes:c,remainingInput:h}=Nr(n);a.push({type:"function",name:A,arguments:c}),n=h}else a.push(A)}else if(e.test(n))a.push({type:"operator",value:n[0]}),n=n.slice(1);else{const{nodes:r,remainingInput:A}=n[0]===s?Wg(n):Yg(n);if(r.length===0)break;a.push(r[0]),n=A}return{nodes:[{type:"expression",terms:a}],remainingInput:n}}})(),Jg=(()=>{const o=/[^a-z0-9_\-\u0240-\uffff]/i;return e=>{const t=e.match(o),i=t==null?e:e.substr(0,t.index),s=t==null?"":e.substr(t.index);return{nodes:[{type:"ident",value:i}],remainingInput:s}}})(),Yg=(()=>{const o=/[\+\-]?(\d+[\.]\d+|\d+|[\.]\d+)([eE][\+\-]?\d+)?/,e=/^[a-z%]+/i,t=/^(m|mm|cm|rad|deg|[%])$/;return i=>{const s=i.match(o),n=s==null?"0":s[0];i=n==null?i:i.slice(n.length);const a=i.match(e);let r=a!=null&&a[0]!==""?a[0]:null;const A=a==null?i:i.slice(r.length);return r!=null&&!t.test(r)&&(r=null),{nodes:[{type:"number",number:parseFloat(n)||0,unit:r}],remainingInput:A}}})(),Wg=(()=>{const o=/^[a-f0-9]*/i;return e=>{e=e.slice(1).trim();const t=e.match(o);return{nodes:t==null?[]:[{type:"hex",value:t[0]}],remainingInput:t==null?e:e.slice(t[0].length)}}})(),Nr=o=>{const e=[];for(o=o.slice(1).trim();o.length;){const t=_l(o);if(e.push(t.nodes[0]),o=t.remainingInput.trim(),o[0]===",")o=o.slice(1).trim();else if(o[0]===")"){o=o.slice(1);break}}return{nodes:e,remainingInput:o}},Gr=Symbol("visitedTypes");class Xg{constructor(e){this[Gr]=e}walk(e,t){const i=e.slice();for(;i.length;){const s=i.shift();switch(this[Gr].indexOf(s.type)>-1&&t(s),s.type){case"expression":i.unshift(...s.terms);break;case"function":i.unshift(s.name,...s.arguments);break}}}}const mt=Object.freeze({type:"number",number:0,unit:null});/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=(o,e=0)=>{let{number:t,unit:i}=o;if(!isFinite(t))t=e,i="rad";else if(o.unit==="rad"||o.unit==null)return o;return{type:"number",number:(i==="deg"&&t!=null?t:0)*Math.PI/180,unit:"rad"}},Ur=(o,e=0)=>{let{number:t,unit:i}=o;if(!isFinite(t))t=e,i="m";else if(o.unit==="m")return o;let s;switch(i){default:s=1;break;case"cm":s=1/100;break;case"mm":s=1/1e3;break}return{type:"number",number:s*t,unit:"m"}},Oe=(()=>{const o=t=>t,e={rad:o,deg:En,m:o,mm:Ur,cm:Ur};return(t,i=mt)=>{isFinite(t.number)||(t.number=i.number,t.unit=i.unit);const{unit:s}=t;if(s==null)return t;const n=e[s];return n==null?i:n(t)}})();/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nl,Or,Pr;const bs=Symbol("evaluate"),Oi=Symbol("lastValue");class Z{constructor(){this[Nl]=null}static evaluatableFor(e,t=mt){if(e instanceof Z)return e;if(e.type==="number")return e.unit==="%"?new Zg(e,t):e;switch(e.name.value){case"calc":return new sp(e,t);case"env":return new ep(e)}return mt}static evaluate(e){return e instanceof Z?e.evaluate():e}static isConstant(e){return e instanceof Z?e.isConstant:!0}static applyIntrinsics(e,t){const{basis:i,keywords:s}=t,{auto:n}=s;return i.map((a,r)=>{const A=n[r]==null?a:n[r];let c=e[r]?e[r]:A;if(c.type==="ident"){const h=c.value;h in s&&(c=s[h][r])}return(c==null||c.type==="ident")&&(c=A),c.unit==="%"?le(c.number/100*a.number,a.unit):(c=Oe(c,a),c.unit!==a.unit?a:c)})}get isConstant(){return!1}evaluate(){return(!this.isConstant||this[Oi]==null)&&(this[Oi]=this[bs]()),this[Oi]}}Nl=Oi;const Hr=Symbol("percentage"),Yn=Symbol("basis");class Zg extends Z{constructor(e,t){super(),this[Hr]=e,this[Yn]=t}get isConstant(){return!0}[bs](){return le(this[Hr].number/100*this[Yn].number,this[Yn].unit)}}const hi=Symbol("identNode");class ep extends Z{constructor(e){super(),this[Or]=null;const t=e.arguments.length?e.arguments[0].terms[0]:null;t!=null&&t.type==="ident"&&(this[hi]=t)}get isConstant(){return!1}[(Or=hi,bs)](){if(this[hi]!=null)switch(this[hi].value){case"window-scroll-y":const e=window.pageYOffset,t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);return{type:"number",number:e/(t-window.innerHeight)||0,unit:null}}return mt}}const tp=/[\*\/]/,qt=Symbol("evaluator");class sp extends Z{constructor(e,t=mt){if(super(),this[Pr]=null,e.arguments.length!==1)return;const i=e.arguments[0].terms.slice(),s=[];for(;i.length;){const n=i.shift();if(s.length>0){const a=s[s.length-1];if(a.type==="operator"&&tp.test(a.value)){const r=s.pop(),A=s.pop();if(A==null)return;s.push(new jr(r,Z.evaluatableFor(A,t),Z.evaluatableFor(n,t)));continue}}s.push(n.type==="operator"?n:Z.evaluatableFor(n,t))}for(;s.length>2;){const[n,a,r]=s.splice(0,3);if(a.type!=="operator")return;s.unshift(new jr(a,Z.evaluatableFor(n,t),Z.evaluatableFor(r,t)))}s.length===1&&(this[qt]=s[0])}get isConstant(){return this[qt]==null||Z.isConstant(this[qt])}[(Pr=qt,bs)](){return this[qt]!=null?Z.evaluate(this[qt]):mt}}const qr=Symbol("operator"),Wn=Symbol("left"),Xn=Symbol("right");class jr extends Z{constructor(e,t,i){super(),this[qr]=e,this[Wn]=t,this[Xn]=i}get isConstant(){return Z.isConstant(this[Wn])&&Z.isConstant(this[Xn])}[bs](){const e=Oe(Z.evaluate(this[Wn])),t=Oe(Z.evaluate(this[Xn])),{number:i,unit:s}=e,{number:n,unit:a}=t;if(a!=null&&s!=null&&a!=s)return mt;const r=s||a;let A;switch(this[qr].value){case"+":A=i+n;break;case"-":A=i-n;break;case"/":A=i/n;break;case"*":A=i*n;break;default:return mt}return{type:"number",number:A,unit:r}}}const Zn=Symbol("evaluatables"),$r=Symbol("intrinsics");class Gl extends Z{constructor(e,t){super(),this[$r]=t;const i=e[0],s=i!=null?i.terms:[];this[Zn]=t.basis.map((n,a)=>{const r=s[a];return r==null?{type:"ident",value:"auto"}:r.type==="ident"?r:Z.evaluatableFor(r,n)})}get isConstant(){for(const e of this[Zn])if(!Z.isConstant(e))return!1;return!0}[bs](){const e=this[Zn].map(t=>Z.evaluate(t));return Z.applyIntrinsics(e,this[$r]).map(t=>t.number)}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ul,Ol,Pl,Hl;const jt=Symbol("instances"),Vr=Symbol("activateListener"),zr=Symbol("deactivateListener"),ea=Symbol("notifyInstances"),Kr=Symbol("notify"),Jr=Symbol("callback");class Ne{static[ea](){for(const e of Ne[jt])e[Kr]()}static[(Ul=jt,Vr)](){window.addEventListener("scroll",this[ea],{passive:!0})}static[zr](){window.removeEventListener("scroll",this[ea])}constructor(e){this[Jr]=e}observe(){Ne[jt].size===0&&Ne[Vr](),Ne[jt].add(this)}disconnect(){Ne[jt].delete(this),Ne[jt].size===0&&Ne[zr]()}[Kr](){this[Jr]()}}Ne[Ul]=new Set;const Yr=Symbol("computeStyleCallback"),ql=Symbol("astWalker"),qs=Symbol("dependencies"),jl=Symbol("onScroll");class ip{constructor(e){this[Ol]={},this[Pl]=new Xg(["function"]),this[Hl]=()=>{this[Yr]({relatedState:"window-scroll"})},this[Yr]=e}observeEffectsFor(e){const t={},i=this[qs];this[ql].walk(e,s=>{const{name:n}=s,r=s.arguments[0].terms[0];if(!(n.value!=="env"||r==null||r.type!=="ident"))switch(r.value){case"window-scroll-y":if(t["window-scroll"]==null){const A="window-scroll"in i?i["window-scroll"]:new Ne(this[jl]);A.observe(),delete i["window-scroll"],t["window-scroll"]=A}break}});for(const s in i)i[s].disconnect();this[qs]=t}dispose(){for(const e in this[qs])this[qs][e].disconnect()}}Ol=qs,Pl=ql,Hl=jl;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rt=o=>{const e=o.observeEffects||!1,t=o.intrinsics instanceof Function?o.intrinsics:()=>o.intrinsics;return(i,s)=>{const n=i.updated,a=i.connectedCallback,r=i.disconnectedCallback,A=Symbol(`${s}StyleEffector`),c=Symbol(`${s}StyleEvaluator`),h=Symbol(`${s}UpdateEvaluator`),l=Symbol(`${s}EvaluateAndSync`);Object.defineProperties(i,{[A]:{value:null,writable:!0},[c]:{value:null,writable:!0},[h]:{value:function(){const d=st(this[s]);this[c]=new Gl(d,t(this)),this[A]==null&&e&&(this[A]=new ip(()=>this[l]())),this[A]!=null&&this[A].observeEffectsFor(d)}},[l]:{value:function(){if(this[c]==null)return;const d=this[c].evaluate();this[o.updateHandler](d)}},updated:{value:function(d){d.has(s)&&(this[h](),this[l]()),n.call(this,d)}},connectedCallback:{value:function(){a.call(this),this.requestUpdate(s,this[s])}},disconnectedCallback:{value:function(){r.call(this),this[A]!=null&&(this[A].dispose(),this[A]=null)}}})}};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l=o=>o<.5?2*o*o:-1+(4-2*o)*o,np=(o,e,t=$l)=>i=>o+(e-o)*t(i),ap=(o,e)=>{const t=s=>n=>s+=n,i=e.map(t(0));return s=>{s=Ue(s,0,1),s*=i[i.length-1];const n=i.findIndex(A=>A>=s),a=n<1?0:i[n-1],r=i[n];return o[n]((s-a)/(r-a))}},os=o=>{const e=[],t=[];let i=o.initialValue;for(let s=0;s<o.keyframes.length;++s){const n=o.keyframes[s],{value:a,frames:r}=n,A=n.ease||$l,c=np(i,a,A);e.push(c),t.push(r),i=a}return ap(e,t)};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var te=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const op=5e3,rp=os({initialValue:0,keyframes:[{frames:5,value:-1},{frames:1,value:-1},{frames:8,value:1},{frames:1,value:1},{frames:5,value:0},{frames:18,value:0}]}),Ap=os({initialValue:0,keyframes:[{frames:1,value:1},{frames:5,value:1},{frames:1,value:0},{frames:6,value:0}]}),cp=30,lp=12,Vl="0deg 75deg 105%",hp="auto auto auto",up="auto",dp=2.2,gp=["front","right","back","left"],pp=["upper-","","lower-"],fp=3e3,mp=". Use mouse, touch or arrow keys to move.",ui={AUTO:"auto",NONE:"none"},ta={BASIC:"basic",WIGGLE:"wiggle"},bp={PAN_Y:"pan-y",PAN_X:"pan-x",NONE:"none"},Wr=()=>({basis:[En(le(cp,"deg"))],keywords:{auto:[null]}}),Ip=()=>({basis:[En(le(lp,"deg"))],keywords:{auto:[null]}}),zl=(()=>{const o=st(Vl)[0].terms,e=Oe(o[0]),t=Oe(o[1]);return i=>{const s=i[x].idealCameraDistance();return{basis:[e,t,le(s,"m")],keywords:{auto:[null,null,le(105,"%")]}}}})(),Ep=o=>{const e=dp*o[x].boundingSphere.radius;return{basis:[le(-1/0,"rad"),le(0,"rad"),le(e,"m")],keywords:{auto:[null,null,null]}}},Cp=o=>{const e=zl(o),i=new Gl([],e).evaluate()[2];return{basis:[le(1/0,"rad"),le(Math.PI,"rad"),le(i,"m")],keywords:{auto:[null,null,null]}}},Bp=o=>{const e=o[x].boundingBox.getCenter(new G);return{basis:[le(e.x,"m"),le(e.y,"m"),le(e.z,"m")],keywords:{auto:[null,null,null]}}},Kl=Math.PI/2,yp=Math.PI/3,wp=Kl/2,Qp=2*Math.PI,z=Symbol("controls"),Pi=Symbol("panElement"),sa=Symbol("promptElement"),di=Symbol("promptAnimatedContainer"),ia=Symbol("fingerAnimatedContainers"),gi=Symbol("deferInteractionPrompt"),Xr=Symbol("updateAria"),ze=Symbol("a11y"),Zr=Symbol("updateA11y"),eA=Symbol("updateCameraForRadius"),$t=Symbol("cancelPrompts"),na=Symbol("onChange"),ys=Symbol("onPointerChange"),Ct=Symbol("waitingToPromptUser"),pi=Symbol("userHasInteracted"),Vt=Symbol("promptElementVisibleTime"),ws=Symbol("lastPromptOffset"),fi=Symbol("cancellationSource"),aa=Symbol("lastSpherical"),Qs=Symbol("jumpCamera"),oa=Symbol("initialized"),xs=Symbol("maintainThetaPhi"),tA=Symbol("syncCameraOrbit"),sA=Symbol("syncFieldOfView"),iA=Symbol("syncCameraTarget"),nA=Symbol("syncMinCameraOrbit"),aA=Symbol("syncMaxCameraOrbit"),oA=Symbol("syncMinFieldOfView"),rA=Symbol("syncMaxFieldOfView"),xp=o=>{var e,t,i,s,n,a,r,A,c,h,l,d,u,g,p,f,m,I;class C extends o{constructor(){super(...arguments),this.cameraControls=!1,this.cameraOrbit=Vl,this.cameraTarget=hp,this.fieldOfView=up,this.minCameraOrbit="auto",this.maxCameraOrbit="auto",this.minFieldOfView="auto",this.maxFieldOfView="auto",this.interactionPromptThreshold=fp,this.interactionPrompt=ui.AUTO,this.interactionPromptStyle=ta.WIGGLE,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.touchAction=bp.NONE,this.disableZoom=!1,this.disablePan=!1,this.disableTap=!1,this.interpolationDecay=Fl,this.a11y=null,this[e]=this.shadowRoot.querySelector(".interaction-prompt"),this[t]=this.shadowRoot.querySelector("#prompt"),this[i]=[this.shadowRoot.querySelector("#finger0"),this.shadowRoot.querySelector("#finger1")],this[s]=this.shadowRoot.querySelector(".pan-target"),this[n]=0,this[a]=1/0,this[r]=!1,this[A]=!1,this[c]=ee.AUTOMATIC,this[h]=new Rp(this[x].camera,this[Fe],this[x]),this[l]=new _i,this[d]=!1,this[u]=!1,this[g]=!1,this[p]={},this[f]=()=>{const b=this[z].changeSource;this[fi]=b,b===ee.USER_INTERACTION&&(this[pi]=!0,this[gi]())},this[m]=()=>{this[Xr](),this[ne]();const b=this[z].changeSource;this.dispatchEvent(new CustomEvent("camera-change",{detail:{source:b}}))},this[I]=b=>{this[ji].classList.toggle("pointer-tumbling",b.type==="pointer-change-start")}}get inputSensitivity(){return this[z].inputSensitivity}set inputSensitivity(b){this[z].inputSensitivity=b}getCameraOrbit(){const{theta:b,phi:y,radius:w}=this[aa];return{theta:b,phi:y,radius:w,toString(){return`${this.theta}rad ${this.phi}rad ${this.radius}m`}}}getCameraTarget(){return ht(this[K].isPresenting?this[K].arRenderer.target:this[x].getDynamicTarget())}getFieldOfView(){return this[z].getFieldOfView()}getMinimumFieldOfView(){return this[z].options.minimumFieldOfView}getMaximumFieldOfView(){return this[z].options.maximumFieldOfView}getIdealAspect(){return this[x].idealAspect}jumpCameraToGoal(){this[Qs]=!0,this.requestUpdate(Qs,!1)}resetInteractionPrompt(){this[ws]=0,this[Vt]=1/0,this[pi]=!1,this[Ct]=this.interactionPrompt===ui.AUTO&&this.cameraControls}zoom(b){const y=new WheelEvent("wheel",{deltaY:-30*b});this[Fe].dispatchEvent(y)}connectedCallback(){super.connectedCallback(),this[z].addEventListener("user-interaction",this[$t]),this[z].addEventListener("pointer-change-start",this[ys]),this[z].addEventListener("pointer-change-end",this[ys])}disconnectedCallback(){super.disconnectedCallback(),this[z].removeEventListener("user-interaction",this[$t]),this[z].removeEventListener("pointer-change-start",this[ys]),this[z].removeEventListener("pointer-change-end",this[ys])}updated(b){super.updated(b);const y=this[z],w=this[x];if(b.has("cameraControls")&&(this.cameraControls?(y.enableInteraction(),this.interactionPrompt===ui.AUTO&&(this[Ct]=!0)):(y.disableInteraction(),this[gi]()),this[Fe].setAttribute("aria-label",this[As])),b.has("disableZoom")&&(y.disableZoom=this.disableZoom),b.has("disablePan")&&(y.enablePan=!this.disablePan),b.has("disableTap")&&(y.enableTap=!this.disableTap),(b.has("interactionPrompt")||b.has("cameraControls")||b.has("src"))&&(this.interactionPrompt===ui.AUTO&&this.cameraControls&&!this[pi]?this[Ct]=!0:this[gi]()),b.has("interactionPromptStyle")&&(this[di].style.opacity=this.interactionPromptStyle==ta.BASIC?"1":"0"),b.has("touchAction")){const B=this.touchAction;y.applyOptions({touchAction:B}),y.updateTouchActionStyle()}b.has("orbitSensitivity")&&(y.orbitSensitivity=this.orbitSensitivity),b.has("zoomSensitivity")&&(y.zoomSensitivity=this.zoomSensitivity),b.has("panSensitivity")&&(y.panSensitivity=this.panSensitivity),b.has("interpolationDecay")&&(y.setDamperDecayTime(this.interpolationDecay),w.setTargetDamperDecayTime(this.interpolationDecay)),b.has("a11y")&&this[Zr](),this[Qs]===!0&&Promise.resolve().then(()=>{y.jumpToGoal(),w.jumpToGoal(),this[na](),this[Qs]=!1})}async updateFraming(){const b=this[x],y=b.adjustedFoV(b.framedFoVDeg);await b.updateFraming();const w=b.adjustedFoV(b.framedFoVDeg),B=this[z].getFieldOfView()/y;this[z].setFieldOfView(w*B),this[xs]=!0,this.requestUpdate("maxFieldOfView"),this.requestUpdate("fieldOfView"),this.requestUpdate("minCameraOrbit"),this.requestUpdate("maxCameraOrbit"),this.requestUpdate("cameraOrbit"),await this.updateComplete}interact(b,y,w){const B=this[Fe],Q=this[ia];if(Q[0].style.opacity==="1"){console.warn("interact() failed because an existing interaction is running.");return}const S=new Array;S.push({x:os(y.x),y:os(y.y)});const R=[{x:S[0].x(0),y:S[0].y(0)}];w!=null&&(S.push({x:os(w.x),y:os(w.y)}),R.push({x:S[1].x(0),y:S[1].y(0)}));let D=performance.now();const{width:k,height:v}=this[x],M=this.getBoundingClientRect(),L=H=>{for(const[J,$]of R.entries()){const{style:V}=Q[J];V.transform=`translateX(${k*$.x}px) translateY(${v*$.y}px)`,H==="pointerdown"?V.opacity="1":H==="pointerup"&&(V.opacity="0");const Y={pointerId:J-5678,pointerType:"touch",target:B,clientX:k*$.x+M.x,clientY:v*$.y+M.y,altKey:!0};B.dispatchEvent(new PointerEvent(H,Y))}},F=()=>{const H=this[fi];if(H!==ee.AUTOMATIC||!B.isConnected){for(const $ of this[ia])$.style.opacity="0";L("pointercancel"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:H}})),document.removeEventListener("visibilitychange",q);return}const J=Math.min(1,(performance.now()-D)/b);for(const[$,V]of R.entries())V.x=S[$].x(J),V.y=S[$].y(J);L("pointermove"),J<1?requestAnimationFrame(F):(L("pointerup"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:ee.AUTOMATIC}})),document.removeEventListener("visibilitychange",q))},q=()=>{let H=0;document.visibilityState==="hidden"?H=performance.now()-D:D=performance.now()-H};document.addEventListener("visibilitychange",q),L("pointerdown"),this[fi]=ee.AUTOMATIC,requestAnimationFrame(F)}[(e=sa,t=di,i=ia,s=Pi,n=ws,a=Vt,r=pi,A=Ct,c=fi,h=z,l=aa,d=Qs,u=oa,g=xs,p=ze,sA)](b){const y=this[z],w=this[x];w.framedFoVDeg=b[0]*180/Math.PI,y.changeSource=ee.NONE,y.setFieldOfView(w.adjustedFoV(w.framedFoVDeg)),this[$t]()}[tA](b){const y=this[z];if(this[xs]){const{theta:w,phi:B}=this.getCameraOrbit();b[0]=w,b[1]=B,this[xs]=!1}y.changeSource=ee.NONE,y.setOrbit(b[0],b[1],b[2]),this[$t]()}[nA](b){this[z].applyOptions({minimumAzimuthalAngle:b[0],minimumPolarAngle:b[1],minimumRadius:b[2]}),this.jumpCameraToGoal()}[aA](b){this[z].applyOptions({maximumAzimuthalAngle:b[0],maximumPolarAngle:b[1],maximumRadius:b[2]}),this[eA](b[2]),this.jumpCameraToGoal()}[oA](b){this[z].applyOptions({minimumFieldOfView:b[0]*180/Math.PI}),this.jumpCameraToGoal()}[rA](b){const y=this[x].adjustedFoV(b[0]*180/Math.PI);this[z].applyOptions({maximumFieldOfView:y}),this.jumpCameraToGoal()}[iA](b){const[y,w,B]=b;this[K].arRenderer.isPresenting||this[x].setTarget(y,w,B),this[z].changeSource=ee.NONE,this[K].arRenderer.updateTarget(),this[$t]()}[He](b,y){if(super[He](b,y),this[K].isPresenting||!this[Nt]())return;const w=this[z],B=this[x],Q=performance.now();if(this[Ct]&&this.loaded&&Q>this[Vs]+this.interactionPromptThreshold&&(this[Ct]=!1,this[Vt]=Q,this[sa].classList.add("visible")),isFinite(this[Vt])&&this.interactionPromptStyle===ta.WIGGLE){const D=(Q-this[Vt])/op%1,k=rp(D),v=Ap(D);if(this[di].style.opacity=`${v}`,k!==this[ws]){const M=k*B.width*.05,L=(k-this[ws])*Math.PI/16;this[di].style.transform=`translateX(${M}px)`,w.changeSource=ee.AUTOMATIC,w.adjustOrbit(L,0,0),this[ws]=k}}const S=w.update(b,y),R=B.updateTarget(y);(S||R)&&this[na]()}[gi](){this[Ct]=!1,this[sa].classList.remove("visible"),this[Vt]=1/0}[eA](b){const y=Math.max(this[x].farRadius(),b),w=0,B=Math.abs(2*y);this[z].updateNearFar(w,B)}[Xr](){const{theta:b,phi:y}=this[z].getCameraSpherical(this[aa]),w=(4+Math.floor((b%Qp+wp)/Kl))%4,B=Math.floor(y/yp),Q=gp[w],R=`${pp[B]}${Q}`,D=R;D in this[ze]?this[on](this[ze][D]):this[on](`View from stage ${R}`)}get[As](){let b=mp;return"interaction-prompt"in this[ze]&&(b=`. ${this[ze]["interaction-prompt"]}`),super[As].replace(/\.$/,"")+(this.cameraControls?b:"")}async[rn](b){const y=this[z],w=this[x],B=w.adjustedFoV(w.framedFoVDeg);super[rn](b);const Q=w.adjustedFoV(w.framedFoVDeg)/B,S=y.getFieldOfView()*(isFinite(Q)?Q:1);y.updateAspect(this[x].aspect),this.requestUpdate("maxFieldOfView",this.maxFieldOfView),await this.updateComplete,this[z].setFieldOfView(S),this.jumpCameraToGoal()}[qe](){super[qe](),this[oa]?this[xs]=!0:this[oa]=!0,this.requestUpdate("maxFieldOfView",this.maxFieldOfView),this.requestUpdate("fieldOfView",this.fieldOfView),this.requestUpdate("minCameraOrbit",this.minCameraOrbit),this.requestUpdate("maxCameraOrbit",this.maxCameraOrbit),this.requestUpdate("cameraOrbit",this.cameraOrbit),this.requestUpdate("cameraTarget",this.cameraTarget),this.jumpCameraToGoal()}[(f=$t,m=na,I=ys,Zr)](){if(typeof this.a11y=="string")if(this.a11y.startsWith("{"))try{this[ze]=JSON.parse(this.a11y)}catch(b){console.warn("Error parsing a11y JSON:",b)}else this.a11y.length>0?console.warn("Error not supported format, should be a JSON string:",this.a11y):this[ze]={};else typeof this.a11y=="object"&&this.a11y!=null?this[ze]=Object.assign({},this.a11y):this[ze]={};this[Fe].setAttribute("aria-label",this[As])}}return te([_({type:Boolean,attribute:"camera-controls"})],C.prototype,"cameraControls",void 0),te([rt({intrinsics:zl,observeEffects:!0,updateHandler:tA}),_({type:String,attribute:"camera-orbit",hasChanged:()=>!0})],C.prototype,"cameraOrbit",void 0),te([rt({intrinsics:Bp,observeEffects:!0,updateHandler:iA}),_({type:String,attribute:"camera-target",hasChanged:()=>!0})],C.prototype,"cameraTarget",void 0),te([rt({intrinsics:Wr,observeEffects:!0,updateHandler:sA}),_({type:String,attribute:"field-of-view",hasChanged:()=>!0})],C.prototype,"fieldOfView",void 0),te([rt({intrinsics:Ep,updateHandler:nA}),_({type:String,attribute:"min-camera-orbit",hasChanged:()=>!0})],C.prototype,"minCameraOrbit",void 0),te([rt({intrinsics:Cp,updateHandler:aA}),_({type:String,attribute:"max-camera-orbit",hasChanged:()=>!0})],C.prototype,"maxCameraOrbit",void 0),te([rt({intrinsics:Ip,updateHandler:oA}),_({type:String,attribute:"min-field-of-view",hasChanged:()=>!0})],C.prototype,"minFieldOfView",void 0),te([rt({intrinsics:Wr,updateHandler:rA}),_({type:String,attribute:"max-field-of-view",hasChanged:()=>!0})],C.prototype,"maxFieldOfView",void 0),te([_({type:Number,attribute:"interaction-prompt-threshold"})],C.prototype,"interactionPromptThreshold",void 0),te([_({type:String,attribute:"interaction-prompt"})],C.prototype,"interactionPrompt",void 0),te([_({type:String,attribute:"interaction-prompt-style"})],C.prototype,"interactionPromptStyle",void 0),te([_({type:Number,attribute:"orbit-sensitivity"})],C.prototype,"orbitSensitivity",void 0),te([_({type:Number,attribute:"zoom-sensitivity"})],C.prototype,"zoomSensitivity",void 0),te([_({type:Number,attribute:"pan-sensitivity"})],C.prototype,"panSensitivity",void 0),te([_({type:String,attribute:"touch-action"})],C.prototype,"touchAction",void 0),te([_({type:Boolean,attribute:"disable-zoom"})],C.prototype,"disableZoom",void 0),te([_({type:Boolean,attribute:"disable-pan"})],C.prototype,"disablePan",void 0),te([_({type:Boolean,attribute:"disable-tap"})],C.prototype,"disableTap",void 0),te([_({type:Number,attribute:"interpolation-decay"})],C.prototype,"interpolationDecay",void 0),te([_()],C.prototype,"a11y",void 0),C};/* @license
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp=.018,AA=2,vp=300,Tp=new Me,cA=new G,lA=Object.freeze({minimumRadius:0,maximumRadius:1/0,minimumPolarAngle:0,maximumPolarAngle:Math.PI,minimumAzimuthalAngle:-1/0,maximumAzimuthalAngle:1/0,minimumFieldOfView:10,maximumFieldOfView:45,touchAction:"none"}),mi=Math.PI/8,bi=.04,Ii=10,ee={USER_INTERACTION:"user-interaction",NONE:"none",AUTOMATIC:"automatic"};class Rp extends fn{constructor(e,t,i){super(),this.camera=e,this.element=t,this.scene=i,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.inputSensitivity=1,this.changeSource=ee.NONE,this._interactionEnabled=!1,this._disableZoom=!1,this.isUserPointing=!1,this.enablePan=!0,this.enableTap=!0,this.panProjection=new xo,this.panPerPixel=0,this.spherical=new _i,this.goalSpherical=new _i,this.thetaDamper=new fe,this.phiDamper=new fe,this.radiusDamper=new fe,this.logFov=Math.log(lA.maximumFieldOfView),this.goalLogFov=this.logFov,this.fovDamper=new fe,this.touchMode=null,this.pointers=[],this.startTime=0,this.startPointerPosition={clientX:0,clientY:0},this.lastSeparation=0,this.touchDecided=!1,this.onContext=s=>{if(this.enablePan)s.preventDefault();else for(const n of this.pointers)this.onPointerUp(new PointerEvent("pointercancel",Object.assign(Object.assign({},this.startPointerPosition),{pointerId:n.id})))},this.touchModeZoom=(s,n)=>{if(!this._disableZoom){const a=this.twoTouchDistance(this.pointers[0],this.pointers[1]),r=bi*this.zoomSensitivity*(this.lastSeparation-a)*50/this.scene.height;this.lastSeparation=a,this.userAdjustOrbit(0,0,r)}this.panPerPixel>0&&this.movePan(s,n)},this.disableScroll=s=>{s.preventDefault()},this.touchModeRotate=(s,n)=>{const{touchAction:a}=this._options;if(!this.touchDecided&&a!=="none"){this.touchDecided=!0;const r=Math.abs(s),A=Math.abs(n);if(this.changeSource===ee.USER_INTERACTION&&(a==="pan-y"&&A>r||a==="pan-x"&&r>A)){this.touchMode=null;return}else this.element.addEventListener("touchmove",this.disableScroll,{passive:!1})}this.handleSinglePointerMove(s,n)},this.onPointerDown=s=>{if(this.pointers.length>2)return;const{element:n}=this;this.pointers.length===0&&(n.addEventListener("pointermove",this.onPointerMove),n.addEventListener("pointerup",this.onPointerUp),this.touchMode=null,this.touchDecided=!1,this.startPointerPosition.clientX=s.clientX,this.startPointerPosition.clientY=s.clientY,this.startTime=performance.now());try{n.setPointerCapture(s.pointerId)}catch{}this.pointers.push({clientX:s.clientX,clientY:s.clientY,id:s.pointerId}),this.isUserPointing=!1,s.pointerType==="touch"?(this.changeSource=s.altKey?ee.AUTOMATIC:ee.USER_INTERACTION,this.onTouchChange(s)):(this.changeSource=ee.USER_INTERACTION,this.onMouseDown(s)),this.changeSource===ee.USER_INTERACTION&&this.dispatchEvent({type:"user-interaction"})},this.onPointerMove=s=>{const n=this.pointers.find(c=>c.id===s.pointerId);if(n==null)return;if(s.pointerType==="mouse"&&s.buttons===0){this.onPointerUp(s);return}const a=this.pointers.length,r=(s.clientX-n.clientX)/a,A=(s.clientY-n.clientY)/a;r===0&&A===0||(n.clientX=s.clientX,n.clientY=s.clientY,s.pointerType==="touch"?(this.changeSource=s.altKey?ee.AUTOMATIC:ee.USER_INTERACTION,this.touchMode!==null&&this.touchMode(r,A)):(this.changeSource=ee.USER_INTERACTION,this.panPerPixel>0?this.movePan(r,A):this.handleSinglePointerMove(r,A)))},this.onPointerUp=s=>{const{element:n}=this,a=this.pointers.findIndex(r=>r.id===s.pointerId);a!==-1&&this.pointers.splice(a,1),this.panPerPixel>0&&!s.altKey&&this.resetRadius(),this.pointers.length===0?(n.removeEventListener("pointermove",this.onPointerMove),n.removeEventListener("pointerup",this.onPointerUp),n.removeEventListener("touchmove",this.disableScroll),this.enablePan&&this.enableTap&&this.recenter(s)):this.touchMode!==null&&this.onTouchChange(s),this.scene.element[Pi].style.opacity=0,n.style.cursor="grab",this.panPerPixel=0,this.isUserPointing&&this.dispatchEvent({type:"pointer-change-end"})},this.onWheel=s=>{this.changeSource=ee.USER_INTERACTION;const n=s.deltaY*(s.deltaMode==1?18:1)*bi*this.zoomSensitivity/30;this.userAdjustOrbit(0,0,n),s.preventDefault(),this.dispatchEvent({type:"user-interaction"})},this.onKeyDown=s=>{const{changeSource:n}=this;this.changeSource=ee.USER_INTERACTION,(s.shiftKey&&this.enablePan?this.panKeyCodeHandler(s):this.orbitZoomKeyCodeHandler(s))?(s.preventDefault(),this.dispatchEvent({type:"user-interaction"})):this.changeSource=n},this._options=Object.assign({},lA),this.setOrbit(0,Math.PI/2,1),this.setFieldOfView(100),this.jumpToGoal()}get interactionEnabled(){return this._interactionEnabled}enableInteraction(){if(this._interactionEnabled===!1){const{element:e}=this;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointercancel",this.onPointerUp),this._disableZoom||e.addEventListener("wheel",this.onWheel),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("touchmove",()=>{},{passive:!1}),e.addEventListener("contextmenu",this.onContext),this.element.style.cursor="grab",this._interactionEnabled=!0,this.updateTouchActionStyle()}}disableInteraction(){if(this._interactionEnabled===!0){const{element:e}=this;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp),e.removeEventListener("wheel",this.onWheel),e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("contextmenu",this.onContext),e.style.cursor="",this.touchMode=null,this._interactionEnabled=!1,this.updateTouchActionStyle()}}get options(){return this._options}set disableZoom(e){this._disableZoom!=e&&(this._disableZoom=e,e===!0?this.element.removeEventListener("wheel",this.onWheel):this.element.addEventListener("wheel",this.onWheel),this.updateTouchActionStyle())}getCameraSpherical(e=new _i){return e.copy(this.spherical)}getFieldOfView(){return this.camera.fov}applyOptions(e){Object.assign(this._options,e),this.setOrbit(),this.setFieldOfView(Math.exp(this.goalLogFov))}updateNearFar(e,t){this.camera.far=t===0?2:t,this.camera.near=Math.max(e,this.camera.far/1e3),this.camera.updateProjectionMatrix()}updateAspect(e){this.camera.aspect=e,this.camera.updateProjectionMatrix()}setOrbit(e=this.goalSpherical.theta,t=this.goalSpherical.phi,i=this.goalSpherical.radius){const{minimumAzimuthalAngle:s,maximumAzimuthalAngle:n,minimumPolarAngle:a,maximumPolarAngle:r,minimumRadius:A,maximumRadius:c}=this._options,{theta:h,phi:l,radius:d}=this.goalSpherical,u=Ue(e,s,n);!isFinite(s)&&!isFinite(n)&&(this.spherical.theta=this.wrapAngle(this.spherical.theta-u)+u);const g=Ue(t,a,r),p=Ue(i,A,c);return u===h&&g===l&&p===d||!isFinite(u)||!isFinite(g)||!isFinite(p)?!1:(this.goalSpherical.theta=u,this.goalSpherical.phi=g,this.goalSpherical.radius=p,this.goalSpherical.makeSafe(),!0)}setRadius(e){this.goalSpherical.radius=e,this.setOrbit()}setFieldOfView(e){const{minimumFieldOfView:t,maximumFieldOfView:i}=this._options;e=Ue(e,t,i),this.goalLogFov=Math.log(e)}setDamperDecayTime(e){this.thetaDamper.setDecayTime(e),this.phiDamper.setDecayTime(e),this.radiusDamper.setDecayTime(e),this.fovDamper.setDecayTime(e)}adjustOrbit(e,t,i){const{theta:s,phi:n,radius:a}=this.goalSpherical,{minimumRadius:r,maximumRadius:A,minimumFieldOfView:c,maximumFieldOfView:h}=this._options,l=this.spherical.theta-s,d=Math.PI-.001,u=s-Ue(e,-d-l,d-l),g=n-t,p=i===0?0:((i>0?A:r)-a)/(Math.log(i>0?h:c)-this.goalLogFov),f=a+i*(isFinite(p)?p:(A-r)*2);if(this.setOrbit(u,g,f),i!==0){const m=this.goalLogFov+i;this.setFieldOfView(Math.exp(m))}}jumpToGoal(){this.update(0,Ll)}update(e,t){if(this.isStationary())return!1;const{maximumPolarAngle:i,maximumRadius:s}=this._options,n=this.spherical.theta-this.goalSpherical.theta;return Math.abs(n)>Math.PI&&!isFinite(this._options.minimumAzimuthalAngle)&&!isFinite(this._options.maximumAzimuthalAngle)&&(this.spherical.theta-=Math.sign(n)*2*Math.PI),this.spherical.theta=this.thetaDamper.update(this.spherical.theta,this.goalSpherical.theta,t,Math.PI),this.spherical.phi=this.phiDamper.update(this.spherical.phi,this.goalSpherical.phi,t,i),this.spherical.radius=this.radiusDamper.update(this.spherical.radius,this.goalSpherical.radius,t,s),this.logFov=this.fovDamper.update(this.logFov,this.goalLogFov,t,1),this.moveCamera(),!0}updateTouchActionStyle(){const{style:e}=this.element;if(this._interactionEnabled){const{touchAction:t}=this._options;this._disableZoom&&t!=="none"?e.touchAction="manipulation":e.touchAction=t}else e.touchAction=""}isStationary(){return this.goalSpherical.theta===this.spherical.theta&&this.goalSpherical.phi===this.spherical.phi&&this.goalSpherical.radius===this.spherical.radius&&this.goalLogFov===this.logFov}moveCamera(){this.spherical.makeSafe(),this.camera.position.setFromSpherical(this.spherical),this.camera.setRotationFromEuler(new Zc(this.spherical.phi-Math.PI/2,this.spherical.theta,0,"YXZ")),this.camera.fov!==Math.exp(this.logFov)&&(this.camera.fov=Math.exp(this.logFov),this.camera.updateProjectionMatrix())}userAdjustOrbit(e,t,i){this.adjustOrbit(e*this.orbitSensitivity*this.inputSensitivity,t*this.orbitSensitivity*this.inputSensitivity,i*this.inputSensitivity)}wrapAngle(e){const t=(e+Math.PI)/(2*Math.PI);return(t-Math.floor(t))*2*Math.PI-Math.PI}pixelLengthToSphericalAngle(e){return 2*Math.PI*e/this.scene.height}twoTouchDistance(e,t){const{clientX:i,clientY:s}=e,{clientX:n,clientY:a}=t,r=n-i,A=a-s;return Math.sqrt(r*r+A*A)}handleSinglePointerMove(e,t){const i=this.pixelLengthToSphericalAngle(e),s=this.pixelLengthToSphericalAngle(t);this.isUserPointing===!1&&(this.isUserPointing=!0,this.dispatchEvent({type:"pointer-change-start"})),this.userAdjustOrbit(i,s,0)}initializePan(){const{theta:e,phi:t}=this.spherical,i=e-this.scene.yaw;this.panPerPixel=Sp*this.panSensitivity/this.scene.height,this.panProjection.set(-Math.cos(i),-Math.cos(t)*Math.sin(i),0,0,Math.sin(t),0,Math.sin(i),-Math.cos(t)*Math.cos(i),0)}movePan(e,t){const{scene:i}=this,s=cA.set(e,t,0).multiplyScalar(this.inputSensitivity),n=this.spherical.radius*Math.exp(this.logFov)*this.panPerPixel;s.multiplyScalar(n);const a=i.getTarget();a.add(s.applyMatrix3(this.panProjection)),i.boundingSphere.clampPoint(a,a),i.setTarget(a.x,a.y,a.z)}recenter(e){if(performance.now()>this.startTime+vp||Math.abs(e.clientX-this.startPointerPosition.clientX)>AA||Math.abs(e.clientY-this.startPointerPosition.clientY)>AA)return;const{scene:t}=this,i=t.positionAndNormalFromPoint(t.getNDC(e.clientX,e.clientY));if(i==null){const{cameraTarget:s}=t.element;t.element.cameraTarget="",t.element.cameraTarget=s,this.userAdjustOrbit(0,0,1)}else t.target.worldToLocal(i.position),t.setTarget(i.position.x,i.position.y,i.position.z)}resetRadius(){const{scene:e}=this,t=e.positionAndNormalFromPoint(Tp.set(0,0));if(t==null)return;e.target.worldToLocal(t.position);const i=e.getTarget(),{theta:s,phi:n}=this.spherical,a=s-e.yaw,r=cA.set(Math.sin(n)*Math.sin(a),Math.cos(n),Math.sin(n)*Math.cos(a)),A=r.dot(t.position.sub(i));i.add(r.multiplyScalar(A)),e.setTarget(i.x,i.y,i.z),this.setOrbit(void 0,void 0,this.goalSpherical.radius-A)}onTouchChange(e){if(this.pointers.length===1)this.touchMode=this.touchModeRotate;else{if(this._disableZoom){this.touchMode=null,this.element.removeEventListener("touchmove",this.disableScroll);return}this.touchMode=this.touchDecided&&this.touchMode===null?null:this.touchModeZoom,this.touchDecided=!0,this.element.addEventListener("touchmove",this.disableScroll,{passive:!1}),this.lastSeparation=this.twoTouchDistance(this.pointers[0],this.pointers[1]),this.enablePan&&this.touchMode!=null&&(this.initializePan(),e.altKey||(this.scene.element[Pi].style.opacity=1))}}onMouseDown(e){this.panPerPixel=0,this.enablePan&&(e.button===2||e.ctrlKey||e.metaKey||e.shiftKey)&&(this.initializePan(),this.scene.element[Pi].style.opacity=1),this.element.style.cursor="grabbing"}orbitZoomKeyCodeHandler(e){let t=!0;switch(e.key){case"PageUp":this.userAdjustOrbit(0,0,bi*this.zoomSensitivity);break;case"PageDown":this.userAdjustOrbit(0,0,-1*bi*this.zoomSensitivity);break;case"ArrowUp":this.userAdjustOrbit(0,-mi,0);break;case"ArrowDown":this.userAdjustOrbit(0,mi,0);break;case"ArrowLeft":this.userAdjustOrbit(-mi,0,0);break;case"ArrowRight":this.userAdjustOrbit(mi,0,0);break;default:t=!1;break}return t}panKeyCodeHandler(e){this.initializePan();let t=!0;switch(e.key){case"ArrowUp":this.movePan(0,-1*Ii);break;case"ArrowDown":this.movePan(0,Ii);break;case"ArrowLeft":this.movePan(-1*Ii,0);break;case"ArrowRight":this.movePan(Ii,0);break;default:t=!1;break}return t}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp=30,hA=.8,uA=1.5,Dp=20,Lp=.2,Fp=.25,kp=10,zt=150,dA=5,_p=.1,lt={NOT_PRESENTING:"not-presenting",SESSION_STARTED:"session-started",OBJECT_PLACED:"object-placed",FAILED:"failed"},ro={TRACKING:"tracking",NOT_TRACKING:"not-tracking"},Ss=new G,Kt=new ms,Np=new Pe,Gp=new G,Up=new zi(45,1,.1,100),gA=new ln().setFromPoints([new G(0,0,0),new G(0,0,-1)]),Op=new mn;class Pp extends fn{constructor(e){super(),this.renderer=e,this.currentSession=null,this.placeOnWall=!1,this.placementBox=null,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.initialHitSource=null,this.transientHitTestSource=null,this.inputSource=null,this._presentedScene=null,this.resolveCleanup=null,this.exitWebXRButtonContainer=null,this.overlay=null,this.xrLight=null,this.xrMode=null,this.controller1=null,this.controller2=null,this.selectedController=null,this.tracking=!0,this.frames=0,this.initialized=!1,this.oldTarget=new G,this.placementComplete=!1,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new G,this.relativeOrientation=new ms,this.scaleLine=new Wa(gA),this.firstRatio=0,this.lastAngle=0,this.goalPosition=new G,this.goalYaw=0,this.goalScale=1,this.xDamper=new fe,this.yDamper=new fe,this.zDamper=new fe,this.yawDamper=new fe,this.pitchDamper=new fe,this.rollDamper=new fe,this.scaleDamper=new fe,this.onExitWebXRButtonContainerClick=()=>this.stopPresenting(),this.onControllerSelectStart=t=>{const i=this.presentedScene,s=t.target;if(this.placementBox.controllerIntersection(i,s)!=null)this.selectedController!=null&&(this.selectedController.userData.line.visible=!1,i.canScale&&(this.isTwoFingering=!0,this.firstRatio=this.controllerSeparation()/i.pivot.scale.x,this.scaleLine.visible=!0)),s.attach(i.pivot),this.selectedController=s,i.setShadowIntensity(.01);else{const n=s===this.controller1?this.controller2:this.controller1;this.relativeOrientation.copy(s.quaternion).invert().multiply(i.pivot.getWorldQuaternion(Kt)),n.userData.turning=!1,s.userData.turning=!0,s.userData.line.visible=!1}},this.onControllerSelectEnd=t=>{const i=t.target;if(i.userData.turning=!1,i.userData.line.visible=!0,this.isTwoFingering=!1,this.scaleLine.visible=!1,this.selectedController!=null&&this.selectedController!=i)return;const s=this.presentedScene;s.attach(s.pivot),this.selectedController=null,this.goalYaw=Math.atan2(s.pivot.matrix.elements[8],s.pivot.matrix.elements[10]),this.goalPosition.x=s.pivot.position.x,this.goalPosition.z=s.pivot.position.z},this.onUpdateScene=()=>{this.placementBox!=null&&this.isPresenting&&(this.placementBox.dispose(),this.placementBox=new _r(this.presentedScene,this.placeOnWall?"back":"bottom"))},this.onSelectStart=t=>{const i=this.transientHitTestSource;if(i==null)return;const s=this.frame.getHitTestResultsForTransientInput(i),n=this.presentedScene,a=this.placementBox;if(s.length===1){this.inputSource=t.inputSource;const{axes:r}=this.inputSource.gamepad,A=a.getHit(this.presentedScene,r[0],r[1]);a.show=!0,A!=null?(this.isTranslating=!0,this.lastDragPosition.copy(A)):this.placeOnWall===!1&&(this.isRotating=!0,this.lastAngle=r[0]*uA)}else if(s.length===2){a.show=!0,this.isTwoFingering=!0;const{separation:r}=this.fingerPolar(s);this.firstRatio=r/n.pivot.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1},this.threeRenderer=e.threeRenderer,this.threeRenderer.xr.enabled=!0}async resolveARSession(){nr();const e=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:[],optionalFeatures:["hit-test","dom-overlay","light-estimation"],domOverlay:this.overlay?{root:this.overlay}:void 0});return this.threeRenderer.xr.setReferenceSpaceType("local"),await this.threeRenderer.xr.setSession(e),this.threeRenderer.xr.cameraAutoUpdate=!1,e}get presentedScene(){return this._presentedScene}async supportsPresentation(){try{return nr(),await navigator.xr.isSessionSupported("immersive-ar")}catch(e){return console.warn("Request to present in WebXR denied:"),console.warn(e),console.warn("Falling back to next ar-mode"),!1}}async present(e,t=!1){this.isPresenting&&console.warn("Cannot present while a model is already presenting");let i=new Promise((c,h)=>{requestAnimationFrame(()=>c())});e.setHotspotsVisibility(!1),e.queueRender(),await i,this._presentedScene=e,this.overlay=e.element.shadowRoot.querySelector("div.default"),t===!0&&(this.xrLight=new $g(this.threeRenderer),this.xrLight.addEventListener("estimationstart",()=>{if(!this.isPresenting||this.xrLight==null)return;const c=this.presentedScene;c.add(this.xrLight),c.environment=this.xrLight.environment}));const s=await this.resolveARSession();s.addEventListener("end",()=>{this.postSessionCleanup()},{once:!0});const n=e.element.shadowRoot.querySelector(".slot.exit-webxr-ar-button");n.classList.add("enabled"),n.addEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=n;const a=await s.requestReferenceSpace("viewer");this.xrMode=s.interactionMode,this.tracking=!0,this.frames=0,this.initialized=!1,this.turntableRotation=e.yaw,this.goalYaw=e.yaw,this.goalScale=1,e.setBackground(null),this.oldShadowIntensity=e.shadowIntensity,e.setShadowIntensity(.01),this.oldTarget.copy(e.getTarget()),e.element.addEventListener("load",this.onUpdateScene);const r=Dp*Math.PI/180,A=this.placeOnWall===!0?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(r),z:-Math.cos(r)});s.requestHitTestSource({space:a,offsetRay:A}).then(c=>{this.initialHitSource=c}),this.xrMode!=="screen-space"&&(this.setupControllers(),this.xDamper.setDecayTime(zt),this.yDamper.setDecayTime(zt),this.zDamper.setDecayTime(zt),this.yawDamper.setDecayTime(zt),this.pitchDamper.setDecayTime(zt),this.rollDamper.setDecayTime(zt)),this.currentSession=s,this.placementBox=new _r(e,this.placeOnWall?"back":"bottom"),this.placementComplete=!1,this.lastTick=performance.now(),this.dispatchEvent({type:"status",status:lt.SESSION_STARTED})}setupControllers(){this.controller1=this.threeRenderer.xr.getController(0),this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd),this.controller2=this.threeRenderer.xr.getController(1),this.controller2.addEventListener("selectstart",this.onControllerSelectStart),this.controller2.addEventListener("selectend",this.onControllerSelectEnd);const e=this.presentedScene;if(e.add(this.controller1),e.add(this.controller2),!this.controller1.userData.line){const t=new Wa(gA);t.name="line",t.scale.z=dA,this.controller1.userData.turning=!1,this.controller1.userData.line=t,this.controller1.add(t),this.controller2.userData.turning=!1;const i=t.clone();this.controller2.userData.line=i,this.controller2.add(i),this.scaleLine.name="scale line",this.scaleLine.visible=!1,this.controller1.add(this.scaleLine);const{size:s}=e,n=_p/Math.max(s.x,s.y,s.z),a=new Ie(Op);a.name="box",a.scale.copy(s).multiplyScalar(n),a.visible=!1,this.controller1.userData.box=a,e.add(a);const r=a.clone();this.controller2.userData.box=r,e.add(r)}}hover(e){if(this.xrMode==="screen-space"||this.selectedController==e)return!1;const t=this.presentedScene,i=this.placementBox.controllerIntersection(t,e);return e.userData.box.visible=(i==null||e.userData.turning)&&!this.isTwoFingering,e.userData.line.scale.z=i==null?dA:i.distance,i!=null}controllerSeparation(){return this.controller1.position.distanceTo(this.controller2.position)}async stopPresenting(){if(!this.isPresenting)return;const e=new Promise(t=>{this.resolveCleanup=t});try{await this.currentSession.end(),await e}catch(t){console.warn("Error while trying to end WebXR AR session"),console.warn(t),this.postSessionCleanup()}}get isPresenting(){return this.presentedScene!=null}get target(){return this.oldTarget}updateTarget(){const e=this.presentedScene;if(e!=null){const t=e.getTarget();this.oldTarget.copy(t),this.placeOnWall?t.z=e.boundingBox.min.z:t.y=e.boundingBox.min.y,e.setTarget(t.x,t.y,t.z)}}postSessionCleanup(){const e=this.currentSession;e!=null&&(e.removeEventListener("selectstart",this.onSelectStart),e.removeEventListener("selectend",this.onSelectEnd),this.currentSession=null);const t=this.presentedScene;if(this._presentedScene=null,t!=null){const{element:a}=t;this.xrLight!=null&&(t.remove(this.xrLight),this.xrLight.dispose(),this.xrLight=null),t.add(t.pivot),t.pivot.quaternion.set(0,0,0,1),t.pivot.position.set(0,0,0),t.pivot.scale.set(1,1,1),t.setShadowOffset(0);const r=this.turntableRotation;r!=null&&(t.yaw=r);const A=this.oldShadowIntensity;A!=null&&t.setShadowIntensity(A),t.setEnvironmentAndSkybox(a[Os],a[Ps]);const c=this.oldTarget;t.setTarget(c.x,c.y,c.z),t.xrCamera=null,t.element.removeEventListener("load",this.onUpdateScene),t.orientHotspots(0);const{width:h,height:l}=a.getBoundingClientRect();t.setSize(h,l),requestAnimationFrame(()=>{t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:ee.NONE}}))})}this.renderer.height=0;const i=this.exitWebXRButtonContainer;i!=null&&(i.classList.remove("enabled"),i.removeEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=null);const s=this.transientHitTestSource;s!=null&&(s.cancel(),this.transientHitTestSource=null);const n=this.initialHitSource;n!=null&&(n.cancel(),this.initialHitSource=null),this.placementBox!=null&&(this.placementBox.dispose(),this.placementBox=null),this.xrMode!=="screen-space"&&(this.controller1!=null&&(this.controller1.userData.turning=!1,this.controller1.userData.box.visible=!1,this.controller1.userData.line.visible=!0,this.controller1.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1.removeEventListener("selectend",this.onControllerSelectEnd),this.controller1.removeFromParent(),this.controller1=null),this.controller2!=null&&(this.controller2.userData.turning=!1,this.controller2.userData.box.visible=!1,this.controller2.userData.line.visible=!0,this.controller2.removeEventListener("selectstart",this.onControllerSelectStart),this.controller2.removeEventListener("selectend",this.onControllerSelectEnd),this.controller2.removeFromParent(),this.controller2=null),this.selectedController=null,this.scaleLine.visible=!1),this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.inputSource=null,this.overlay=null,this.resolveCleanup!=null&&this.resolveCleanup(),this.dispatchEvent({type:"status",status:lt.NOT_PRESENTING})}updateView(e){const t=this.presentedScene,i=this.threeRenderer.xr;i.updateCamera(Up),t.xrCamera=i.getCamera();const{elements:s}=t.getCamera().matrixWorld;if(t.orientHotspots(Math.atan2(s[1],s[5])),this.initialized||(this.placeInitially(),this.initialized=!0),e.requestViewportScale&&e.recommendedViewportScale){const a=e.recommendedViewportScale;e.requestViewportScale(Math.max(a,Fp))}const n=i.getBaseLayer();if(n!=null){const a=n instanceof XRWebGLLayer?n.getViewport(e):i.getBinding().getViewSubImage(n,e).viewport;this.threeRenderer.setViewport(a.x,a.y,a.width,a.height)}}placeInitially(){const e=this.presentedScene,{pivot:t,element:i}=e,{position:s}=t,n=e.getCamera(),{width:a,height:r}=this.overlay.getBoundingClientRect();e.setSize(a,r),n.projectionMatrixInverse.copy(n.projectionMatrix).invert();const{theta:A}=i.getCameraOrbit(),c=n.getWorldDirection(Ss);e.yaw=Math.atan2(-c.x,-c.z)-A,this.goalYaw=e.yaw;const h=Math.max(1,2*e.boundingSphere.radius);s.copy(n.position).add(c.multiplyScalar(h)),this.updateTarget();const l=e.getTarget();if(s.add(l).sub(this.oldTarget),this.goalPosition.copy(s),e.setHotspotsVisibility(!0),this.xrMode==="screen-space"){const{session:d}=this.frame;d.addEventListener("selectstart",this.onSelectStart),d.addEventListener("selectend",this.onSelectEnd),d.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then(u=>{this.transientHitTestSource=u})}}getTouchLocation(){const{axes:e}=this.inputSource.gamepad;let t=this.placementBox.getExpandedHit(this.presentedScene,e[0],e[1]);return t!=null&&(Ss.copy(t).sub(this.presentedScene.getCamera().position),Ss.length()>kp)?null:t}getHitPoint(e){const t=this.threeRenderer.xr.getReferenceSpace(),i=e.getPose(t);if(i==null)return null;const s=Np.fromArray(i.transform.matrix);return this.placeOnWall===!0&&(this.goalYaw=Math.atan2(s.elements[4],s.elements[6])),s.elements[5]>.75!==this.placeOnWall?Gp.setFromMatrixPosition(s):null}moveToFloor(e){const t=this.initialHitSource;if(t==null)return;const i=e.getHitTestResults(t);if(i.length==0)return;const s=i[0],n=this.getHitPoint(s);n!=null&&(this.placementBox.show=!0,this.isTranslating||(this.placeOnWall?this.goalPosition.copy(n):this.goalPosition.y=n.y),t.cancel(),this.initialHitSource=null,this.dispatchEvent({type:"status",status:lt.OBJECT_PLACED}))}fingerPolar(e){const t=e[0].inputSource.gamepad.axes,i=e[1].inputSource.gamepad.axes,s=i[0]-t[0],n=i[1]-t[1],a=Math.atan2(n,s);let r=this.lastAngle-a;return r>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),this.lastAngle=a,{separation:Math.sqrt(s*s+n*n),deltaYaw:r}}setScale(e){const t=e/this.firstRatio;this.goalScale=Math.abs(t-1)<Lp?1:t}processInput(e){const t=this.transientHitTestSource;if(t==null||!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const i=e.getHitTestResultsForTransientInput(t),s=this.presentedScene,n=s.pivot.scale.x;if(this.isTwoFingering){if(i.length<2)this.isTwoFingering=!1;else{const{separation:a,deltaYaw:r}=this.fingerPolar(i);this.placeOnWall===!1&&(this.goalYaw+=r),s.canScale&&this.setScale(a)}return}else if(i.length===2){this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:a}=this.fingerPolar(i);this.firstRatio=a/n;return}if(this.isRotating){const a=this.inputSource.gamepad.axes[0]*uA;this.goalYaw+=a-this.lastAngle,this.lastAngle=a}else this.isTranslating&&i.forEach(a=>{if(a.inputSource!==this.inputSource)return;let r=null;if(a.results.length>0&&(r=this.getHitPoint(a.results[0])),r==null&&(r=this.getTouchLocation()),r!=null){if(this.goalPosition.sub(this.lastDragPosition),this.placeOnWall===!1){const A=r.y-this.lastDragPosition.y;if(A<0){this.placementBox.offsetHeight=A/n,this.presentedScene.setShadowOffset(A);const c=Ss.copy(s.getCamera().position),h=-A/(c.y-r.y);c.multiplyScalar(h),r.multiplyScalar(1-h).add(c)}}this.goalPosition.add(r),this.lastDragPosition.copy(r)}})}moveScene(e){const t=this.presentedScene,{pivot:i}=t,s=this.placementBox;if(s.updateOpacity(e),this.controller1&&(this.controller1.userData.turning&&(i.quaternion.copy(this.controller1.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller2&&i.quaternion.premultiply(Kt.copy(this.controller2.quaternion).invert())),this.controller1.userData.box.position.copy(this.controller1.position),i.getWorldQuaternion(this.controller1.userData.box.quaternion)),this.controller2&&(this.controller2.userData.turning&&(i.quaternion.copy(this.controller2.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller1&&i.quaternion.premultiply(Kt.copy(this.controller1.quaternion).invert())),this.controller2.userData.box.position.copy(this.controller2.position),i.getWorldQuaternion(this.controller2.userData.box.quaternion)),this.controller1&&this.controller2&&this.isTwoFingering){const d=this.controllerSeparation();this.setScale(d),this.scaleLine.scale.z=-d,this.scaleLine.lookAt(this.controller2.position)}const n=t.pivot.scale.x;if(this.goalScale!==n){const d=this.scaleDamper.update(n,this.goalScale,e,1);t.pivot.scale.set(d,d,d)}if(i.parent!==t)return;const{position:a}=i,r=t.boundingSphere.radius,A=this.goalPosition;let c=ee.NONE;if(!A.equals(a)){c=ee.USER_INTERACTION;let{x:d,y:u,z:g}=a;if(d=this.xDamper.update(d,A.x,e,r),u=this.yDamper.update(u,A.y,e,r),g=this.zDamper.update(g,A.z,e,r),a.set(d,u,g),this.xrMode==="screen-space"&&!this.isTranslating){const p=A.y-u;this.placementComplete&&this.placeOnWall===!1?(s.offsetHeight=p/t.pivot.scale.x,t.setShadowOffset(p)):p===0&&(this.placementComplete=!0,s.show=!1,t.setShadowIntensity(hA))}this.xrMode!=="screen-space"&&A.equals(a)&&t.setShadowIntensity(hA)}t.updateTarget(e),Kt.setFromAxisAngle(Ss.set(0,1,0),this.goalYaw);const h=t.pivot.quaternion.angleTo(Kt),l=h-this.yawDamper.update(h,0,e,Math.PI);t.pivot.quaternion.rotateTowards(Kt,l),t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:c}}))}onWebXRFrame(e,t){if(this.xrMode!=="screen-space"){const r=this.hover(this.controller1),A=this.hover(this.controller2);this.placementBox.show=(r||A)&&!this.isTwoFingering}this.frame=t,++this.frames;const i=this.threeRenderer.xr.getReferenceSpace(),s=t.getViewerPose(i);s==null&&this.tracking===!0&&this.frames>Mp&&(this.tracking=!1,this.dispatchEvent({type:"tracking",status:ro.NOT_TRACKING}));const n=this.presentedScene;if(s==null||n==null||!n.element.loaded){this.threeRenderer.clear();return}this.tracking===!1&&(this.tracking=!0,this.dispatchEvent({type:"tracking",status:ro.TRACKING}));let a=!0;for(const r of s.views){if(this.updateView(r),a){this.moveToFloor(t),this.processInput(t);const A=e-this.lastTick;this.moveScene(A),this.renderer.preRender(n,e,A),this.lastTick=e,n.renderShadow(this.threeRenderer)}this.threeRenderer.render(n,n.getCamera()),a=!1}}}function Hp(o){const e=new Map,t=new Map,i=o.clone();return Jl(o,i,function(s,n){e.set(n,s),t.set(s,n)}),i.traverse(function(s){if(!s.isSkinnedMesh)return;const n=s,a=e.get(s),r=a.skeleton.bones;n.skeleton=a.skeleton.clone(),n.bindMatrix.copy(a.bindMatrix),n.skeleton.bones=r.map(function(A){return t.get(A)}),n.bind(n.skeleton,n.bindMatrix)}),i}function Jl(o,e,t){t(o,e);for(let i=0;i<o.children.length;i++)Jl(o.children[i],e.children[i],t)}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=Symbol("prepared"),sn=Symbol("prepare"),_e=Symbol("preparedGLTF"),nn=Symbol("clone");class qp{static prepare(e){if(e.scene==null)throw new Error("Model does not have a scene");if(e[pA])return e;const t=this[sn](e);return t[pA]=!0,t}static[sn](e){const{scene:t}=e,i=[t];return Object.assign(Object.assign({},e),{scene:t,scenes:i})}get parser(){return this[_e].parser}get animations(){return this[_e].animations}get scene(){return this[_e].scene}get scenes(){return this[_e].scenes}get cameras(){return this[_e].cameras}get asset(){return this[_e].asset}get userData(){return this[_e].userData}constructor(e){this[_e]=e}clone(){const e=this.constructor,t=this[nn]();return new e(t)}dispose(){this.scenes.forEach(e=>{e.traverse(t=>{const i=t;if(!i.material)return;(Array.isArray(i.material)?i.material:[i.material]).forEach(n=>{for(const a in n){const r=n[a];if(r instanceof Ji){const A=r.source.data;A.close!=null&&A.close(),r.dispose()}}n.dispose()}),i.geometry.dispose()})})}[nn](){const e=this[_e],t=Hp(this.scene);jp(t,this.scene);const i=[t],s=e.userData?Object.assign({},e.userData):{};return Object.assign(Object.assign({},e),{scene:t,scenes:i,userData:s})}}const jp=(o,e)=>{Yl(o,e,(t,i)=>{i.userData.variantMaterials!==void 0&&(t.userData.variantMaterials=new Map(i.userData.variantMaterials)),i.userData.variantData!==void 0&&(t.userData.variantData=i.userData.variantData),i.userData.originalMaterial!==void 0&&(t.userData.originalMaterial=i.userData.originalMaterial)})},Yl=(o,e,t)=>{t(o,e);for(let i=0;i<o.children.length;i++)Yl(o.children[i],e.children[i],t)},fA=Symbol("threeGLTF"),mA=Symbol("gltf"),bA=Symbol("gltfElementMap"),IA=Symbol("threeObjectMap"),EA=Symbol("parallelTraverseThreeScene"),CA=Symbol("correlateOriginalThreeGLTF"),BA=Symbol("correlateCloneThreeGLTF");class ii{static from(e,t){return t!=null?this[BA](e,t):this[CA](e)}static[CA](e){const t=e.parser.json,i=e.parser.associations,s=new Map,n={name:"Default"},a={type:"materials",index:-1};for(const r of i.keys())r instanceof Li&&i.get(r)==null&&(a.index<0&&(t.materials==null&&(t.materials=[]),a.index=t.materials.length,t.materials.push(n)),r.name=n.name,i.set(r,{materials:a.index}));for(const[r,A]of i){A&&(r.userData=r.userData||{},r.userData.associations=A);for(const c in A)if(c!=null&&c!=="primitives"){const h=c,d=(t[h]||[])[A[h]];if(d==null)continue;let u=s.get(d);u==null&&(u=new Set,s.set(d,u)),u.add(r)}}return new ii(e,t,i,s)}static[BA](e,t){const i=t.threeGLTF,s=t.gltf,n=JSON.parse(JSON.stringify(s)),a=new Map,r=new Map;for(let A=0;A<i.scenes.length;A++)this[EA](i.scenes[A],e.scenes[A],(c,h)=>{const l=t.threeObjectMap.get(c);if(l!=null){for(const d in l)if(d!=null&&d!=="primitives"){const u=d,g=l[u],p=n[u][g],f=a.get(h)||{};f[u]=g,a.set(h,f);const m=r.get(p)||new Set;m.add(h),r.set(p,m)}}});return new ii(e,n,a,r)}static[EA](e,t,i){const s=(n,a)=>{if(i(n,a),n.isObject3D){const r=n,A=a;if(r.material)if(Array.isArray(r.material))for(let c=0;c<r.material.length;++c)i(r.material[c],A.material[c]);else i(r.material,A.material);for(let c=0;c<n.children.length;++c)s(n.children[c],a.children[c])}};s(e,t)}get threeGLTF(){return this[fA]}get gltf(){return this[mA]}get gltfElementMap(){return this[bA]}get threeObjectMap(){return this[IA]}constructor(e,t,i,s){this[fA]=e,this[mA]=t,this[bA]=s,this[IA]=i}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=Symbol("correlatedSceneGraph");class $p extends qp{static[sn](e){const t=super[sn](e);t[vs]==null&&(t[vs]=ii.from(t));const{scene:i}=t,s=new wo(void 0,1/0);return i.traverse(n=>{n.renderOrder=1e3,n.frustumCulled=!1,n.name||(n.name=n.uuid);const a=n;if(a.material){const{geometry:r}=a;a.castShadow=!0,a.isSkinnedMesh&&(r.boundingSphere=s,r.boundingBox=null);const A=a.material;if(A.isMeshBasicMaterial===!0&&(A.toneMapped=!1),A.shadowSide=yo,A.aoMap){const{gltf:c,threeObjectMap:h}=t[vs],l=h.get(A);if(c.materials!=null&&l!=null&&l.materials!=null){const d=c.materials[l.materials];d.occlusionTexture&&d.occlusionTexture.texCoord===0&&r.attributes.uv!=null&&r.setAttribute("uv2",r.attributes.uv)}}}}),t}get correlatedSceneGraph(){return this[_e][vs]}[nn](){const e=super[nn](),t=new Map;return e.scene.traverse(i=>{const s=i;if(s.material){const a=s.material;if(a!=null){if(t.has(a.uuid)){s.material=t.get(a.uuid);return}s.material=a.clone(),t.set(a.uuid,s.material)}}const n=i;n.target!==void 0&&n.add(n.target)}),e[vs]=ii.from(e,this.correlatedSceneGraph),e}}class Vp extends nu{constructor(e){super(e),this.type=Re}parse(e){const a=function(B,Q){switch(B){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(Q||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(Q||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(Q||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(Q||""))}},h=`
`,l=function(B,Q,S){Q=Q||1024;let D=B.pos,k=-1,v=0,M="",L=String.fromCharCode.apply(null,new Uint16Array(B.subarray(D,D+128)));for(;0>(k=L.indexOf(h))&&v<Q&&D<B.byteLength;)M+=L,v+=L.length,D+=128,L+=String.fromCharCode.apply(null,new Uint16Array(B.subarray(D,D+128)));return-1<k?(B.pos+=v+k+1,M+L.slice(0,k)):!1},d=function(B){const Q=/^#\?(\S+)/,S=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,R=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,D=/^\s*FORMAT=(\S+)\s*$/,k=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,v={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let M,L;for((B.pos>=B.byteLength||!(M=l(B)))&&a(1,"no header found"),(L=M.match(Q))||a(3,"bad initial token"),v.valid|=1,v.programtype=L[1],v.string+=M+`
`;M=l(B),M!==!1;){if(v.string+=M+`
`,M.charAt(0)==="#"){v.comments+=M+`
`;continue}if((L=M.match(S))&&(v.gamma=parseFloat(L[1])),(L=M.match(R))&&(v.exposure=parseFloat(L[1])),(L=M.match(D))&&(v.valid|=2,v.format=L[1]),(L=M.match(k))&&(v.valid|=4,v.height=parseInt(L[1],10),v.width=parseInt(L[2],10)),v.valid&2&&v.valid&4)break}return v.valid&2||a(3,"missing format specifier"),v.valid&4||a(3,"missing image size specifier"),v},u=function(B,Q,S){const R=Q;if(R<8||R>32767||B[0]!==2||B[1]!==2||B[2]&128)return new Uint8Array(B);R!==(B[2]<<8|B[3])&&a(3,"wrong scanline width");const D=new Uint8Array(4*Q*S);D.length||a(4,"unable to allocate buffer space");let k=0,v=0;const M=4*R,L=new Uint8Array(4),F=new Uint8Array(M);let q=S;for(;q>0&&v<B.byteLength;){v+4>B.byteLength&&a(1),L[0]=B[v++],L[1]=B[v++],L[2]=B[v++],L[3]=B[v++],(L[0]!=2||L[1]!=2||(L[2]<<8|L[3])!=R)&&a(3,"bad rgbe scanline format");let H=0,J;for(;H<M&&v<B.byteLength;){J=B[v++];const V=J>128;if(V&&(J-=128),(J===0||H+J>M)&&a(3,"bad scanline data"),V){const Y=B[v++];for(let ue=0;ue<J;ue++)F[H++]=Y}else F.set(B.subarray(v,v+J),H),H+=J,v+=J}const $=R;for(let V=0;V<$;V++){let Y=0;D[k]=F[V+Y],Y+=R,D[k+1]=F[V+Y],Y+=R,D[k+2]=F[V+Y],Y+=R,D[k+3]=F[V+Y],k+=4}q--}return D},g=function(B,Q,S,R){const D=B[Q+3],k=Math.pow(2,D-128)/255;S[R+0]=B[Q+0]*k,S[R+1]=B[Q+1]*k,S[R+2]=B[Q+2]*k,S[R+3]=1},p=function(B,Q,S,R){const D=B[Q+3],k=Math.pow(2,D-128)/255;S[R+0]=oi.toHalfFloat(Math.min(B[Q+0]*k,65504)),S[R+1]=oi.toHalfFloat(Math.min(B[Q+1]*k,65504)),S[R+2]=oi.toHalfFloat(Math.min(B[Q+2]*k,65504)),S[R+3]=oi.toHalfFloat(1)},f=new Uint8Array(e);f.pos=0;const m=d(f),I=m.width,C=m.height,E=u(f.subarray(f.pos),I,C);let b,y,w;switch(this.type){case dt:w=E.length/4;const B=new Float32Array(w*4);for(let S=0;S<w;S++)g(E,S*4,B,S*4);b=B,y=dt;break;case Re:w=E.length/4;const Q=new Uint16Array(w*4);for(let S=0;S<w;S++)p(E,S*4,Q,S*4);b=Q,y=Re;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:I,height:C,data:b,header:m.string,gamma:m.gamma,exposure:m.exposure,type:y}}setDataType(e){return this.type=e,this}load(e,t,i,s){function n(a,r){switch(a.type){case dt:case Re:a.colorSpace=re,a.minFilter=Ee,a.magFilter=Ee,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,r)}return super.load(e,n,i,s)}}/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp={topLight:{intensity:500,position:[.418,16.199,.3]},room:{position:[-.757,13.219,.717],scale:[31.713,28.305,28.591]},boxes:[{position:[-10.906,2.009,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,.857,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:50,position:[-16.116,14.37,8.208],scale:[.1,2.428,2.739]},{intensity:50,position:[-16.109,18.021,-8.207],scale:[.1,2.425,2.751]},{intensity:17,position:[14.904,12.198,-1.832],scale:[.15,4.265,6.331]},{intensity:43,position:[-.462,8.89,14.52],scale:[4.38,5.441,.088]},{intensity:20,position:[3.235,11.486,-12.541],scale:[2.5,2,.1]},{intensity:100,position:[0,20,0],scale:[1,.1,1]}]},Kp={topLight:{intensity:400,position:[.5,14,.5]},room:{position:[0,13.2,0],scale:[31.5,28.5,31.5]},boxes:[{position:[-10.906,-1,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,-.16,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:80,position:[-14,10,8],scale:[.1,2.5,2.5]},{intensity:80,position:[-14,14,-4],scale:[.1,2.5,2.5]},{intensity:23,position:[14,12,0],scale:[.1,5,5]},{intensity:16,position:[0,9,14],scale:[5,5,.1]},{intensity:80,position:[7,8,-14],scale:[2.5,2.5,.1]},{intensity:80,position:[-7,16,-14],scale:[2.5,2.5,.1]},{intensity:1,position:[0,20,0],scale:[.1,.1,.1]}]};class yA extends ds{constructor(e){super(),this.position.y=-3.5;const t=new mn;t.deleteAttribute("uv");const i=new Vi({metalness:0,side:So}),s=new Vi({metalness:0}),n=e=="legacy"?zp:Kp,a=new Vc(16777215,n.topLight.intensity,28,2);a.position.set(...n.topLight.position),this.add(a);const r=new Ie(t,i);r.position.set(...n.room.position),r.scale.set(...n.room.scale),this.add(r);for(const A of n.boxes){const c=new Ie(t,s);c.position.set(...A.position),c.rotation.set(0,A.rotation,0),c.scale.set(...A.scale),this.add(c)}for(const A of n.lights){const c=new Ie(t,this.createAreaLightMaterial(A.intensity));c.position.set(...A.position),c.scale.set(...A.scale),this.add(c)}}createAreaLightMaterial(e){const t=new et;return t.color.setScalar(e),t}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp=.04,Jt=20,Yp=/\.hdr(\.js)?$/;class wA{constructor(e){this.threeRenderer=e,this.lottieLoaderUrl="",this._ldrLoader=null,this._imageLoader=null,this._hdrLoader=null,this._lottieLoader=null,this.generatedEnvironmentMap=null,this.generatedEnvironmentMapAlt=null,this.skyboxCache=new Map,this.blurMaterial=null,this.blurScene=null}ldrLoader(e){return this._ldrLoader==null&&(this._ldrLoader=new Kc),this._ldrLoader.setWithCredentials(e),this._ldrLoader}imageLoader(e){return this._imageLoader==null&&(this._imageLoader=new au(this.threeRenderer)),this._imageLoader.setWithCredentials(e),this._imageLoader}hdrLoader(e){return this._hdrLoader==null&&(this._hdrLoader=new Vp,this._hdrLoader.setDataType(Re)),this._hdrLoader.setWithCredentials(e),this._hdrLoader}async getLottieLoader(e){if(this._lottieLoader==null){const{LottieLoader:t}=await import(this.lottieLoaderUrl);this._lottieLoader=new t}return this._lottieLoader.setWithCredentials(e),this._lottieLoader}async loadImage(e,t){const i=await new Promise((s,n)=>this.ldrLoader(t).load(e,s,()=>{},n));return i.name=e,i.flipY=!1,i}async loadLottie(e,t,i){const s=await this.getLottieLoader(i);s.setQuality(t);const n=await new Promise((a,r)=>s.load(e,a,()=>{},r));return n.name=e,n}async loadEquirect(e,t=!1,i=()=>{}){try{const s=Yp.test(e),n=s?this.hdrLoader(t):this.imageLoader(t),a=await new Promise((r,A)=>n.load(e,c=>{const{renderTarget:h}=c;if(h!=null){const{texture:l}=h;c.dispose(!1),r(l)}else r(c)},c=>{i(c.loaded/c.total*.9)},A));return i(1),a.name=e,a.mapping=ou,s||(a.colorSpace=xe),a}finally{i&&i(1)}}async generateEnvironmentMapAndSkybox(e=null,t=null,i=()=>{},s=!1){const n=t!=="legacy";(t==="legacy"||t==="neutral")&&(t=null),t=hl(t);let a=Promise.resolve(null),r;e&&(a=this.loadEquirectFromUrl(e,s,i)),t?r=this.loadEquirectFromUrl(t,s,i):e?r=this.loadEquirectFromUrl(e,s,i):r=n?this.loadGeneratedEnvironmentMapAlt():this.loadGeneratedEnvironmentMap();const[A,c]=await Promise.all([r,a]);if(A==null)throw new Error("Failed to load environment map.");return{environmentMap:A,skybox:c}}async loadEquirectFromUrl(e,t,i){if(!this.skyboxCache.has(e)){const s=this.loadEquirect(e,t,i);this.skyboxCache.set(e,s)}return this.skyboxCache.get(e)}async GenerateEnvironmentMap(e,t){await ju();const i=this.threeRenderer,s=new Xc(256,{generateMipmaps:!1,type:Re,format:tt,colorSpace:re,depthBuffer:!0}),n=new Vo(.1,100,s),a=n.renderTarget.texture;a.name=t;const r=i.outputColorSpace,A=i.toneMapping;return i.toneMapping=jc,i.outputColorSpace=re,n.update(i,e),this.blurCubemap(s,Jp),i.toneMapping=A,i.outputColorSpace=r,a}async loadGeneratedEnvironmentMap(){return this.generatedEnvironmentMap==null&&(this.generatedEnvironmentMap=this.GenerateEnvironmentMap(new yA("legacy"),"legacy")),this.generatedEnvironmentMap}async loadGeneratedEnvironmentMapAlt(){return this.generatedEnvironmentMapAlt==null&&(this.generatedEnvironmentMapAlt=this.GenerateEnvironmentMap(new yA("neutral"),"neutral")),this.generatedEnvironmentMapAlt}blurCubemap(e,t){if(this.blurMaterial==null){this.blurMaterial=this.getBlurShader(Jt);const s=new mn,n=new Ie(s,this.blurMaterial);this.blurScene=new ds,this.blurScene.add(n)}const i=e.clone();this.halfblur(e,i,t,"latitudinal"),this.halfblur(i,e,t,"longitudinal")}halfblur(e,t,i,s){const a=e.width,r=isFinite(i)?Math.PI/(2*a):2*Math.PI/(2*Jt-1),A=i/r,c=isFinite(i)?1+Math.floor(3*A):Jt;c>Jt&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${c} samples when the maximum is set to ${Jt}`);const h=[];let l=0;for(let g=0;g<Jt;++g){const p=g/A,f=Math.exp(-p*p/2);h.push(f),g==0?l+=f:g<c&&(l+=2*f)}for(let g=0;g<h.length;g++)h[g]=h[g]/l;const d=this.blurMaterial.uniforms;d.envMap.value=e.texture,d.samples.value=c,d.weights.value=h,d.latitudinal.value=s==="latitudinal",d.dTheta.value=r,new Vo(.1,100,t).update(this.threeRenderer,this.blurScene)}getBlurShader(e){const t=new Float32Array(e),i=new G(0,1,0);return new to({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},poleAxis:{value:i}},vertexShader:`
      
      varying vec3 vOutputDirection;
  
      void main() {
  
        vOutputDirection = vec3( position );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  
      }
    `,fragmentShader:`
        varying vec3 vOutputDirection;
  
        uniform samplerCube envMap;
        uniform int samples;
        uniform float weights[ n ];
        uniform bool latitudinal;
        uniform float dTheta;
        uniform vec3 poleAxis;
  
        vec3 getSample( float theta, vec3 axis ) {
  
          float cosTheta = cos( theta );
          // Rodrigues' axis-angle rotation
          vec3 sampleDirection = vOutputDirection * cosTheta
            + cross( axis, vOutputDirection ) * sin( theta )
            + axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );
  
          return vec3( textureCube( envMap, sampleDirection ) );
  
        }
  
        void main() {
  
          vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );
  
          if ( all( equal( axis, vec3( 0.0 ) ) ) ) {
  
            axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );
  
          }
  
          axis = normalize( axis );
  
          gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
          gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );
  
          for ( int i = 1; i < n; i++ ) {
  
            if ( i >= samples ) {
  
              break;
  
            }
  
            float theta = dTheta * float( i );
            gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
            gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );
  
          }
        }
      `,blending:ru,depthTest:!1,depthWrite:!1,side:So})}async dispose(){for(const[,e]of this.skyboxCache)(await e).dispose();this.generatedEnvironmentMap!=null&&((await this.generatedEnvironmentMap).dispose(),this.generatedEnvironmentMap=null),this.generatedEnvironmentMapAlt!=null&&((await this.generatedEnvironmentMapAlt).dispose(),this.generatedEnvironmentMapAlt=null),this.blurMaterial!=null&&this.blurMaterial.dispose()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp=.2,ra=40,Aa=60,QA=5,Yt=[1,.79,.62,.5,.4,.31,.25],Xp=3,xA="high-performance",Zp=1.3;class ke extends fn{static get singleton(){return this._singleton||(this._singleton=new ke({powerPreference:(self.ModelViewerElement||{}).powerPreference||xA,debug:or()})),this._singleton}static resetSingleton(){const e=this._singleton.dispose();for(const t of e)t.disconnectedCallback();this._singleton=new ke({powerPreference:(self.ModelViewerElement||{}).powerPreference||xA,debug:or()});for(const t of e)t.connectedCallback()}get canRender(){return this.threeRenderer!=null}get scaleFactor(){return Yt[this.scaleStep]}set minScale(e){let t=1;for(;t<Yt.length&&!(Yt[t]<e);)++t;this.lastStep=t-1}constructor(e){super(),this.loader=new pe($p),this.width=0,this.height=0,this.dpr=1,this.scenes=new Set,this.multipleScenesVisible=!1,this.lastTick=performance.now(),this.renderedLastFrame=!1,this.scaleStep=0,this.lastStep=Xp,this.avgFrameDuration=(Aa+ra)/2,this.onWebGLContextLost=t=>{this.dispatchEvent({type:"contextlost",sourceEvent:t})},this.onWebGLContextRestored=()=>{var t;(t=this.textureUtils)===null||t===void 0||t.dispose(),this.textureUtils=new wA(this.threeRenderer);for(const i of this.scenes)i.element[en]()},this.dpr=window.devicePixelRatio,this.canvas3D=document.createElement("canvas"),this.canvas3D.id="webgl-canvas",this.canvas3D.classList.add("show");try{this.threeRenderer=new Au({canvas:this.canvas3D,alpha:!0,antialias:!0,powerPreference:e.powerPreference,preserveDrawingBuffer:!0}),this.threeRenderer.autoClear=!0,this.threeRenderer.setPixelRatio(1),this.threeRenderer.debug={checkShaderErrors:!!e.debug,onShaderError:null},this.threeRenderer.toneMapping=$i}catch(t){console.warn(t)}this.arRenderer=new Pp(this),this.textureUtils=this.canRender?new wA(this.threeRenderer):null,pe.initializeKTX2Loader(this.threeRenderer),this.canvas3D.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.updateRendererSize()}registerScene(e){this.scenes.add(e),e.forceRescale();const t=new Me;this.threeRenderer.getSize(t),e.canvas.width=t.x,e.canvas.height=t.y,this.canRender&&this.scenes.size>0&&this.threeRenderer.setAnimationLoop((i,s)=>this.render(i,s))}unregisterScene(e){this.scenes.delete(e),this.canvas3D.parentElement===e.canvas.parentElement&&e.canvas.parentElement.removeChild(this.canvas3D),this.canRender&&this.scenes.size===0&&this.threeRenderer.setAnimationLoop(null)}displayCanvas(e){return e.element.modelIsVisible&&!this.multipleScenesVisible?this.canvas3D:e.element[go]}countVisibleScenes(){const{canvas3D:e}=this;let t=0,i=null;for(const n of this.scenes){const{element:a}=n;a.modelIsVisible&&n.externalRenderer==null&&++t,e.parentElement===n.canvas.parentElement&&(i=n)}const s=t>1;if(i!=null){const n=s&&!this.multipleScenesVisible,a=!i.element.modelIsVisible;if(n||a){const{width:r,height:A}=this.sceneSize(i);this.copyPixels(i,r,A),e.parentElement.removeChild(e)}}this.multipleScenesVisible=s}updateRendererSize(){var e;const t=window.devicePixelRatio;if(t!==this.dpr)for(const n of this.scenes){const{element:a}=n;a[as](a.getBoundingClientRect())}let i=0,s=0;for(const n of this.scenes)i=Math.max(i,n.width),s=Math.max(s,n.height);if(!(i===this.width&&s===this.height&&t===this.dpr)){this.width=i,this.height=s,this.dpr=t,i=Math.ceil(i*t),s=Math.ceil(s*t),this.canRender&&this.threeRenderer.setSize(i,s,!1);for(const n of this.scenes){const{canvas:a}=n;a.width=i,a.height=s,n.forceRescale(),(e=n.effectRenderer)===null||e===void 0||e.setSize(i,s)}}}updateRendererScale(e){const t=this.scaleStep;this.avgFrameDuration+=Ue(Wp*(e-this.avgFrameDuration),-QA,QA),this.avgFrameDuration>Aa?++this.scaleStep:this.avgFrameDuration<ra&&this.scaleStep>0&&--this.scaleStep,this.scaleStep=Math.min(this.scaleStep,this.lastStep),t!==this.scaleStep&&(this.avgFrameDuration=(Aa+ra)/2)}shouldRender(e){if(e.shouldRender())e.scaleStep!=this.scaleStep&&(e.scaleStep=this.scaleStep,this.rescaleCanvas(e));else if(e.scaleStep!=0)e.scaleStep=0,this.rescaleCanvas(e);else return!1;return!0}rescaleCanvas(e){const t=Yt[e.scaleStep],i=Math.ceil(this.width/t),s=Math.ceil(this.height/t),{style:n}=e.canvas;n.width=`${i}px`,n.height=`${s}px`,this.canvas3D.style.width=`${i}px`,this.canvas3D.style.height=`${s}px`;const a=this.dpr*t,r=t<1?"GPU throttling":this.dpr!==window.devicePixelRatio?"No meta viewport tag":"";e.element.dispatchEvent(new CustomEvent("render-scale",{detail:{reportedDpr:window.devicePixelRatio,renderedDpr:a,minimumDpr:this.dpr*Yt[this.lastStep],pixelWidth:Math.ceil(e.width*a),pixelHeight:Math.ceil(e.height*a),reason:r}}))}sceneSize(e){const{dpr:t}=this,i=Yt[e.scaleStep],s=Math.min(Math.ceil(e.width*i*t),this.canvas3D.width),n=Math.min(Math.ceil(e.height*i*t),this.canvas3D.height);return{width:s,height:n}}copyPixels(e,t,i){const s=e.context;if(s==null){console.log("could not acquire 2d context");return}s.clearRect(0,0,t,i),s.drawImage(this.canvas3D,0,0,t,i,0,0,t,i),e.canvas.classList.add("show")}orderedScenes(){const e=[];for(const t of[!1,!0])for(const i of this.scenes)i.element.modelIsVisible===t&&e.push(i);return e}get isPresenting(){return this.arRenderer.isPresenting}preRender(e,t,i){const{element:s,exposure:n,toneMapping:a}=e;s[He](t,i);const r=typeof n=="number"&&!Number.isNaN(n),A=s.environmentImage,c=s.skyboxImage,h=a===$i&&(A==="neutral"||A==="legacy"||!A&&!c);this.threeRenderer.toneMappingExposure=(r?n:1)*(h?Zp:1)}render(e,t){if(t!=null){this.arRenderer.onWebXRFrame(e,t);return}const i=e-this.lastTick;if(this.lastTick=e,!this.canRender||this.isPresenting)return;this.countVisibleScenes(),this.updateRendererSize(),this.renderedLastFrame&&(this.updateRendererScale(i),this.renderedLastFrame=!1);const{canvas3D:s}=this;for(const n of this.orderedScenes()){const{element:a}=n;if(!a.loaded||!a.modelIsVisible&&n.renderCount>0||(this.preRender(n,e,i),!this.shouldRender(n)))continue;if(n.externalRenderer!=null){const c=n.getCamera();c.updateMatrix();const{matrix:h,projectionMatrix:l}=c,d=h.elements.slice(),u=n.getTarget();d[12]+=u.x,d[13]+=u.y,d[14]+=u.z,n.externalRenderer.render({viewMatrix:d,projectionMatrix:l.elements});continue}if(!a.modelIsVisible&&!this.multipleScenesVisible)for(const c of this.scenes)c.element.modelIsVisible&&c.queueRender();const{width:r,height:A}=this.sceneSize(n);n.renderShadow(this.threeRenderer),this.threeRenderer.setRenderTarget(null),this.threeRenderer.setViewport(0,Math.ceil(this.height*this.dpr)-A,r,A),n.effectRenderer!=null?n.effectRenderer.render(i):(this.threeRenderer.autoClear=!0,this.threeRenderer.toneMapping=n.toneMapping,this.threeRenderer.render(n,n.camera)),this.multipleScenesVisible||!n.element.modelIsVisible&&n.renderCount===0?this.copyPixels(n,r,A):s.parentElement!==n.canvas.parentElement&&(n.canvas.parentElement.appendChild(s),n.canvas.classList.remove("show")),n.hasRendered(),++n.renderCount,this.renderedLastFrame=!0}}dispose(){this.textureUtils!=null&&this.textureUtils.dispose(),this.threeRenderer!=null&&this.threeRenderer.dispose(),this.textureUtils=null,this.threeRenderer=null;const e=[];for(const t of this.scenes)e.push(t.element);return this.canvas3D.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.removeEventListener("webglcontextrestored",this.onWebGLContextRestored),e}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U=Symbol("correlatedObjects"),j=Symbol("onUpdate");class ni{constructor(e,t){this[j]=e,this[U]=t}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new et,ef=new Qo(2,2);let tf=0;const ge=Symbol("threeTexture"),vA=Symbol("threeTextures");class sf extends ni{get[ge](){var e;return(e=this[U])===null||e===void 0?void 0:e.values().next().value}get[vA](){return this[U]}constructor(e,t){super(e,new Set(t?[t]:[])),this[ge].image.src||(this[ge].image.src=t.name?t.name:"adhoc_image"+tf++),this[ge].image.name||(this[ge].image.name=t&&t.image&&t.image.src?t.image.src.split("/").pop():"adhoc_image")}get name(){return this[ge].image.name||""}get uri(){return this[ge].image.src}get bufferView(){return this[ge].image.bufferView}get element(){const e=this[ge];if(e&&(e.isCanvasTexture||e.isVideoTexture))return e.image}get animation(){const e=this[ge];if(e&&e.isCanvasTexture&&e.animation)return e.animation}get type(){return this.uri!=null?"external":"embedded"}set name(e){for(const t of this[vA])t.image.name=e}update(){const e=this[ge];e&&e.isCanvasTexture&&!e.animation&&(this[ge].needsUpdate=!0,this[j]())}async createThumbnail(e,t){const i=new ds;SA.map=this[ge];const s=new Ie(ef,SA);i.add(s);const n=new Co(-1,1,1,-1,0,1),{threeRenderer:a}=ke.singleton,r=new so(e,t);a.setRenderTarget(r),a.render(i,n),a.setRenderTarget(null);const A=new Uint8Array(e*t*4);a.readRenderTargetPixels(r,0,0,e,t,A),ut.width=e,ut.height=t;const c=ut.getContext("2d"),h=c.createImageData(e,t);return h.data.set(A),c.putImageData(h,0,0),new Promise(async(l,d)=>{ut.toBlob(u=>{if(!u)return d("Failed to capture thumbnail.");l(URL.createObjectURL(u))},"image/png")})}}var ie;(function(o){o[o.Nearest=9728]="Nearest",o[o.Linear=9729]="Linear",o[o.NearestMipmapNearest=9984]="NearestMipmapNearest",o[o.LinearMipmapNearest=9985]="LinearMipmapNearest",o[o.NearestMipmapLinear=9986]="NearestMipmapLinear",o[o.LinearMipmapLinear=9987]="LinearMipmapLinear"})(ie||(ie={}));var pt;(function(o){o[o.ClampToEdge=33071]="ClampToEdge",o[o.MirroredRepeat=33648]="MirroredRepeat",o[o.Repeat=10497]="Repeat"})(pt||(pt={}));/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=new Map([[pt.Repeat,ft],[pt.ClampToEdge,gn],[pt.MirroredRepeat,pn]]),Ao=new Map([[ft,pt.Repeat],[gn,pt.ClampToEdge],[pn,pt.MirroredRepeat]]),nf=new Map([[ie.Nearest,Ot],[ie.Linear,Ee],[ie.NearestMipmapNearest,hn],[ie.LinearMipmapNearest,un],[ie.NearestMipmapLinear,dn],[ie.LinearMipmapLinear,Ut]]),Wl=new Map([[Ot,ie.Nearest],[Ee,ie.Linear],[hn,ie.NearestMipmapNearest],[un,ie.LinearMipmapNearest],[dn,ie.NearestMipmapLinear],[Ut,ie.LinearMipmapLinear]]),af=new Map([[ie.Nearest,Ot],[ie.Linear,Ee]]),Xl=new Map([[Ot,ie.Nearest],[Ee,ie.Linear]]),of=o=>Wl.has(o),rf=o=>Xl.has(o),Af=o=>Ao.has(o),cf=(o,e)=>{switch(o){case"minFilter":return of(e);case"magFilter":return rf(e);case"wrapS":case"wrapT":return Af(e);case"rotation":case"repeat":case"offset":return!0;default:throw new Error(`Cannot configure property "${o}" on Sampler`)}},Ke=Symbol("threeTexture"),RA=Symbol("threeTextures"),at=Symbol("setProperty");class lf extends ni{get[Ke](){var e;return(e=this[U])===null||e===void 0?void 0:e.values().next().value}get[RA](){return this[U]}constructor(e,t){super(e,new Set(t?[t]:[]))}get name(){return this[Ke].name||""}get minFilter(){return Wl.get(this[Ke].minFilter)}get magFilter(){return Xl.get(this[Ke].magFilter)}get wrapS(){return Ao.get(this[Ke].wrapS)}get wrapT(){return Ao.get(this[Ke].wrapT)}get rotation(){return this[Ke].rotation}get scale(){return po(this[Ke].repeat)}get offset(){return po(this[Ke].offset)}setMinFilter(e){this[at]("minFilter",nf.get(e))}setMagFilter(e){this[at]("magFilter",af.get(e))}setWrapS(e){this[at]("wrapS",TA.get(e))}setWrapT(e){this[at]("wrapT",TA.get(e))}setRotation(e){e==null&&(e=0),this[at]("rotation",e)}setScale(e){e==null&&(e={u:1,v:1}),this[at]("repeat",new Me(e.u,e.v))}setOffset(e){e==null&&(e={u:0,v:0}),this[at]("offset",new Me(e.u,e.v))}[at](e,t){if(cf(e,t))for(const i of this[RA])i[e]=t,i.needsUpdate=!0;this[j]()}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=Symbol("image"),DA=Symbol("sampler"),LA=Symbol("threeTexture");class Zl extends ni{get[LA](){var e;return(e=this[U])===null||e===void 0?void 0:e.values().next().value}constructor(e,t){super(e,new Set(t?[t]:[])),this[DA]=new lf(e,t),this[MA]=new sf(e,t)}get name(){return this[LA].name||""}set name(e){for(const t of this[U])t.name=e}get sampler(){return this[DA]}get source(){return this[MA]}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eh,th,sh;const xt=Symbol("texture"),St=Symbol("transform"),ca=Symbol("materials"),FA=Symbol("usage"),Wt=Symbol("onUpdate"),js=Symbol("activeVideo");var N;(function(o){o[o.Base=0]="Base",o[o.MetallicRoughness=1]="MetallicRoughness",o[o.Normal=2]="Normal",o[o.Occlusion=3]="Occlusion",o[o.Emissive=4]="Emissive",o[o.Clearcoat=5]="Clearcoat",o[o.ClearcoatRoughness=6]="ClearcoatRoughness",o[o.ClearcoatNormal=7]="ClearcoatNormal",o[o.SheenColor=8]="SheenColor",o[o.SheenRoughness=9]="SheenRoughness",o[o.Transmission=10]="Transmission",o[o.Thickness=11]="Thickness",o[o.Specular=12]="Specular",o[o.SpecularColor=13]="SpecularColor",o[o.Iridescence=14]="Iridescence",o[o.IridescenceThickness=15]="IridescenceThickness",o[o.Anisotropy=16]="Anisotropy"})(N||(N={}));class rs{constructor(e,t,i,s){this[eh]=null,this[th]={rotation:0,scale:new Me(1,1),offset:new Me(0,0)},this[sh]=!1,i&&(this[St].rotation=i.rotation,this[St].scale.copy(i.repeat),this[St].offset.copy(i.offset),this[xt]=new Zl(e,i)),this[Wt]=e,this[ca]=s,this[FA]=t}get texture(){return this[xt]}setTexture(e){var t,i;const s=e!=null?e.source[ge]:null,n=(t=this[xt])===null||t===void 0?void 0:t.source[ge];if(n!=null&&n.isVideoTexture?this[js]=!1:!((i=this[xt])===null||i===void 0)&&i.source.animation&&this[xt].source.animation.removeEventListener("enterFrame",this[Wt]),this[xt]=e,s!=null&&s.isVideoTexture){const r=s.image;if(this[js]=!0,r.requestVideoFrameCallback!=null){const A=()=>{this[js]&&(this[Wt](),r.requestVideoFrameCallback(A))};r.requestVideoFrameCallback(A)}else{const A=()=>{this[js]&&(this[Wt](),requestAnimationFrame(A))};requestAnimationFrame(A)}}else(e==null?void 0:e.source.animation)!=null&&e.source.animation.addEventListener("enterFrame",this[Wt]);let a=xe;if(this[ca])for(const r of this[ca]){switch(this[FA]){case N.Base:r.map=s;break;case N.MetallicRoughness:a=re,r.metalnessMap=s,r.roughnessMap=s;break;case N.Normal:a=re,r.normalMap=s;break;case N.Occlusion:a=re,r.aoMap=s;break;case N.Emissive:r.emissiveMap=s;break;case N.Clearcoat:r.clearcoatMap=s;break;case N.ClearcoatRoughness:r.clearcoatRoughnessMap=s;break;case N.ClearcoatNormal:r.clearcoatNormalMap=s;break;case N.SheenColor:r.sheenColorMap=s;break;case N.SheenRoughness:r.sheenRoughnessMap=s;break;case N.Transmission:r.transmissionMap=s;break;case N.Thickness:r.thicknessMap=s;break;case N.Specular:r.specularIntensityMap=s;break;case N.SpecularColor:r.specularColorMap=s;break;case N.Iridescence:r.iridescenceMap=s;break;case N.IridescenceThickness:r.iridescenceThicknessMap=s;break;case N.Anisotropy:r.anisotropyMap=s;break}r.needsUpdate=!0}s&&(s.colorSpace=a,s.rotation=this[St].rotation,s.repeat=this[St].scale,s.offset=this[St].offset),this[Wt]()}}eh=xt,th=St,sh=js;/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=Symbol("threeMaterial"),Ei=Symbol("threeMaterials"),kA=Symbol("baseColorTexture"),_A=Symbol("metallicRoughnessTexture");class hf extends ni{get[Ei](){return this[U]}get[Ts](){var e;return(e=this[U])===null||e===void 0?void 0:e.values().next().value}constructor(e,t){super(e,t);const{map:i,metalnessMap:s}=t.values().next().value;this[kA]=new rs(e,N.Base,i,t),this[_A]=new rs(e,N.MetallicRoughness,s,t)}get baseColorFactor(){const e=[0,0,0,this[Ts].opacity];return this[Ts].color.toArray(e),e}get metallicFactor(){return this[Ts].metalness}get roughnessFactor(){return this[Ts].roughness}get baseColorTexture(){return this[kA]}get metallicRoughnessTexture(){return this[_A]}setBaseColorFactor(e){const t=new oe;e instanceof Array?t.fromArray(e):t.set(e);for(const i of this[Ei])i.color.set(t),e instanceof Array&&e.length>3?i.opacity=e[3]:(e=[0,0,0,i.opacity],t.toArray(e));this[j]()}setMetallicFactor(e){for(const t of this[Ei])t.metalness=e;this[j]()}setRoughnessFactor(e){for(const t of this[Ei])t.roughness=e;this[j]()}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NA,GA;const UA=Symbol("pbrMetallicRoughness"),OA=Symbol("normalTexture"),PA=Symbol("occlusionTexture"),HA=Symbol("emissiveTexture"),W=Symbol("backingThreeMaterial"),qA=Symbol("applyAlphaCutoff"),la=Symbol("getAlphaMode"),Xt=Symbol("lazyLoadGLTFInfo"),ha=Symbol("initialize"),co=Symbol("getLoadedMaterial"),T=Symbol("ensureMaterialIsLoaded"),jA=Symbol("gltfIndex"),$s=Symbol("setActive"),ls=Symbol("variantIndices"),ua=Symbol("isActive"),$A=Symbol("modelVariants"),da=Symbol("name"),me=Symbol("pbrTextures");class ga extends ni{get[(NA=ls,GA=me,W)](){return this[U].values().next().value}constructor(e,t,i,s,n,a,r=void 0){super(e,n),this[NA]=new Set,this[GA]=new Map,this[jA]=t,this[ua]=i,this[$A]=s,this[da]=a,r==null?this[ha]():this[Xt]=r}[ha](){const e=this[j],t=this[U];this[UA]=new hf(e,t);const{normalMap:i,aoMap:s,emissiveMap:n}=t.values().next().value;this[OA]=new rs(e,N.Normal,i,t),this[PA]=new rs(e,N.Occlusion,s,t),this[HA]=new rs(e,N.Emissive,n,t);const a=r=>{this[me].set(r,new rs(e,r,null,t))};a(N.Clearcoat),a(N.ClearcoatRoughness),a(N.ClearcoatNormal),a(N.SheenColor),a(N.SheenRoughness),a(N.Transmission),a(N.Thickness),a(N.Specular),a(N.SpecularColor),a(N.Iridescence),a(N.IridescenceThickness),a(N.Anisotropy)}async[co](){if(this[Xt]!=null){const e=await this[Xt].doLazyLoad();return this[ha](),this[Xt]=void 0,this.ensureLoaded=async()=>{},e}return null}colorFromRgb(e){const t=new oe;return e instanceof Array?t.fromArray(e):t.set(e),t}[T](){if(this[Xt]!=null)throw new Error(`Material "${this.name}" has not been loaded, call 'await
    myMaterial.ensureLoaded()' before using an unloaded material.`)}async ensureLoaded(){await this[co]()}get isLoaded(){return this[Xt]==null}get isActive(){return this[ua]}[$s](e){this[ua]=e}get name(){return this[da]||""}set name(e){if(this[da]=e,this[U]!=null)for(const t of this[U])t.name=e}get pbrMetallicRoughness(){return this[T](),this[UA]}get normalTexture(){return this[T](),this[OA]}get occlusionTexture(){return this[T](),this[PA]}get emissiveTexture(){return this[T](),this[HA]}get emissiveFactor(){return this[T](),this[W].emissive.toArray()}get index(){return this[jA]}hasVariant(e){const t=this[$A].get(e);return t!=null&&this[ls].has(t.index)}setEmissiveFactor(e){this[T]();const t=this.colorFromRgb(e);for(const i of this[U])i.emissive.set(t);this[j]()}[la](){return this[W].transparent?"BLEND":this[W].alphaTest>0?"MASK":"OPAQUE"}[qA](){this[T]();for(const e of this[U])this[la]()==="MASK"?e.alphaTest==null&&(e.alphaTest=.5):e.alphaTest=void 0,e.needsUpdate=!0}setAlphaCutoff(e){this[T]();for(const t of this[U])t.alphaTest=e,t.needsUpdate=!0;this[qA](),this[j]()}getAlphaCutoff(){return this[T](),this[W].alphaTest}setDoubleSided(e){this[T]();for(const t of this[U])t.side=e?it:yo,t.needsUpdate=!0;this[j]()}getDoubleSided(){return this[T](),this[W].side==it}setAlphaMode(e){this[T]();const t=(i,s)=>{i.transparent=s,i.depthWrite=!s};for(const i of this[U])t(i,e==="BLEND"),e==="MASK"?i.alphaTest=.5:i.alphaTest=void 0,i.needsUpdate=!0;this[j]()}getAlphaMode(){return this[T](),this[la]()}get emissiveStrength(){return this[T](),this[W].emissiveIntensity}setEmissiveStrength(e){this[T]();for(const t of this[U])t.emissiveIntensity=e;this[j]()}get clearcoatFactor(){return this[T](),this[W].clearcoat}get clearcoatRoughnessFactor(){return this[T](),this[W].clearcoatRoughness}get clearcoatTexture(){return this[T](),this[me].get(N.Clearcoat)}get clearcoatRoughnessTexture(){return this[T](),this[me].get(N.ClearcoatRoughness)}get clearcoatNormalTexture(){return this[T](),this[me].get(N.ClearcoatNormal)}get clearcoatNormalScale(){return this[T](),this[W].clearcoatNormalScale.x}setClearcoatFactor(e){this[T]();for(const t of this[U])t.clearcoat=e;this[j]()}setClearcoatRoughnessFactor(e){this[T]();for(const t of this[U])t.clearcoatRoughness=e;this[j]()}setClearcoatNormalScale(e){this[T]();for(const t of this[U])t.clearcoatNormalScale=new Me(e,e);this[j]()}get ior(){return this[T](),this[W].ior}setIor(e){this[T]();for(const t of this[U])t.ior=e;this[j]()}get sheenColorFactor(){return this[T](),this[W].sheenColor.toArray()}get sheenColorTexture(){return this[T](),this[me].get(N.SheenColor)}get sheenRoughnessFactor(){return this[T](),this[W].sheenRoughness}get sheenRoughnessTexture(){return this[T](),this[me].get(N.SheenRoughness)}setSheenColorFactor(e){this[T]();const t=this.colorFromRgb(e);for(const i of this[U])i.sheenColor.set(t),i.sheen=1;this[j]()}setSheenRoughnessFactor(e){this[T]();for(const t of this[U])t.sheenRoughness=e,t.sheen=1;this[j]()}get transmissionFactor(){return this[T](),this[W].transmission}get transmissionTexture(){return this[T](),this[me].get(N.Transmission)}setTransmissionFactor(e){this[T]();for(const t of this[U])t.transmission=e;this[j]()}get thicknessFactor(){return this[T](),this[W].thickness}get thicknessTexture(){return this[T](),this[me].get(N.Thickness)}get attenuationDistance(){return this[T](),this[W].attenuationDistance}get attenuationColor(){return this[T](),this[W].attenuationColor.toArray()}setThicknessFactor(e){this[T]();for(const t of this[U])t.thickness=e;this[j]()}setAttenuationDistance(e){this[T]();for(const t of this[U])t.attenuationDistance=e;this[j]()}setAttenuationColor(e){this[T]();const t=this.colorFromRgb(e);for(const i of this[U])i.attenuationColor.set(t);this[j]()}get specularFactor(){return this[T](),this[W].specularIntensity}get specularTexture(){return this[T](),this[me].get(N.Specular)}get specularColorFactor(){return this[T](),this[W].specularColor.toArray()}get specularColorTexture(){return this[T](),this[me].get(N.SheenColor)}setSpecularFactor(e){this[T]();for(const t of this[U])t.specularIntensity=e;this[j]()}setSpecularColorFactor(e){this[T]();const t=this.colorFromRgb(e);for(const i of this[U])i.specularColor.set(t);this[j]()}get iridescenceFactor(){return this[T](),this[W].iridescence}get iridescenceTexture(){return this[T](),this[me].get(N.Iridescence)}get iridescenceIor(){return this[T](),this[W].iridescenceIOR}get iridescenceThicknessMinimum(){return this[T](),this[W].iridescenceThicknessRange[0]}get iridescenceThicknessMaximum(){return this[T](),this[W].iridescenceThicknessRange[1]}get iridescenceThicknessTexture(){return this[T](),this[me].get(N.IridescenceThickness)}setIridescenceFactor(e){this[T]();for(const t of this[U])t.iridescence=e;this[j]()}setIridescenceIor(e){this[T]();for(const t of this[U])t.iridescenceIOR=e;this[j]()}setIridescenceThicknessMinimum(e){this[T]();for(const t of this[U])t.iridescenceThicknessRange[0]=e;this[j]()}setIridescenceThicknessMaximum(e){this[T]();for(const t of this[U])t.iridescenceThicknessRange[1]=e;this[j]()}get anisotropyStrength(){return this[T](),this[W].anisotropy}get anisotropyRotation(){return this[T](),this[W].anisotropyRotation}get anisotropyTexture(){return this[T](),this[me].get(N.Anisotropy)}setAnisotropyStrength(e){this[T]();for(const t of this[U])t.anisotropy=e;this[j]()}setAnisotropyRotation(e){this[T]();for(const t of this[U])t.anisotropyRotation=e;this[j]()}}let ih=class{constructor(e){this.name="",this.children=new Array,this.name=e}};class pa extends ih{constructor(e,t,i,s){super(e.name),this.materials=new Map,this.variantToMaterialMap=new Map,this.initialMaterialIdx=0,this.activeMaterialIdx=0,this.mesh=e;const{gltf:n,threeGLTF:a,threeObjectMap:r}=s;this.parser=a.parser,this.modelVariants=i,this.mesh.userData.variantData=i;const A=r.get(e.material);A.materials!=null?this.initialMaterialIdx=this.activeMaterialIdx=A.materials:console.error(`Primitive (${e.name}) missing initial material reference.`);const c=e.userData.associations||{};if(c.meshes==null){console.error("Mesh is missing primitive index association");return}const d=((n.meshes||[])[c.meshes].primitives||[])[c.primitives];if(d==null){console.error("Mesh primitive definition is missing.");return}if(d.material!=null)this.materials.set(d.material,t[d.material]);else{const u=t.findIndex(g=>g.name==="Default");u>=0?this.materials.set(u,t[u]):console.warn("gltfPrimitive has no material!")}if(d.extensions&&d.extensions.KHR_materials_variants){const u=d.extensions.KHR_materials_variants,p=a.parser.json.extensions.KHR_materials_variants.variants;for(const f of u.mappings){const m=t[f.material];this.materials.set(f.material,m);for(const I of f.variants){const{name:C}=p[I];this.variantToMaterialMap.set(I,m),m[ls].add(I),i.has(C)||i.set(C,{name:C,index:I})}}}}async setActiveMaterial(e){const t=this.materials.get(e);if(e!==this.activeMaterialIdx){const i=t[U],s=await t[co]();s!=null?this.mesh.material=s:this.mesh.material=i.values().next().value,this.parser.assignFinalMaterial(this.mesh),i.add(this.mesh.material),this.activeMaterialIdx=e}return this.mesh.material}getActiveMaterial(){return this.materials.get(this.activeMaterialIdx)}getMaterial(e){return this.materials.get(e)}async enableVariant(e){if(e==null)return this.setActiveMaterial(this.initialMaterialIdx);if(this.variantToMaterialMap!=null&&this.modelVariants.has(e)){const t=this.modelVariants.get(e);return this.enableVariantHelper(t.index)}return null}async enableVariantHelper(e){if(this.variantToMaterialMap!=null&&e!=null){const t=this.variantToMaterialMap.get(e);if(t!=null)return this.setActiveMaterial(t.index)}return null}async instantiateVariants(){if(this.variantToMaterialMap!=null)for(const e of this.variantToMaterialMap.keys()){const t=this.mesh.userData.variantMaterials.get(e);if(t.material!=null)continue;const i=await this.enableVariantHelper(e);i!=null&&(t.material=i)}}get variantInfo(){return this.variantToMaterialMap}addVariant(e,t){if(!this.ensureVariantIsUnused(t))return!1;this.modelVariants.has(t)||this.modelVariants.set(t,{name:t,index:this.modelVariants.size});const s=this.modelVariants.get(t).index;return e[ls].add(s),this.variantToMaterialMap.set(s,e),this.materials.set(e.index,e),this.updateVariantUserData(s,e),!0}deleteVariant(e){if(this.variantInfo.has(e)){this.variantInfo.delete(e);const t=this.mesh.userData.variantMaterials;t!=null&&t.delete(e)}}updateVariantUserData(e,t){t[ls].add(e),this.mesh.userData.variantData=this.modelVariants,this.mesh.userData.variantMaterials=this.mesh.userData.variantMaterials||new Map,this.mesh.userData.variantMaterials.set(e,{material:t[U].values().next().value,gltfMaterialIndex:t.index})}ensureVariantIsUnused(e){const t=this.modelVariants.get(e);return t!=null&&this.variantInfo.has(t.index)?(console.warn(`Primitive cannot add variant '${e}' for this material, it already exists.`),!1):!0}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var VA,zA,KA,JA,YA,WA;const Bt=Symbol("materials"),Ci=Symbol("hierarchy"),XA=Symbol("roots"),Je=Symbol("primitives"),nh=Symbol("prepareVariantsForExport"),ah=Symbol("switchVariant"),oh=Symbol("materialFromPoint"),lo=Symbol("nodeFromPoint"),rh=Symbol("nodeFromIndex"),ce=Symbol("variantData"),ho=Symbol("availableVariants"),fa=Symbol("modelOnUpdate"),ZA=Symbol("cloneMaterial");class uf{constructor(e,t,i,s){this.gltf=e,this.gltfElementMap=t,this.mapKey=i,this.doLazyLoad=s}}class df{constructor(e,t=()=>{}){this[VA]=new Array,this[zA]=new Array,this[KA]=new Array,this[JA]=new Array,this[YA]=()=>{},this[WA]=new Map,this[fa]=t;const{gltf:i,threeGLTF:s,gltfElementMap:n}=e;for(const[A,c]of i.materials.entries()){const h=n.get(c);if(h!=null)this[Bt].push(new ga(t,A,!0,this[ce],h,c.name));else{const d=(i.materials||[])[A],u=new Set;n.set(d,u);const g=async()=>{const p=await s.parser.getDependency("material",A);return u.add(p),p};this[Bt].push(new ga(t,A,!1,this[ce],u,c.name,new uf(i,n,d,g)))}}const a=new Map,r=new Array;for(const A of s.scene.children)r.push(A);for(;r.length>0;){const A=r.pop();let c=null;A instanceof Ie?(c=new pa(A,this.materials,this[ce],e),this[Je].push(c)):c=new ih(A.name);const h=a.get(A);h!=null?h.children.push(c):this[XA].push(c),this[Ci].push(c);for(const l of A.children)r.push(l),a.set(A,c)}}get materials(){return this[Bt]}[(VA=Bt,zA=Ci,KA=XA,JA=Je,YA=fa,WA=ce,ho)](){const e=Array.from(this[ce].values());return e.sort((t,i)=>t.index-i.index),e.map(t=>t.name)}getMaterialByName(e){const t=this[Bt].filter(i=>i.name===e);return t.length>0?t[0]:null}[rh](e,t){const i=this[Ci].find(s=>{if(s instanceof pa){const{meshes:n,primitives:a}=s.mesh.userData.associations;if(n==e&&a==t)return!0}return!1});return i??null}[lo](e){return this[Ci].find(t=>t instanceof pa&&t.mesh===e.object)}[oh](e){return this[lo](e).getActiveMaterial()}async[ah](e){for(const t of this[Je])await t.enableVariant(e);for(const t of this.materials)t[$s](!1);for(const t of this[Je])this.materials[t.getActiveMaterial().index][$s](!0)}async[nh](){const e=new Array;for(const t of this[Je])e.push(t.instantiateVariants());await Promise.all(e)}[ZA](e,t){const i=this.materials[e];i.isLoaded||console.error(`Cloning an unloaded material,
           call 'material.ensureLoaded() before cloning the material.`);const s=i[U],n=new Set;for(const[r,A]of s.entries()){const c=A.clone();c.name=t+(s.size>1?"_inst"+r:""),n.add(c)}const a=new ga(this[fa],this[Bt].length,!1,this[ce],n,t);return this[Bt].push(a),a}createMaterialInstanceForVariant(e,t,i,s=!0){let n=null;for(const a of this[Je]){const r=this[ce].get(i);r!=null&&a.variantInfo.has(r.index)||a.getMaterial(e)!=null&&(this.hasVariant(i)||this.createVariant(i),n==null&&(n=this[ZA](e,t)),a.addVariant(n,i))}if(s&&n!=null){n[$s](!0),this.materials[e][$s](!1);for(const a of this[Je])a.enableVariant(i)}return n}createVariant(e){this[ce].has(e)?console.warn(`Variant '${e}'' already exists`):this[ce].set(e,{name:e,index:this[ce].size})}hasVariant(e){return this[ce].has(e)}setMaterialToVariant(e,t){if(this[ho]().find(i=>i===t)==null){console.warn(`Can't add material to '${t}', the variant does not exist.'`);return}if(e<0||e>=this.materials.length){console.error("setMaterialToVariant(): materialIndex is out of bounds.");return}for(const i of this[Je]){const s=i.getMaterial(e);s!=null&&i.addVariant(s,t)}}updateVariantName(e,t){const i=this[ce].get(e);i!=null&&(i.name=t,this[ce].set(t,i),this[ce].delete(e))}deleteVariant(e){const t=this[ce].get(e);if(t!=null){for(const i of this.materials)i.hasVariant(e)&&i[ls].delete(t.index);for(const i of this[Je])i.deleteVariant(t.index);this[ce].delete(e)}}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ma=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const Hi=Symbol("currentGLTF"),qi=Symbol("originalGltfJson"),vt=Symbol("model"),ba=Symbol("getOnUpdateMethod"),Rs=Symbol("buildTexture"),gf=o=>{var e,t,i;class s extends o{constructor(){super(...arguments),this[e]=void 0,this[t]=null,this[i]=null,this.variantName=null,this.orientation="0 0 0",this.scale="1 1 1"}get model(){return this[vt]}get availableVariants(){return this.model?this.model[ho]():[]}get originalGltfJson(){return this[qi]}[(e=vt,t=Hi,i=qi,ba)](){return()=>{this[ne]()}}[Rs](a){return a.colorSpace=xe,a.wrapS=ft,a.wrapT=ft,new Zl(this[ba](),a)}async createTexture(a,r="image/png"){const{textureUtils:A}=this[K],c=await A.loadImage(a,this.withCredentials);return c.userData.mimeType=r,this[Rs](c)}async createLottieTexture(a,r=1){const{textureUtils:A}=this[K],c=await A.loadLottie(a,r,this.withCredentials);return this[Rs](c)}createVideoTexture(a){const r=document.createElement("video");r.crossOrigin=this.withCredentials?"use-credentials":"anonymous",r.src=a,r.muted=!0,r.playsInline=!0,r.loop=!0,r.play();const A=new cu(r);return this[Rs](A)}createCanvasTexture(){const a=document.createElement("canvas"),r=new lu(a);return this[Rs](r)}async updated(a){if(super.updated(a),a.has("variantName")){const r=this[_t].beginActivity("variant-update");r(.1);const A=this[vt],{variantName:c}=this;A!=null&&(await A[ah](c),this[ne](),this.dispatchEvent(new CustomEvent("variant-applied"))),r(1)}if(a.has("orientation")||a.has("scale")){if(!this.loaded)return;const r=this[x];r.applyTransform(),r.updateBoundingBox(),r.updateShadow(),this[K].arRenderer.onUpdateScene(),this[ne]()}}[qe](){super[qe]();const{currentGLTF:a}=this[x];if(a!=null){const{correlatedSceneGraph:r}=a;r!=null&&a!==this[Hi]&&(this[vt]=new df(r,this[ba]()),this[qi]=JSON.parse(JSON.stringify(r.gltf))),"variants"in a.userData&&this.requestUpdate("variantName")}this[Hi]=a}async exportScene(a){const r=this[x];return new Promise(async(A,c)=>{const h={binary:!0,onlyVisible:!0,maxTextureSize:1/0,includeCustomExtensions:!1,forceIndices:!1};Object.assign(h,a),h.animations=r.animations,h.truncateDrawRange=!0;const l=r.shadow;let d=!1;l!=null&&(d=l.visible,l.visible=!1),await this[vt][nh](),new tn().register(g=>new qg(g)).parse(r.model,g=>A(new Blob([h.binary?g:JSON.stringify(g)],{type:h.binary?"application/octet-stream":"application/json"})),()=>c("glTF export failed"),h),l!=null&&(l.visible=d)})}materialFromPoint(a,r){const A=this[vt];if(A==null)return null;const c=this[x],h=c.getNDC(a,r),l=c.hitFromPoint(h);return l==null||l.face==null?null:A[oh](l)}}return ma([_({type:String,attribute:"variant-name"})],s.prototype,"variantName",void 0),ma([_({type:String,attribute:"orientation"})],s.prototype,"orientation",void 0),ma([_({type:String,attribute:"scale"})],s.prototype,"scale",void 0),s};/* @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf extends Ie{constructor(){super(void 0,new et({depthWrite:!1})),this.height=0,this.radius=0,this.resolution=0,this.userData.noHit=!0}get map(){return this.material.map}set map(e){this.material.map=e}isUsable(){return this.height>0&&this.radius>0&&this.geometry!=null&&this.map!=null}updateGeometry(e=this.height,t=this.radius,i=128){(e!=this.height||t!=this.radius||i!=this.resolution)&&(this.height=e,this.radius=t,this.resolution=i,e>0&&t>0&&(this.geometry.dispose(),this.geometry=ff(e,t,i)))}}function ff(o,e,t){const i=new hu(e,2*t,t);i.scale(1,1,-1);const s=i.getAttribute("position"),n=new G;for(let a=0;a<s.count;++a)if(n.fromBufferAttribute(s,a),n.y<0){const r=-o*3/2,A=n.y<r?-o/n.y:1-n.y*n.y/(3*r*r);n.multiplyScalar(A),n.toArray(s.array,3*a)}return s.needsUpdate=!0,i}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new G,Ia=new G,Ea=new G,yi=new xo,ec=new el,tc=new ms;class Ah extends mg{constructor(e){super(document.createElement("div")),this.normal=new G(0,1,0),this.initialized=!1,this.referenceCount=1,this.pivot=document.createElement("div"),this.slot=document.createElement("slot"),this.element.classList.add("annotation-wrapper"),this.slot.name=e.name,this.element.appendChild(this.pivot),this.pivot.appendChild(this.slot),this.updatePosition(e.position),this.updateNormal(e.normal),this.surface=e.surface}get facingCamera(){return!this.element.classList.contains("hide")}show(){(!this.facingCamera||!this.initialized)&&this.updateVisibility(!0)}hide(){(this.facingCamera||!this.initialized)&&this.updateVisibility(!1)}increment(){this.referenceCount++}decrement(){return this.referenceCount>0&&--this.referenceCount,this.referenceCount===0}updatePosition(e){if(e==null)return;const t=st(e)[0].terms;for(let i=0;i<3;++i)this.position.setComponent(i,Oe(t[i]).number);this.updateMatrixWorld()}updateNormal(e){if(e==null)return;const t=st(e)[0].terms;for(let i=0;i<3;++i)this.normal.setComponent(i,t[i].number)}updateSurface(){const{mesh:e,tri:t,bary:i}=this;if(e==null||t==null||i==null)return;e.getVertexPosition(t.x,Bi),e.getVertexPosition(t.y,Ia),e.getVertexPosition(t.z,Ea),Bi.toArray(yi.elements,0),Ia.toArray(yi.elements,3),Ea.toArray(yi.elements,6),this.position.copy(i).applyMatrix3(yi);const s=this.parent;s.worldToLocal(e.localToWorld(this.position)),ec.set(Bi,Ia,Ea),ec.getNormal(this.normal).transformDirection(e.matrixWorld);const n=s.parent;tc.setFromAxisAngle(Bi.set(0,1,0),-n.rotation.y),this.normal.applyQuaternion(tc)}orient(e){this.pivot.style.transform=`rotate(${e}rad)`}updateVisibility(e){this.element.classList.toggle("hide",!e),this.slot.assignedNodes().forEach(t=>{if(t.nodeType!==Node.ELEMENT_NODE)return;const i=t,s=i.dataset.visibilityAttribute;if(s!=null){const n=`data-${s}`;i.toggleAttribute(n,e)}i.dispatchEvent(new CustomEvent("hotspot-visibility",{detail:{visible:e}}))}),this.initialized=!0}}const mf={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`},bf={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`};function sc(o,e,t){return(1-t)*o+t*e}/* @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic=9,If=6,Ca=2,Ef=.3;class Cf extends us{constructor(e,t,i){super(),this.camera=new Co,this.renderTarget=null,this.renderTargetBlur=null,this.depthMaterial=new uu,this.horizontalBlurMaterial=new to(mf),this.verticalBlurMaterial=new to(bf),this.intensity=0,this.softness=1,this.boundingBox=new Rt,this.size=new G,this.maxDimension=0,this.isAnimated=!1,this.needsUpdate=!1;const{camera:s}=this;s.rotation.x=Math.PI/2,s.left=-.5,s.right=.5,s.bottom=-.5,s.top=.5,this.add(s);const n=new Qo,a=new et({opacity:1,transparent:!0,side:So});this.floor=new Ie(n,a),this.floor.userData.noHit=!0,s.add(this.floor),this.blurPlane=new Ie(n),this.blurPlane.visible=!1,s.add(this.blurPlane),e.target.add(this),this.depthMaterial.onBeforeCompile=function(r){r.fragmentShader=r.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this.depthMaterial.side=it,this.horizontalBlurMaterial.depthTest=!1,this.verticalBlurMaterial.depthTest=!1,this.setScene(e,t,i)}setScene(e,t,i){const{boundingBox:s,size:n,rotation:a,position:r}=this;if(this.isAnimated=e.animationNames.length>0,this.boundingBox.copy(e.boundingBox),this.size.copy(e.size),this.maxDimension=Math.max(n.x,n.y,n.z)*(this.isAnimated?Ca:1),this.boundingBox.getCenter(r),i==="back"){const{min:A,max:c}=s;[A.y,A.z]=[A.z,A.y],[c.y,c.z]=[c.z,c.y],[n.y,n.z]=[n.z,n.y],a.x=Math.PI/2,a.y=Math.PI}else a.x=0,a.y=0;if(this.isAnimated){const A=s.min.y,c=s.max.y;n.y=this.maxDimension,s.expandByVector(n.subScalar(this.maxDimension).multiplyScalar(-.5)),s.min.y=A,s.max.y=c,n.set(this.maxDimension,c-A,this.maxDimension)}i==="bottom"?r.y=s.min.y:r.z=s.min.y,this.setSoftness(t)}setSoftness(e){this.softness=e;const{size:t,camera:i}=this,s=this.isAnimated?Ca:1,n=s*Math.pow(2,ic-e*(ic-If));this.setMapSize(n);const a=t.y/2,r=t.y*s;i.near=0,i.far=sc(r,a,e),this.depthMaterial.opacity=1/e,i.updateProjectionMatrix(),this.setIntensity(this.intensity),this.setOffset(0)}setMapSize(e){const{size:t}=this;this.isAnimated&&(e*=Ca);const i=Math.floor(t.x>t.z?e:e*t.x/t.z),s=Math.floor(t.x>t.z?e*t.z/t.x:e),n=10,a=n+i,r=n+s;if(this.renderTarget!=null&&(this.renderTarget.width!==a||this.renderTarget.height!==r)&&(this.renderTarget.dispose(),this.renderTarget=null,this.renderTargetBlur.dispose(),this.renderTargetBlur=null),this.renderTarget==null){const A={format:tt};this.renderTarget=new so(a,r,A),this.renderTargetBlur=new so(a,r,A),this.floor.material.map=this.renderTarget.texture}this.camera.scale.set(t.x*(1+n/i),t.z*(1+n/s),1),this.needsUpdate=!0}setIntensity(e){this.intensity=e,e>0?(this.visible=!0,this.floor.visible=!0,this.floor.material.opacity=e*sc(Ef,1,this.softness*this.softness)):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.intensity}setOffset(e){this.floor.position.z=-e+this.gap()}gap(){return .001*this.maxDimension}render(e,t){t.overrideMaterial=this.depthMaterial;const i=e.getClearAlpha();e.setClearAlpha(0),this.floor.visible=!1;const s=e.xr.enabled;e.xr.enabled=!1;const n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.render(t,this.camera),t.overrideMaterial=null,this.floor.visible=!0,this.blurShadow(e),e.xr.enabled=s,e.setRenderTarget(n),e.setClearAlpha(i)}blurShadow(e){const{camera:t,horizontalBlurMaterial:i,verticalBlurMaterial:s,renderTarget:n,renderTargetBlur:a,blurPlane:r}=this;r.visible=!0,r.material=i,i.uniforms.h.value=1/this.renderTarget.width,i.uniforms.tDiffuse.value=this.renderTarget.texture,e.setRenderTarget(a),e.render(r,t),r.material=s,s.uniforms.v.value=1/this.renderTarget.height,s.uniforms.tDiffuse.value=this.renderTargetBlur.texture,e.setRenderTarget(n),e.render(r,t),r.visible=!1}dispose(){this.renderTarget!=null&&this.renderTarget.dispose(),this.renderTargetBlur!=null&&this.renderTargetBlur.dispose(),this.depthMaterial.dispose(),this.horizontalBlurMaterial.dispose(),this.verticalBlurMaterial.dispose(),this.floor.material.dispose(),this.floor.geometry.dispose(),this.blurPlane.geometry.dispose(),this.removeFromParent()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc=10,Ba=100,ya=new G,ac=new G,oc=new G,wi=new du,Bf=new G,Ms=new Me;class yf extends ds{constructor({canvas:e,element:t,width:i,height:s}){super(),this.annotationRenderer=new bg,this.effectRenderer=null,this.schemaElement=document.createElement("script"),this.width=1,this.height=1,this.aspect=1,this.scaleStep=0,this.renderCount=0,this.externalRenderer=null,this.appendedAnimations=[],this.markedAnimations=[],this.camera=new zi(45,1,.1,100),this.xrCamera=null,this.url=null,this.pivot=new us,this.target=new us,this.animationNames=[],this.boundingBox=new Rt,this.boundingSphere=new wo,this.size=new G,this.idealAspect=0,this.framedFoVDeg=0,this.shadow=null,this.shadowIntensity=0,this.shadowSoftness=1,this.bakedShadows=new Set,this.exposure=1,this.toneMapping=$i,this.canScale=!0,this.isDirty=!1,this.goalTarget=new G,this.targetDamperX=new fe,this.targetDamperY=new fe,this.targetDamperZ=new fe,this._currentGLTF=null,this._model=null,this.cancelPendingSourceChange=null,this.animationsByName=new Map,this.currentAnimationAction=null,this.groundedSkybox=new pf,this.name="ModelScene",this.element=t,this.canvas=e,this.camera=new zi(45,1,.1,100),this.camera.name="MainCamera",this.add(this.pivot),this.pivot.name="Pivot",this.pivot.add(this.target),this.setSize(i,s),this.target.name="Target",this.mixer=new gu(this.target);const{domElement:n}=this.annotationRenderer,{style:a}=n;a.display="none",a.pointerEvents="none",a.position="absolute",a.top="0",this.element.shadowRoot.querySelector(".default").appendChild(n),this.schemaElement.setAttribute("type","application/ld+json")}get context(){return this.canvas.getContext("2d")}getCamera(){return this.xrCamera!=null?this.xrCamera:this.camera}queueRender(){this.isDirty=!0}shouldRender(){return this.isDirty}hasRendered(){this.isDirty=!1}forceRescale(){this.scaleStep=-1,this.queueRender()}async setObject(e){this.reset(),this._model=e,this.target.add(e),await this.setupScene()}async setSource(e,t=()=>{}){if(!e||e===this.url){t(1);return}if(this.reset(),this.url=e,this.externalRenderer!=null){const r=await this.externalRenderer.load(t);this.boundingSphere.radius=r.framedRadius,this.idealAspect=r.fieldOfViewAspect;return}this.cancelPendingSourceChange!=null&&(this.cancelPendingSourceChange(),this.cancelPendingSourceChange=null);let i;try{i=await new Promise(async(r,A)=>{this.cancelPendingSourceChange=()=>A();try{const c=await this.element[K].loader.load(e,this.element,t);r(c)}catch(c){A(c)}})}catch(r){if(r==null)return;throw r}this.cancelPendingSourceChange=null,this.reset(),this.url=e,this._currentGLTF=i,i!=null&&(this._model=i.scene,this.target.add(i.scene));const{animations:s}=i,n=new Map,a=[];for(const r of s)n.set(r.name,r),a.push(r.name);this.animations=s,this.animationsByName=n,this.animationNames=a,await this.setupScene()}async setupScene(){this.applyTransform(),this.updateBoundingBox(),await this.updateFraming(),this.updateShadow(),this.setShadowIntensity(this.shadowIntensity),this.setGroundedSkybox()}reset(){this.url=null,this.renderCount=0,this.queueRender(),this.shadow!=null&&this.shadow.setIntensity(0),this.bakedShadows.clear();const{_model:e}=this;e!=null&&(e.removeFromParent(),this._model=null);const t=this._currentGLTF;t!=null&&(t.dispose(),this._currentGLTF=null),this.currentAnimationAction!=null&&(this.currentAnimationAction.stop(),this.currentAnimationAction=null),this.mixer.stopAllAction(),this.mixer.uncacheRoot(this)}dispose(){this.reset(),this.shadow!=null&&(this.shadow.dispose(),this.shadow=null),this.element[Hi]=null,this.element[qi]=null,this.element[vt]=null}get currentGLTF(){return this._currentGLTF}setSize(e,t){if(!(this.width===e&&this.height===t)){if(this.width=Math.max(e,1),this.height=Math.max(t,1),this.annotationRenderer.setSize(e,t),this.aspect=this.width/this.height,this.externalRenderer!=null){const i=window.devicePixelRatio;this.externalRenderer.resize(e*i,t*i)}this.queueRender()}}markBakedShadow(e){e.userData.noHit=!0,this.bakedShadows.add(e)}unmarkBakedShadow(e){e.userData.noHit=!1,e.visible=!0,this.bakedShadows.delete(e),this.boundingBox.expandByObject(e)}findBakedShadows(e){const t=new Rt;e.traverse(i=>{const s=i;if(!s.material||!s.material.transparent)return;t.setFromObject(s);const a=t.getSize(Bf),r=Math.min(a.x,a.y,a.z);Math.max(a.x,a.y,a.z)<Ba*r||this.markBakedShadow(s)})}checkBakedShadows(){const{min:e,max:t}=this.boundingBox,i=new Rt;this.boundingBox.getSize(this.size);for(const s of this.bakedShadows)i.setFromObject(s),!(i.min.y<e.y+this.size.y/Ba&&i.min.x<=e.x&&i.max.x>=t.x&&i.min.z<=e.z&&i.max.z>=t.z)&&(i.min.z<e.z+this.size.z/Ba&&i.min.x<=e.x&&i.max.x>=t.x&&i.min.y<=e.y&&i.max.y>=t.y||this.unmarkBakedShadow(s))}applyTransform(){const{model:e}=this;if(e==null)return;const t=st(this.element.orientation)[0].terms,i=Oe(t[0]).number,s=Oe(t[1]).number,n=Oe(t[2]).number;e.quaternion.setFromEuler(new Zc(s,n,i,"YXZ"));const a=st(this.element.scale)[0].terms;e.scale.set(a[0].number,a[1].number,a[2].number)}updateBoundingBox(){const{model:e}=this;if(e==null)return;this.target.remove(e),this.findBakedShadows(e);const t=(i,s)=>i.expandByPoint(s);this.setBakedShadowVisibility(!1),this.boundingBox=ci(e,t,new Rt),this.boundingBox.isEmpty()&&(this.setBakedShadowVisibility(!0),this.bakedShadows.forEach(i=>this.unmarkBakedShadow(i)),this.boundingBox=ci(e,t,new Rt)),this.checkBakedShadows(),this.setBakedShadowVisibility(),this.boundingBox.getSize(this.size),this.target.add(e)}async updateFraming(){const{model:e}=this;if(e==null)return;this.target.remove(e),this.setBakedShadowVisibility(!1);const{center:t}=this.boundingSphere;this.element.requestUpdate("cameraTarget"),await this.element.updateComplete,t.copy(this.getTarget());const i=(n,a)=>Math.max(n,t.distanceToSquared(a));this.boundingSphere.radius=Math.sqrt(ci(e,i,0));const s=(n,a)=>{a.sub(t);const r=Math.sqrt(a.x*a.x+a.z*a.z);return Math.max(n,r/(this.idealCameraDistance()-Math.abs(a.y)))};this.idealAspect=ci(e,s,0)/Math.tan(this.framedFoVDeg/2*Math.PI/180),this.setBakedShadowVisibility(),this.target.add(e)}setBakedShadowVisibility(e=this.shadowIntensity<=0){for(const t of this.bakedShadows)t.visible=e}idealCameraDistance(){const e=this.framedFoVDeg/2*Math.PI/180;return this.boundingSphere.radius/Math.sin(e)}adjustedFoV(e){const t=Math.tan(e/2*Math.PI/180)*Math.max(1,this.idealAspect/this.aspect);return 2*Math.atan(t)*180/Math.PI}getNDC(e,t){if(this.xrCamera!=null)Ms.set(e/window.screen.width,t/window.screen.height);else{const i=this.element.getBoundingClientRect();Ms.set((e-i.x)/this.width,(t-i.y)/this.height)}return Ms.multiplyScalar(2).subScalar(1),Ms.y*=-1,Ms}getSize(){return{width:this.width,height:this.height}}setEnvironmentAndSkybox(e,t){this.element[K].arRenderer.presentedScene!==this&&(this.environment=e,this.setBackground(t),this.queueRender())}setBackground(e){this.groundedSkybox.map=e,this.groundedSkybox.isUsable()?(this.target.add(this.groundedSkybox),this.background=null):(this.target.remove(this.groundedSkybox),this.background=e)}farRadius(){return this.boundingSphere.radius*(this.groundedSkybox.parent!=null?nc:1)}setGroundedSkybox(){const e=st(this.element.skyboxHeight)[0].terms[0],t=Oe(e).number,i=nc*this.boundingSphere.radius;this.groundedSkybox.updateGeometry(t,i),this.groundedSkybox.position.y=t-(this.shadow?2*this.shadow.gap():0),this.setBackground(this.groundedSkybox.map)}setTarget(e,t,i){this.goalTarget.set(-e,-t,-i)}setTargetDamperDecayTime(e){this.targetDamperX.setDecayTime(e),this.targetDamperY.setDecayTime(e),this.targetDamperZ.setDecayTime(e)}getTarget(){return this.goalTarget.clone().multiplyScalar(-1)}getDynamicTarget(){return this.target.position.clone().multiplyScalar(-1)}jumpToGoal(){this.updateTarget(Ll)}updateTarget(e){const t=this.goalTarget,i=this.target.position;if(t.equals(i))return!1;{const s=this.boundingSphere.radius/10;let{x:n,y:a,z:r}=i;return n=this.targetDamperX.update(n,t.x,e,s),a=this.targetDamperY.update(a,t.y,e,s),r=this.targetDamperZ.update(r,t.z,e,s),this.groundedSkybox.position.x=-n,this.groundedSkybox.position.z=-r,this.target.position.set(n,a,r),this.target.updateMatrixWorld(),this.queueRender(),!0}}pointTowards(e,t){const{x:i,z:s}=this.position;this.yaw=Math.atan2(e-i,t-s)}get model(){return this._model}set yaw(e){this.pivot.rotation.y=e,this.groundedSkybox.rotation.y=-e,this.queueRender()}get yaw(){return this.pivot.rotation.y}set animationTime(e){this.mixer.setTime(e),this.queueShadowRender()}get animationTime(){if(this.currentAnimationAction!=null){const e=Math.max(this.currentAnimationAction._loopCount,0);return this.currentAnimationAction.loop===io&&(e&1)===1?this.duration-this.currentAnimationAction.time:this.currentAnimationAction.time}return 0}set animationTimeScale(e){this.mixer.timeScale=e}get animationTimeScale(){return this.mixer.timeScale}get duration(){return this.currentAnimationAction!=null&&this.currentAnimationAction.getClip()?this.currentAnimationAction.getClip().duration:0}get hasActiveAnimation(){return this.currentAnimationAction!=null}playAnimation(e=null,t=0,i=Js,s=1/0){if(this._currentGLTF==null)return;const{animations:n}=this;if(n==null||n.length===0)return;let a=null;if(e!=null&&(a=this.animationsByName.get(e),a==null)){const r=parseInt(e);!isNaN(r)&&r>=0&&r<n.length&&(a=n[r])}a==null&&(a=n[0]);try{const{currentAnimationAction:r}=this,A=this.mixer.clipAction(a,this);A.timeScale!=this.element.timeScale&&(A.timeScale=this.element.timeScale),this.currentAnimationAction=A,this.element.paused?this.mixer.stopAllAction():(A.paused=!1,r!=null&&A!==r?A.crossFadeFrom(r,t,!1):this.animationTimeScale>0&&this.animationTime==this.duration&&(this.animationTime=0)),A.setLoop(i,s),A.enabled=!0,A.clampWhenFinished=!0,A.play()}catch(r){console.error(r)}}appendAnimation(e="",t=Js,i=1/0,s=1,n=1,a=!1,r=!1,A=!0,c=null,h=!1){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:l}=this;if(l==null||l.length===0)return;let d=null;const u=1.25;if(e&&(d=this.animationsByName.get(e)),d!=null){typeof i=="string"?isNaN(i)?(i=1/0,console.warn("Invalid repetitionCount value, repetitionCount is set to Infinity")):i=Math.max(parseInt(i),1):typeof i=="number"&&i<1&&(i=1),i===1&&t!==Wi&&(t=Wi),typeof s=="string"&&(isNaN(s)?(s=1,console.warn("Invalid weight value, weight is set to 1")):s=parseFloat(s)),typeof n=="string"&&(isNaN(n)?(n=1,console.warn("Invalid timeScale value, timeScale is set to 1")):n=parseFloat(n)),typeof a=="string"&&(a.toLowerCase().trim()==="true"?a=!0:a.toLowerCase().trim()==="false"?a=!1:isNaN(a)?(a=!1,console.warn("Invalid fade value, fade is set to false")):a=parseFloat(a)),typeof r=="string"&&(r.toLowerCase().trim()==="true"?r=!0:r.toLowerCase().trim()==="false"?r=!1:isNaN(r)?(r=!1,console.warn("Invalid warp value, warp is set to false")):r=parseFloat(r)),typeof c=="string"&&(isNaN(c)||(c=parseFloat(c)));try{const g=this.mixer.existingAction(d)||this.mixer.clipAction(d,this),p=g.timeScale;h&&this.appendedAnimations.includes(e)&&(this.markedAnimations.map(f=>f.name).includes(e)||this.markedAnimations.push({name:e,loopMode:t,repetitionCount:i})),typeof c=="number"&&(g.time=Math.min(Math.max(c,0),d.duration)),typeof a=="boolean"&&a?g.fadeIn(u):typeof a=="number"?g.fadeIn(Math.max(a,0)):s>=0&&(g.weight=Math.min(Math.max(s,0),1)),typeof r=="boolean"&&r?g.warp(A?p:0,n,u):typeof r=="number"?g.warp(A?p:0,n,Math.max(r,0)):g.timeScale=n,g.isRunning()||(g.time==d.duration&&g.stop(),g.setLoop(t,i),g.paused=!1,g.enabled=!0,g.clampWhenFinished=!0,g.play()),this.appendedAnimations.includes(e)||this.element[x].appendedAnimations.push(e)}catch(g){console.error(g)}}}detachAnimation(e="",t=!0){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:i}=this;if(i==null||i.length===0)return;let s=null;const n=1.5;if(e&&(s=this.animationsByName.get(e)),s!=null){typeof t=="string"&&(t.toLowerCase().trim()==="true"?t=!0:t.toLowerCase().trim()==="false"?t=!1:isNaN(t)?(t=!0,console.warn("Invalid fade value, fade is set to true")):t=parseFloat(t));try{const a=this.mixer.existingAction(s)||this.mixer.clipAction(s,this);typeof t=="boolean"&&t?a.fadeOut(n):typeof t=="number"?a.fadeOut(Math.max(t,0)):a.stop();const r=this.element[x].appendedAnimations.filter(A=>A!==e);this.element[x].appendedAnimations=r}catch(a){console.error(a)}}}updateAnimationLoop(e="",t=Js,i=1/0){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:s}=this;if(s==null||s.length===0)return;let n=null;if(e&&(n=this.animationsByName.get(e)),n!=null)try{const a=this.mixer.existingAction(n)||this.mixer.clipAction(n,this);a.stop(),a.setLoop(t,i),a.play()}catch(a){console.error(a)}}stopAnimation(){this.currentAnimationAction=null,this.mixer.stopAllAction()}updateAnimation(e){this.mixer.update(e),this.queueShadowRender()}subscribeMixerEvent(e,t){this.mixer.addEventListener(e,t)}updateShadow(){const e=this.shadow;if(e!=null){const t=this.element.arPlacement==="wall"?"back":"bottom";e.setScene(this,this.shadowSoftness,t),e.needsUpdate=!0}}renderShadow(e){const t=this.shadow;t!=null&&t.needsUpdate==!0&&(t.render(e,this),t.needsUpdate=!1)}queueShadowRender(){this.shadow!=null&&(this.shadow.needsUpdate=!0)}setShadowIntensity(e){if(this.shadowIntensity=e,this._currentGLTF!=null&&(this.setBakedShadowVisibility(),!(e<=0&&this.shadow==null))){if(this.shadow==null){const t=this.element.arPlacement==="wall"?"back":"bottom";this.shadow=new Cf(this,this.shadowSoftness,t)}this.shadow.setIntensity(e)}}setShadowSoftness(e){this.shadowSoftness=e;const t=this.shadow;t!=null&&t.setSoftness(e)}setShadowOffset(e){const t=this.shadow;t!=null&&t.setOffset(e)}getHit(e=this){return wi.intersectObject(e,!0).find(i=>i.object.visible&&!i.object.userData.noHit)}hitFromController(e,t=this){return wi.setFromXRController(e),this.getHit(t)}hitFromPoint(e,t=this){return wi.setFromCamera(e,this.getCamera()),this.getHit(t)}positionAndNormalFromPoint(e,t=this){var i;const s=this.hitFromPoint(e,t);if(s==null)return null;const n=s.point,a=s.face!=null?s.face.normal.clone().applyNormalMatrix(new xo().getNormalMatrix(s.object.matrixWorld)):wi.ray.direction.clone().multiplyScalar(-1),r=(i=s.uv)!==null&&i!==void 0?i:null;return{position:n,normal:a,uv:r}}surfaceFromPoint(e,t=this){const i=this.element.model;if(i==null)return null;const s=this.hitFromPoint(e,t);if(s==null||s.face==null)return null;const n=i[lo](s),{meshes:a,primitives:r}=n.mesh.userData.associations,A=new G,c=new G,h=new G,{a:l,b:d,c:u}=s.face,g=s.object;g.getVertexPosition(l,A),g.getVertexPosition(d,c),g.getVertexPosition(u,h);const p=new el(A,c,h),f=new G;return p.getBarycoord(g.worldToLocal(s.point),f),`${a} ${r} ${l} ${d} ${u} ${f.x.toFixed(3)} ${f.y.toFixed(3)} ${f.z.toFixed(3)}`}addHotspot(e){this.target.add(e),this.annotationRenderer.domElement.appendChild(e.element),this.updateSurfaceHotspot(e)}removeHotspot(e){this.target.remove(e)}forHotspots(e){const{children:t}=this.target;for(let i=0,s=t.length;i<s;i++){const n=t[i];n instanceof Ah&&e(n)}}updateSurfaceHotspot(e){if(e.surface==null||this.element.model==null)return;const t=st(e.surface)[0].terms;if(t.length!=8){console.warn(e.surface+" does not have exactly 8 numbers.");return}const i=this.element.model[rh](t[0].number,t[1].number);if(i==null){console.warn(e.surface+" does not match a node/primitive in this glTF! Skipping this hotspot.");return}const s=i.mesh.geometry.attributes.position.count,n=new G(t[2].number,t[3].number,t[4].number);if(n.x>=s||n.y>=s||n.z>=s){console.warn(e.surface+" vertex indices out of range in this glTF! Skipping this hotspot.");return}const a=new G(t[5].number,t[6].number,t[7].number);e.mesh=i.mesh,e.tri=n,e.bary=a,e.updateSurface()}animateSurfaceHotspots(){this.element.paused||this.forHotspots(e=>{e.updateSurface()})}updateHotspotsVisibility(e){this.forHotspots(t=>{ya.copy(e),ac.setFromMatrixPosition(t.matrixWorld),ya.sub(ac),oc.copy(t.normal).transformDirection(this.target.matrixWorld),ya.dot(oc)<0?t.hide():t.show()})}orientHotspots(e){this.forHotspots(t=>{t.orient(e)})}setHotspotsVisibility(e){this.forHotspots(t=>{t.visible=e})}updateSchema(e){var t;const{schemaElement:i,element:s}=this,{alt:n,poster:a,iosSrc:r}=s;if(e!=null){const A=[{"@type":"MediaObject",contentUrl:e,encodingFormat:((t=e.split(".").pop())===null||t===void 0?void 0:t.toLowerCase())==="gltf"?"model/gltf+json":"model/gltf-binary"}];r&&A.push({"@type":"MediaObject",contentUrl:r,encodingFormat:"model/vnd.usdz+zip"});const c={"@context":"http://schema.org/","@type":"3DModel",image:a??void 0,name:n??void 0,encoding:A};i.textContent=JSON.stringify(c),document.head.appendChild(i)}else i.parentElement!=null&&i.parentElement.removeChild(i)}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf extends EventTarget{constructor(){super(...arguments),this.ongoingActivities=new Set,this.totalProgress=0}get ongoingActivityCount(){return this.ongoingActivities.size}beginActivity(e){const t={progress:0,completed:!1};return this.ongoingActivities.add(t),this.ongoingActivityCount===1&&this.announceTotalProgress(t,0,e),i=>{let s;return s=Math.max(Ue(i,0,1),t.progress),s!==t.progress&&this.announceTotalProgress(t,s,e),t.progress}}announceTotalProgress(e,t,i){let s=0,n=0;t==1&&(e.completed=!0);for(const A of this.ongoingActivities){const{progress:c}=A;s+=1-c,A.completed&&n++}const a=e.progress;e.progress=t,this.totalProgress+=(t-a)*(1-this.totalProgress)/s;const r=n===this.ongoingActivityCount?1:this.totalProgress;this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:r,reason:i}})),n===this.ongoingActivityCount&&(this.totalProgress=0,this.ongoingActivities.clear())}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cn=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n},rc,Ac,cc,lc,hc,uc,dc,gc,pc,fc,mc,bc,Ic;const Qf=10,xf=50,Sf=0,vf=300,Tf=150,ut=document.createElement("canvas"),wa=Symbol("fallbackResizeHandler"),Ec=Symbol("defaultAriaLabel"),Qi=Symbol("resizeObserver"),Zt=Symbol("clearModelTimeout"),Qa=Symbol("onContextLost"),es=Symbol("loaded"),xa=Symbol("status"),Sa=Symbol("onFocus"),va=Symbol("onBlur"),as=Symbol("updateSize"),xi=Symbol("intersectionObserver"),Tt=Symbol("isElementInViewport"),an=Symbol("announceModelVisibility"),As=Symbol("ariaLabel"),uo=Symbol("altDefaulted"),Ds=Symbol("statusElement"),on=Symbol("updateStatus"),Vs=Symbol("loadedTime"),hs=Symbol("updateSource"),Cc=Symbol("markLoaded"),ji=Symbol("container"),Fe=Symbol("input"),go=Symbol("canvas"),x=Symbol("scene"),ne=Symbol("needsRender"),He=Symbol("tick"),qe=Symbol("onModelLoad"),rn=Symbol("onResize"),K=Symbol("renderer"),_t=Symbol("progressTracker"),Bc=Symbol("getLoaded"),Nt=Symbol("getModelIsVisible"),fs=Symbol("shouldAttemptPreload"),ht=o=>({x:o.x,y:o.y,z:o.z,toString(){return`${this.x}m ${this.y}m ${this.z}m`}}),po=o=>({u:o.x,v:o.y,toString(){return`${this.u} ${this.v}`}});class ai extends Mt{static get is(){return"model-viewer"}static set modelCacheSize(e){pe[At].evictionThreshold=e}static get modelCacheSize(){return pe[At].evictionThreshold}static set minimumRenderScale(e){e>1&&console.warn("<model-viewer> minimumRenderScale has been clamped to a maximum value of 1."),e<=0&&console.warn("<model-viewer> minimumRenderScale has been clamped to a minimum value of 0.25."),ke.singleton.minScale=e}static get minimumRenderScale(){return ke.singleton.minScale}get loaded(){return this[Bc]()}get[(rc=Tt,Ac=es,cc=Vs,lc=xa,hc=Zt,uc=wa,dc=an,gc=Qi,pc=xi,fc=_t,K)](){return ke.singleton}get modelIsVisible(){return this[Nt]()}constructor(){super(),this.alt=null,this.src=null,this.withCredentials=!1,this.generateSchema=!1,this[rc]=!1,this[Ac]=!1,this[cc]=0,this[lc]="",this[hc]=null,this[uc]=ar(()=>{const s=this.getBoundingClientRect();this[as](s)},xf),this[dc]=ar(s=>{const n=this.modelIsVisible;n!==s&&this.dispatchEvent(new CustomEvent("model-visibility",{detail:{visible:n}}))},Sf),this[gc]=null,this[pc]=null,this[fc]=new wf,this[mc]=()=>{this[Ds].textContent=this[xa]},this[bc]=()=>{this[Ds].textContent=""},this[Ic]=s=>{this.dispatchEvent(new CustomEvent("error",{detail:{type:"webglcontextlost",sourceError:s.sourceEvent}}))},this.attachShadow({mode:"open"});const e=this.shadowRoot;td(e),this[ji]=e.querySelector(".container"),this[Fe]=e.querySelector(".userInput"),this[go]=e.querySelector("canvas"),this[Ds]=e.querySelector("#status"),this[Ec]=this[Fe].getAttribute("aria-label");let t,i;if(this.isConnected){const s=this.getBoundingClientRect();t=s.width,i=s.height}else t=vf,i=Tf;this[x]=new yf({canvas:this[go],element:this,width:t,height:i}),Promise.resolve().then(()=>{this[as](this.getBoundingClientRect())}),Rn&&(this[Qi]=new ResizeObserver(s=>{if(!this[K].isPresenting)for(let n of s)n.target===this&&this[as](n.contentRect)})),Mn?this[xi]=new IntersectionObserver(s=>{for(let n of s)if(n.target===this){const a=this.modelIsVisible;this[Tt]=n.isIntersecting,this[an](a),this[Tt]&&!this.loaded&&this[hs]()}},{root:null,rootMargin:"0px",threshold:1e-5}):this[Tt]=!0}connectedCallback(){super.connectedCallback&&super.connectedCallback(),Rn?this[Qi].observe(this):self.addEventListener("resize",this[wa]),Mn&&this[xi].observe(this),this.addEventListener("focus",this[Sa]),this.addEventListener("blur",this[va]);const e=this[K];e.addEventListener("contextlost",this[Qa]),e.registerScene(this[x]),this[Zt]!=null&&(self.clearTimeout(this[Zt]),this[Zt]=null,this.requestUpdate("src",null))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),Rn?this[Qi].unobserve(this):self.removeEventListener("resize",this[wa]),Mn&&this[xi].unobserve(this),this.removeEventListener("focus",this[Sa]),this.removeEventListener("blur",this[va]);const e=this[K];e.removeEventListener("contextlost",this[Qa]),e.unregisterScene(this[x]),this[Zt]=self.setTimeout(()=>{this[x].dispose(),this[Zt]=null},Qf)}updated(e){super.updated(e),e.has("src")&&(this.src==null?(this[es]=!1,this[Vs]=0,this[x].reset()):this.src!==this[x].url&&(this[es]=!1,this[Vs]=0,this[hs]())),e.has("alt")&&this[Fe].setAttribute("aria-label",this[As]),e.has("generateSchema")&&(this.generateSchema?this[x].updateSchema(this.src):this[x].updateSchema(null))}toDataURL(e,t){return this[K].displayCanvas(this[x]).toDataURL(e,t)}async toBlob(e){const t=e?e.mimeType:void 0,i=e?e.qualityArgument:void 0,s=e?e.idealAspect:void 0,{width:n,height:a,idealAspect:r,aspect:A}=this[x],{dpr:c,scaleFactor:h}=this[K];let l=n*h*c,d=a*h*c,u=0,g=0;if(s===!0)if(r>A){const p=d;d=Math.round(l/r),g=(p-d)/2}else{const p=l;l=Math.round(d*r),u=(p-l)/2}ut.width=l,ut.height=d;try{return new Promise(async(p,f)=>{ut.getContext("2d").drawImage(this[K].displayCanvas(this[x]),u,g,l,d,0,0,l,d),ut.toBlob(m=>{if(!m)return f(new Error("Unable to retrieve canvas blob"));p(m)},t,i)})}finally{this[as]({width:n,height:a})}}registerEffectComposer(e){e.setRenderer(this[K].threeRenderer),e.setMainCamera(this[x].getCamera()),e.setMainScene(this[x]),this[x].effectRenderer=e}unregisterEffectComposer(){this[x].effectRenderer=null}registerRenderer(e){this[x].externalRenderer=e}unregisterRenderer(){this[x].externalRenderer=null}get[As](){return this[uo]}get[uo](){return this.alt==null||this.alt==="null"?this[Ec]:this.alt}[Bc](){return this[es]}[Nt](){return this.loaded&&this[Tt]}[fs](){return!!this.src&&this[Tt]}[as]({width:e,height:t}){e===0||t===0||(this[ji].style.width=`${e}px`,this[ji].style.height=`${t}px`,this[rn]({width:e,height:t}))}[He](e,t){var i;(i=this[x].effectRenderer)===null||i===void 0||i.beforeRender(e,t)}[Cc](){this[es]||(this[es]=!0,this[Vs]=performance.now())}[ne](){this[x].queueRender()}[qe](){}[on](e){this[xa]=e;const t=this.getRootNode();t!=null&&t.activeElement===this&&this[Ds].textContent!=e&&(this[Ds].textContent=e)}[(mc=Sa,bc=va,rn)](e){this[x].setSize(e.width,e.height)}async[(Ic=Qa,hs)](){const e=this[x];if(this.loaded||!this[fs]()||this.src===e.url)return;this.generateSchema&&e.updateSchema(this.src),this[on]("Loading"),e.stopAnimation();const t=this[_t].beginActivity("model-load"),i=this.src;try{const s=e.setSource(i,a=>t(Ue(a,0,1)*.95)),n=this[en]();await Promise.all([s,n]),this[Cc](),this[qe](),this.updateComplete.then(()=>{this.dispatchEvent(new CustomEvent("before-render"))}),await new Promise(a=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("load",{detail:{url:i}})),a()})})})}catch(s){this.dispatchEvent(new CustomEvent("error",{detail:{type:"loadfailure",sourceError:s}}))}finally{t(1)}}}Cn([_({type:String})],ai.prototype,"alt",void 0);Cn([_({type:String})],ai.prototype,"src",void 0);Cn([_({type:Boolean,attribute:"with-credentials"})],ai.prototype,"withCredentials",void 0);Cn([_({type:Boolean,attribute:"generate-schema"})],ai.prototype,"generateSchema",void 0);/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ta=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const yc=1e3,Si=Symbol("changeAnimation"),wc=Symbol("appendAnimation"),Qc=Symbol("detachAnimation"),Ce=Symbol("paused"),Rf={repetitions:1/0,pingpong:!1},Mf={pingpong:!1,repetitions:null,weight:1,timeScale:1,fade:!1,warp:!1,relativeWarp:!0,time:null},Df={fade:!0},Lf=o=>{var e;class t extends o{constructor(...s){super(s),this.autoplay=!1,this.animationName=void 0,this.animationCrossfadeDuration=300,this[e]=!0,this[x].subscribeMixerEvent("loop",n=>{const a=n.action._loopCount,r=n.action._clip.name,A=n.action._clip.uuid,c=this[x].markedAnimations.find(h=>h.name===r);if(c){this[x].updateAnimationLoop(c.name,c.loopMode,c.repetitionCount);const h=this[x].markedAnimations.filter(l=>l.name!==r);this[x].markedAnimations=h}this.dispatchEvent(new CustomEvent("loop",{detail:{count:a,name:r,uuid:A}}))}),this[x].subscribeMixerEvent("finished",n=>{if(!this[x].appendedAnimations.includes(n.action._clip.name))this[Ce]=!0;else{const a=this[x].appendedAnimations.filter(r=>r!==n.action._clip.name);this[x].appendedAnimations=a}this.dispatchEvent(new CustomEvent("finished"))})}get availableAnimations(){return this.loaded?this[x].animationNames:[]}get duration(){return this[x].duration}get paused(){return this[Ce]}get currentTime(){return this[x].animationTime}get appendedAnimations(){return this[x].appendedAnimations}set currentTime(s){this[x].animationTime=s,this[ne]()}get timeScale(){return this[x].animationTimeScale}set timeScale(s){this[x].animationTimeScale=s}pause(){this[Ce]||(this[Ce]=!0,this.dispatchEvent(new CustomEvent("pause")))}play(s){this.availableAnimations.length>0&&(this[Ce]=!1,this[Si](s),this.dispatchEvent(new CustomEvent("play")))}appendAnimation(s,n){this.availableAnimations.length>0&&(this[Ce]=!1,this[wc](s,n),this.dispatchEvent(new CustomEvent("append-animation")))}detachAnimation(s,n){this.availableAnimations.length>0&&(this[Ce]=!1,this[Qc](s,n),this.dispatchEvent(new CustomEvent("detach-animation")))}[(e=Ce,qe)](){super[qe](),this[Ce]=!0,this.animationName!=null&&this[Si](),this.autoplay&&this.play()}[He](s,n){super[He](s,n),!(this[Ce]||!this[Nt]()&&!this[K].isPresenting)&&(this[x].updateAnimation(n/yc),this[ne]())}updated(s){super.updated(s),s.has("autoplay")&&this.autoplay&&this.play(),s.has("animationName")&&this[Si]()}[Si](s=Rf){var n;const a=(n=s.repetitions)!==null&&n!==void 0?n:1/0,r=s.pingpong?io:a===1?Wi:Js;this[x].playAnimation(this.animationName,this.animationCrossfadeDuration/yc,r,a),this[Ce]&&(this[x].updateAnimation(0),this[ne]())}[wc](s="",n=Mf){var a;const r=(a=n.repetitions)!==null&&a!==void 0?a:1/0,A=n.pingpong?io:r===1?Wi:Js,c=!!n.repetitions||"pingpong"in n;this[x].appendAnimation(s||this.animationName,A,r,n.weight,n.timeScale,n.fade,n.warp,n.relativeWarp,n.time,c),this[Ce]&&(this[x].updateAnimation(0),this[ne]())}[Qc](s="",n=Df){this[x].detachAnimation(s||this.animationName,n.fade),this[Ce]&&(this[x].updateAnimation(0),this[ne]())}}return Ta([_({type:Boolean})],t.prototype,"autoplay",void 0),Ta([_({type:String,attribute:"animation-name"})],t.prototype,"animationName",void 0),Ta([_({type:Number,attribute:"animation-crossfade-duration"})],t.prototype,"animationCrossfadeDuration",void 0),t};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=Symbol("hotspotMap"),Ra=Symbol("mutationCallback"),Ls=Symbol("observer"),Ma=Symbol("addHotspot"),xc=Symbol("removeHotspot"),Da=new Pe,Ff=o=>{var e,t,i;class s extends o{constructor(){super(...arguments),this[e]=new Map,this[t]=a=>{a.forEach(r=>{(!(r instanceof MutationRecord)||r.type==="childList")&&(r.addedNodes.forEach(A=>{this[Ma](A)}),r.removedNodes.forEach(A=>{this[xc](A)}),this[ne]())})},this[i]=new MutationObserver(this[Ra])}connectedCallback(){super.connectedCallback();for(let r=0;r<this.children.length;++r)this[Ma](this.children[r]);const{ShadyDOM:a}=self;a==null?this[Ls].observe(this,{childList:!0}):this[Ls]=a.observeChildren(this,this[Ra])}disconnectedCallback(){super.disconnectedCallback();const{ShadyDOM:a}=self;a==null?this[Ls].disconnect():a.unobserveChildren(this[Ls])}[(e=yt,t=Ra,i=Ls,qe)](){super[qe]();const a=this[x];a.forHotspots(r=>{a.updateSurfaceHotspot(r)})}[He](a,r){super[He](a,r);const A=this[x],{annotationRenderer:c}=A,h=A.getCamera();A.shouldRender()&&(A.animateSurfaceHotspots(),A.updateHotspotsVisibility(h.position),c.domElement.style.display="",c.render(A,h))}updateHotspot(a){const r=this[yt].get(a.name);r!=null&&(r.updatePosition(a.position),r.updateNormal(a.normal),r.surface=a.surface,this[x].updateSurfaceHotspot(r),this[ne]())}queryHotspot(a){const r=this[yt].get(a);if(r==null)return null;const A=ht(r.position),c=ht(r.normal),h=r.facingCamera,l=this[x],d=l.getCamera(),u=new G;u.setFromMatrixPosition(r.matrixWorld),u.project(d);const g=l.width/2,p=l.height/2;u.x=u.x*g+g,u.y=-(u.y*p)+p;const f=ht(new G(u.x,u.y,u.z));return!Number.isFinite(f.x)||!Number.isFinite(f.y)?null:{position:A,normal:c,canvasPosition:f,facingCamera:h}}positionAndNormalFromPoint(a,r){const A=this[x],c=A.getNDC(a,r),h=A.positionAndNormalFromPoint(c);if(h==null)return null;Da.copy(A.target.matrixWorld).invert();const l=ht(h.position.applyMatrix4(Da)),d=ht(h.normal.transformDirection(Da));let u=null;return h.uv!=null&&(u=po(h.uv)),{position:l,normal:d,uv:u}}surfaceFromPoint(a,r){const A=this[x],c=A.getNDC(a,r);return A.surfaceFromPoint(c)}[Ma](a){if(!(a instanceof HTMLElement&&a.slot.indexOf("hotspot")===0))return;let r=this[yt].get(a.slot);r!=null?r.increment():(r=new Ah({name:a.slot,position:a.dataset.position,normal:a.dataset.normal,surface:a.dataset.surface}),this[yt].set(a.slot,r),this[x].addHotspot(r)),this[x].queueRender()}[xc](a){if(!(a instanceof HTMLElement))return;const r=this[yt].get(a.slot);r&&(r.decrement()&&(this[x].removeHotspot(r),this[yt].delete(a.slot)),this[x].queueRender())}}return s};/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var he=Uint8Array,Qe=Uint16Array,Lo=Int32Array,Fo=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ko=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sc=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ch=function(o,e){for(var t=new Qe(31),i=0;i<31;++i)t[i]=e+=1<<o[i-1];for(var s=new Lo(t[30]),i=1;i<30;++i)for(var n=t[i];n<t[i+1];++n)s[n]=n-t[i]<<5|i;return{b:t,r:s}},lh=ch(Fo,2),kf=lh.b,fo=lh.r;kf[28]=258,fo[258]=28;var _f=ch(ko,0),vc=_f.r,mo=new Qe(32768);for(var X=0;X<32768;++X){var ot=(X&43690)>>1|(X&21845)<<1;ot=(ot&52428)>>2|(ot&13107)<<2,ot=(ot&61680)>>4|(ot&3855)<<4,mo[X]=((ot&65280)>>8|(ot&255)<<8)>>1}var Xs=function(o,e,t){for(var i=o.length,s=0,n=new Qe(e);s<i;++s)o[s]&&++n[o[s]-1];var a=new Qe(e);for(s=1;s<e;++s)a[s]=a[s-1]+n[s-1]<<1;var r;if(t){r=new Qe(1<<e);var A=15-e;for(s=0;s<i;++s)if(o[s])for(var c=s<<4|o[s],h=e-o[s],l=a[o[s]-1]++<<h,d=l|(1<<h)-1;l<=d;++l)r[mo[l]>>A]=c}else for(r=new Qe(i),s=0;s<i;++s)o[s]&&(r[s]=mo[a[o[s]-1]++]>>15-o[s]);return r},Gt=new he(288);for(var X=0;X<144;++X)Gt[X]=8;for(var X=144;X<256;++X)Gt[X]=9;for(var X=256;X<280;++X)Gt[X]=7;for(var X=280;X<288;++X)Gt[X]=8;var An=new he(32);for(var X=0;X<32;++X)An[X]=5;var Nf=Xs(Gt,9,0),Gf=Xs(An,5,0),hh=function(o){return(o+7)/8|0},uh=function(o,e,t){return(t==null||t>o.length)&&(t=o.length),new he(o.subarray(e,t))},Uf=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Bn=function(o,e,t){var i=new Error(e||Uf[o]);if(i.code=o,Error.captureStackTrace&&Error.captureStackTrace(i,Bn),!t)throw i;return i},Ye=function(o,e,t){t<<=e&7;var i=e/8|0;o[i]|=t,o[i+1]|=t>>8},Fs=function(o,e,t){t<<=e&7;var i=e/8|0;o[i]|=t,o[i+1]|=t>>8,o[i+2]|=t>>16},La=function(o,e){for(var t=[],i=0;i<o.length;++i)o[i]&&t.push({s:i,f:o[i]});var s=t.length,n=t.slice();if(!s)return{t:gh,l:0};if(s==1){var a=new he(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(b,y){return b.f-y.f}),t.push({s:-1,f:25001});var r=t[0],A=t[1],c=0,h=1,l=2;for(t[0]={s:-1,f:r.f+A.f,l:r,r:A};h!=s-1;)r=t[t[c].f<t[l].f?c++:l++],A=t[c!=h&&t[c].f<t[l].f?c++:l++],t[h++]={s:-1,f:r.f+A.f,l:r,r:A};for(var d=n[0].s,i=1;i<s;++i)n[i].s>d&&(d=n[i].s);var u=new Qe(d+1),g=bo(t[h-1],u,0);if(g>e){var i=0,p=0,f=g-e,m=1<<f;for(n.sort(function(y,w){return u[w.s]-u[y.s]||y.f-w.f});i<s;++i){var I=n[i].s;if(u[I]>e)p+=m-(1<<g-u[I]),u[I]=e;else break}for(p>>=f;p>0;){var C=n[i].s;u[C]<e?p-=1<<e-u[C]++-1:++i}for(;i>=0&&p;--i){var E=n[i].s;u[E]==e&&(--u[E],++p)}g=e}return{t:new he(u),l:g}},bo=function(o,e,t){return o.s==-1?Math.max(bo(o.l,e,t+1),bo(o.r,e,t+1)):e[o.s]=t},Tc=function(o){for(var e=o.length;e&&!o[--e];);for(var t=new Qe(++e),i=0,s=o[0],n=1,a=function(A){t[i++]=A},r=1;r<=e;++r)if(o[r]==s&&r!=e)++n;else{if(!s&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(s),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(s);n=1,s=o[r]}return{c:t.subarray(0,i),n:e}},ks=function(o,e){for(var t=0,i=0;i<e.length;++i)t+=o[i]*e[i];return t},dh=function(o,e,t){var i=t.length,s=hh(e+2);o[s]=i&255,o[s+1]=i>>8,o[s+2]=o[s]^255,o[s+3]=o[s+1]^255;for(var n=0;n<i;++n)o[s+n+4]=t[n];return(s+4+i)*8},Rc=function(o,e,t,i,s,n,a,r,A,c,h){Ye(e,h++,t),++s[256];for(var l=La(s,15),d=l.t,u=l.l,g=La(n,15),p=g.t,f=g.l,m=Tc(d),I=m.c,C=m.n,E=Tc(p),b=E.c,y=E.n,w=new Qe(19),B=0;B<I.length;++B)++w[I[B]&31];for(var B=0;B<b.length;++B)++w[b[B]&31];for(var Q=La(w,7),S=Q.t,R=Q.l,D=19;D>4&&!S[Sc[D-1]];--D);var k=c+5<<3,v=ks(s,Gt)+ks(n,An)+a,M=ks(s,d)+ks(n,p)+a+14+3*D+ks(w,S)+2*w[16]+3*w[17]+7*w[18];if(A>=0&&k<=v&&k<=M)return dh(e,h,o.subarray(A,A+c));var L,F,q,H;if(Ye(e,h,1+(M<v)),h+=2,M<v){L=Xs(d,u,0),F=d,q=Xs(p,f,0),H=p;var J=Xs(S,R,0);Ye(e,h,C-257),Ye(e,h+5,y-1),Ye(e,h+10,D-4),h+=14;for(var B=0;B<D;++B)Ye(e,h+3*B,S[Sc[B]]);h+=3*D;for(var $=[I,b],V=0;V<2;++V)for(var Y=$[V],B=0;B<Y.length;++B){var ue=Y[B]&31;Ye(e,h,J[ue]),h+=S[ue],ue>15&&(Ye(e,h,Y[B]>>5&127),h+=Y[B]>>12)}}else L=Nf,F=Gt,q=Gf,H=An;for(var B=0;B<r;++B){var Ae=i[B];if(Ae>255){var ue=Ae>>18&31;Fs(e,h,L[ue+257]),h+=F[ue+257],ue>7&&(Ye(e,h,Ae>>23&31),h+=Fo[ue]);var Pt=Ae&31;Fs(e,h,q[Pt]),h+=H[Pt],Pt>3&&(Fs(e,h,Ae>>5&8191),h+=ko[Pt])}else Fs(e,h,L[Ae]),h+=F[Ae]}return Fs(e,h,L[256]),h+F[256]},Of=new Lo([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gh=new he(0),Pf=function(o,e,t,i,s,n){var a=n.z||o.length,r=new he(i+a+5*(1+Math.ceil(a/7e3))+s),A=r.subarray(i,r.length-s),c=n.l,h=(n.r||0)&7;if(e){h&&(A[0]=n.r>>3);for(var l=Of[e-1],d=l>>13,u=l&8191,g=(1<<t)-1,p=n.p||new Qe(32768),f=n.h||new Qe(g+1),m=Math.ceil(t/3),I=2*m,C=function(Qn){return(o[Qn]^o[Qn+1]<<m^o[Qn+2]<<I)&g},E=new Lo(25e3),b=new Qe(288),y=new Qe(32),w=0,B=0,Q=n.i||0,S=0,R=n.w||0,D=0;Q+2<a;++Q){var k=C(Q),v=Q&32767,M=f[k];if(p[v]=M,f[k]=v,R<=Q){var L=a-Q;if((w>7e3||S>24576)&&(L>423||!c)){h=Rc(o,A,0,E,b,y,B,S,D,Q-D,h),S=w=B=0,D=Q;for(var F=0;F<286;++F)b[F]=0;for(var F=0;F<30;++F)y[F]=0}var q=2,H=0,J=u,$=v-M&32767;if(L>2&&k==C(Q-$))for(var V=Math.min(d,L)-1,Y=Math.min(32767,Q),ue=Math.min(258,L);$<=Y&&--J&&v!=M;){if(o[Q+q]==o[Q+q-$]){for(var Ae=0;Ae<ue&&o[Q+Ae]==o[Q+Ae-$];++Ae);if(Ae>q){if(q=Ae,H=$,Ae>V)break;for(var Pt=Math.min($,Ae-2),_o=0,F=0;F<Pt;++F){var yn=Q-$+F&32767,Bh=p[yn],No=yn-Bh&32767;No>_o&&(_o=No,M=yn)}}}v=M,M=p[v],$+=v-M&32767}if(H){E[S++]=268435456|fo[q]<<18|vc[H];var Go=fo[q]&31,Uo=vc[H]&31;B+=Fo[Go]+ko[Uo],++b[257+Go],++y[Uo],R=Q+q,++w}else E[S++]=o[Q],++b[o[Q]]}}for(Q=Math.max(Q,R);Q<a;++Q)E[S++]=o[Q],++b[o[Q]];h=Rc(o,A,c,E,b,y,B,S,D,Q-D,h),c||(n.r=h&7|A[h/8|0]<<3,h-=7,n.h=f,n.p=p,n.i=Q,n.w=R)}else{for(var Q=n.w||0;Q<a+c;Q+=65535){var wn=Q+65535;wn>=a&&(A[h/8|0]=c,wn=a),h=dh(A,h+1,o.subarray(Q,wn))}n.i=a}return uh(r,0,i+hh(h)+s)},Hf=function(){for(var o=new Int32Array(256),e=0;e<256;++e){for(var t=e,i=9;--i;)t=(t&1&&-306674912)^t>>>1;o[e]=t}return o}(),qf=function(){var o=-1;return{p:function(e){for(var t=o,i=0;i<e.length;++i)t=Hf[t&255^e[i]]^t>>>8;o=t},d:function(){return~o}}},jf=function(o,e,t,i,s){if(!s&&(s={l:1},e.dictionary)){var n=e.dictionary.subarray(-32768),a=new he(n.length+o.length);a.set(n),a.set(o,n.length),o=a,s.w=n.length}return Pf(o,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(o.length)))*1.5):20:12+e.mem,t,i,s)},ph=function(o,e){var t={};for(var i in o)t[i]=o[i];for(var i in e)t[i]=e[i];return t},ae=function(o,e,t){for(;t;++e)o[e]=t,t>>>=8};function $f(o,e){return jf(o,e||{},0,0)}var fh=function(o,e,t,i){for(var s in o){var n=o[s],a=e+s,r=i;Array.isArray(n)&&(r=ph(i,n[1]),n=n[0]),n instanceof he?t[a]=[n,r]:(t[a+="/"]=[new he(0),r],fh(n,a,t,i))}},Mc=typeof TextEncoder<"u"&&new TextEncoder,Vf=typeof TextDecoder<"u"&&new TextDecoder,zf=0;try{Vf.decode(gh,{stream:!0}),zf=1}catch{}function cn(o,e){var t;if(Mc)return Mc.encode(o);for(var i=o.length,s=new he(o.length+(o.length>>1)),n=0,a=function(c){s[n++]=c},t=0;t<i;++t){if(n+5>s.length){var r=new he(n+8+(i-t<<1));r.set(s),s=r}var A=o.charCodeAt(t);A<128||e?a(A):A<2048?(a(192|A>>6),a(128|A&63)):A>55295&&A<57344?(A=65536+(A&1047552)|o.charCodeAt(++t)&1023,a(240|A>>18),a(128|A>>12&63),a(128|A>>6&63),a(128|A&63)):(a(224|A>>12),a(128|A>>6&63),a(128|A&63))}return uh(s,0,n)}var Io=function(o){var e=0;if(o)for(var t in o){var i=o[t].length;i>65535&&Bn(9),e+=i+4}return e},Dc=function(o,e,t,i,s,n,a,r){var A=i.length,c=t.extra,h=r&&r.length,l=Io(c);ae(o,e,a!=null?33639248:67324752),e+=4,a!=null&&(o[e++]=20,o[e++]=t.os),o[e]=20,e+=2,o[e++]=t.flag<<1|(n<0&&8),o[e++]=s&&8,o[e++]=t.compression&255,o[e++]=t.compression>>8;var d=new Date(t.mtime==null?Date.now():t.mtime),u=d.getFullYear()-1980;if((u<0||u>119)&&Bn(10),ae(o,e,u<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),e+=4,n!=-1&&(ae(o,e,t.crc),ae(o,e+4,n<0?-n-2:n),ae(o,e+8,t.size)),ae(o,e+12,A),ae(o,e+14,l),e+=16,a!=null&&(ae(o,e,h),ae(o,e+6,t.attrs),ae(o,e+10,a),e+=14),o.set(i,e),e+=A,l)for(var g in c){var p=c[g],f=p.length;ae(o,e,+g),ae(o,e+2,f),o.set(p,e+4),e+=4+f}return h&&(o.set(r,e),e+=h),e},Kf=function(o,e,t,i,s){ae(o,e,101010256),ae(o,e+8,t),ae(o,e+10,t),ae(o,e+12,i),ae(o,e+16,s)};function Jf(o,e){e||(e={});var t={},i=[];fh(o,"",t,e);var s=0,n=0;for(var a in t){var r=t[a],A=r[0],c=r[1],h=c.level==0?0:8,l=cn(a),d=l.length,u=c.comment,g=u&&cn(u),p=g&&g.length,f=Io(c.extra);d>65535&&Bn(11);var m=h?$f(A,c):A,I=m.length,C=qf();C.p(A),i.push(ph(c,{size:A.length,crc:C.d(),c:m,f:l,m:g,u:d!=a.length||g&&u.length!=p,o:s,compression:h})),s+=30+d+f+I,n+=76+2*(d+f)+(p||0)+I}for(var E=new he(n+22),b=s,y=n-s,w=0;w<i.length;++w){var l=i[w];Dc(E,l.o,l,l.f,l.u,l.c.length);var B=30+l.f.length+Io(l.extra);E.set(l.c,l.o+B),Dc(E,s,l,l.f,l.u,l.c.length,l.o,l.m),s+=16+B+(l.m?l.m.length:0)}return Kf(E,s,i.length,y,b),E}class Be{constructor(e,t="",i=[],s=[]){this.name=e,this.type=t,this.metadata=i,this.properties=s,this.children=[]}addMetadata(e,t){this.metadata.push({key:e,value:t})}addProperty(e,t=[]){this.properties.push({property:e,metadata:t})}addChild(e){this.children.push(e)}toString(e=0){const t="	".repeat(e),i=this.metadata.map(h=>{const l=h.key,d=h.value;if(Array.isArray(d)){const u=[];return u.push(`${l} = {`),d.forEach(g=>{u.push(`${t}		${g}`)}),u.push(`${t}	}`),u.join(`
`)}else return`${l} = ${d}`}),s=i.length?` (
${i.map(h=>`${t}	${h}`).join(`
`)}
${t})`:"",n=this.properties.map(h=>{const l=h.property,d=h.metadata.length?` (
${h.metadata.map(u=>`${t}		${u}`).join(`
`)}
${t}	)`:"";return`${t}	${l}${d}`}),a=this.children.map(h=>h.toString(e+1)),r=[];if(n.length>0&&r.push(...n),a.length>0){n.length>0&&r.push("");for(let h=0;h<a.length;h++)r.push(a[h]),h<a.length-1&&r.push("")}const A=r.join(`
`),c=this.type?this.type+" ":"";return`${t}def ${c}"${this.name}"${s}
${t}{
${A}
${t}}`}}class Yf{constructor(){this.textureUtils=null}setTextureUtils(e){this.textureUtils=e}parse(e,t,i,s){this.parseAsync(e,s).then(t).catch(i)}async parseAsync(e,t={}){t=Object.assign({ar:{anchoring:{type:"plane"},planeAnchoring:{alignment:"horizontal"}},includeAnchoringProperties:!0,onlyVisible:!0,quickLookCompatible:!1,maxTextureSize:1024},t);const i=new Set,s={},n="model.usda";s[n]=null;const a=new Be("Root","Xform"),r=new Be("Scenes","Scope");r.addMetadata("kind",'"sceneLibrary"'),a.addChild(r);const A="Scene",c=new Be(A,"Xform");c.addMetadata("customData",["bool preliminary_collidesWithEnvironment = 0",`string sceneName = "${A}"`]),c.addMetadata("sceneName",`"${A}"`),t.includeAnchoringProperties&&(c.addProperty(`token preliminary:anchoring:type = "${t.ar.anchoring.type}"`),c.addProperty(`token preliminary:planeAnchoring:alignment = "${t.ar.planeAnchoring.alignment}"`)),r.addChild(c);let h;const l={},d={};Ih(e,c,l,i,s,t);const u=nm(l,d,t.quickLookCompatible);h=bh()+`
`+a.toString()+`

`+u.toString(),s[n]=cn(h),h=null;for(const p in d){let f=d[p];if(f.isCompressedTexture===!0){if(this.textureUtils===null)throw new Error("THREE.USDZExporter: setTextureUtils() must be called to process compressed textures.");f=await this.textureUtils.decompress(f)}const m=Wf(f.image,f.flipY,t.maxTextureSize),I=await new Promise(C=>m.toBlob(C,"image/png",1));s[`textures/Texture_${p}.png`]=new Uint8Array(await I.arrayBuffer())}let g=0;for(const p in s){const f=s[p],m=34+p.length;g+=m;const I=g&63;if(I!==4){const C=64-I,E=new Uint8Array(C);s[p]=[f,{extra:{12345:E}}]}g=f.length}return Jf(s,{level:0})}}function mh(o,e){let t=o.name;return t=t.replace(/[^A-Za-z0-9_]/g,""),/^[0-9]/.test(t)&&(t="_"+t),t===""&&(o.isCamera?t="Camera":t="Object"),e.has(t)&&(t=t+"_"+o.id),e.add(t),t}function Wf(o,e,t){if(typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas||typeof ImageBitmap<"u"&&o instanceof ImageBitmap){const i=t/Math.max(o.width,o.height),s=document.createElement("canvas");s.width=o.width*Math.min(1,i),s.height=o.height*Math.min(1,i);const n=s.getContext("2d");return e===!0&&(n.translate(0,s.height),n.scale(1,-1)),n.drawImage(o,0,0,s.width,s.height),s}else throw new Error("THREE.USDZExporter: No valid image data found. Unable to process texture.")}const be=7;function bh(){return`#usda 1.0
(
	customLayerData = {
		string creator = "Three.js USDZExporter"
	}
	defaultPrim = "Root"
	metersPerUnit = 1
	upAxis = "Y"
)
`}function Ih(o,e,t,i,s,n){for(let a=0,r=o.children.length;a<r;a++){const A=o.children[a];if(A.visible===!1&&n.onlyVisible===!0)continue;let c;if(A.isMesh){const h=A.geometry,l=A.material;if(l.isMeshStandardMaterial){const d="geometries/Geometry_"+h.id+".usda";if(!(d in s)){const u=Zf(h);s[d]=cn(bh()+`
`+u.toString())}l.uuid in t||(t[l.uuid]=l),c=Xf(A,h,t[l.uuid],i)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",A)}else A.isCamera?c=rm(A,i):c=Eh(A,i);c&&(e.addChild(c),Ih(A,c,t,i,s,n))}}function Eh(o,e){const t=mh(o,e),i=Ch(o.matrix);o.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",o);const s=new Be(t,"Xform");return s.addProperty(`matrix4d xformOp:transform = ${i}`),s.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]'),s}function Xf(o,e,t,i){const s=Eh(o,i);return s.addMetadata("prepend references",`@./geometries/Geometry_${e.id}.usda@</Geometry>`),s.addMetadata("prepend apiSchemas",'["MaterialBindingAPI"]'),s.addProperty(`rel material:binding = </Materials/Material_${t.id}>`),s}function Ch(o){const e=o.elements;return`( ${vi(e,0)}, ${vi(e,4)}, ${vi(e,8)}, ${vi(e,12)} )`}function vi(o,e){return`(${o[e+0]}, ${o[e+1]}, ${o[e+2]}, ${o[e+3]})`}function Zf(o){const e=new Be("Geometry"),t=em(o);return e.addChild(t),e}function em(o){const e="Geometry",t=o.attributes,i=t.position.count,s=new Be(e,"Mesh");s.addProperty(`int[] faceVertexCounts = [${tm(o)}]`),s.addProperty(`int[] faceVertexIndices = [${sm(o)}]`),s.addProperty(`normal3f[] normals = [${Fa(t.normal,i)}]`,['interpolation = "vertex"']),s.addProperty(`point3f[] points = [${Fa(t.position,i)}]`);for(let a=0;a<4;a++){const r=a>0?a:"",A=t["uv"+r];A!==void 0&&s.addProperty(`texCoord2f[] primvars:st${r} = [${im(A)}]`,['interpolation = "vertex"'])}const n=t.color;return n!==void 0&&s.addProperty(`color3f[] primvars:displayColor = [${Fa(n,i)}]`,['interpolation = "vertex"']),s.addProperty('uniform token subdivisionScheme = "none"'),s}function tm(o){const e=o.index!==null?o.index.count:o.attributes.position.count;return Array(e/3).fill(3).join(", ")}function sm(o){const e=o.index,t=[];if(e!==null)for(let i=0;i<e.count;i++)t.push(e.getX(i));else{const i=o.attributes.position.count;for(let s=0;s<i;s++)t.push(s)}return t.join(", ")}function Fa(o,e){if(o===void 0)return console.warn("USDZExporter: Normals missing."),Array(e).fill("(0, 0, 0)").join(", ");const t=[];for(let i=0;i<o.count;i++){const s=o.getX(i),n=o.getY(i),a=o.getZ(i);t.push(`(${s.toPrecision(be)}, ${n.toPrecision(be)}, ${a.toPrecision(be)})`)}return t.join(", ")}function im(o){const e=[];for(let t=0;t<o.count;t++){const i=o.getX(t),s=o.getY(t);e.push(`(${i.toPrecision(be)}, ${1-s.toPrecision(be)})`)}return e.join(", ")}function nm(o,e,t=!1){const i=new Be("Materials");for(const s in o){const n=o[s];i.addChild(am(n,e,t))}return i}function am(o,e,t=!1){const i=new Be(`Material_${o.id}`,"Material");function s(a,r,A){const c=a.source.id+"_"+a.flipY;e[c]=a;const h=a.channel>0?"st"+a.channel:"st",l={1e3:"repeat",1001:"clamp",1002:"mirror"},d=a.repeat.clone(),u=a.offset.clone(),g=a.rotation,p=Math.sin(g),f=Math.cos(g);u.y=1-u.y-d.y,t?(u.x=u.x/d.x,u.y=u.y/d.y,u.x+=p/d.x,u.y+=f-1):(u.x+=p*d.x,u.y+=(1-f)*d.y);const m=new Be(`PrimvarReader_${r}`,"Shader");m.addProperty('uniform token info:id = "UsdPrimvarReader_float2"'),m.addProperty("float2 inputs:fallback = (0.0, 0.0)"),m.addProperty(`token inputs:varname = "${h}"`),m.addProperty("float2 outputs:result");const I=new Be(`Transform2d_${r}`,"Shader");I.addProperty('uniform token info:id = "UsdTransform2d"'),I.addProperty(`token inputs:in.connect = </Materials/Material_${o.id}/PrimvarReader_${r}.outputs:result>`),I.addProperty(`float inputs:rotation = ${(g*(180/Math.PI)).toFixed(be)}`),I.addProperty(`float2 inputs:scale = ${Fc(d)}`),I.addProperty(`float2 inputs:translation = ${Fc(u)}`),I.addProperty("float2 outputs:result");const C=new Be(`Texture_${a.id}_${r}`,"Shader");return C.addProperty('uniform token info:id = "UsdUVTexture"'),C.addProperty(`asset inputs:file = @textures/Texture_${c}.png@`),C.addProperty(`float2 inputs:st.connect = </Materials/Material_${o.id}/Transform2d_${r}.outputs:result>`),A!==void 0&&C.addProperty(`float4 inputs:scale = ${om(A)}`),C.addProperty(`token inputs:sourceColorSpace = "${a.colorSpace===Yi?"raw":"sRGB"}"`),C.addProperty(`token inputs:wrapS = "${l[a.wrapS]}"`),C.addProperty(`token inputs:wrapT = "${l[a.wrapT]}"`),C.addProperty("float outputs:r"),C.addProperty("float outputs:g"),C.addProperty("float outputs:b"),C.addProperty("float3 outputs:rgb"),(o.transparent||o.alphaTest>0)&&C.addProperty("float outputs:a"),[m,I,C]}o.side===it&&console.warn("THREE.USDZExporter: USDZ does not support double sided materials",o);const n=new Be("PreviewSurface","Shader");if(n.addProperty('uniform token info:id = "UsdPreviewSurface"'),o.map!==null?(n.addProperty(`color3f inputs:diffuseColor.connect = </Materials/Material_${o.id}/Texture_${o.map.id}_diffuse.outputs:rgb>`),o.transparent?n.addProperty(`float inputs:opacity.connect = </Materials/Material_${o.id}/Texture_${o.map.id}_diffuse.outputs:a>`):o.alphaTest>0&&(n.addProperty(`float inputs:opacity.connect = </Materials/Material_${o.id}/Texture_${o.map.id}_diffuse.outputs:a>`),n.addProperty(`float inputs:opacityThreshold = ${o.alphaTest}`)),s(o.map,"diffuse",o.color).forEach(r=>i.addChild(r))):n.addProperty(`color3f inputs:diffuseColor = ${Lc(o.color)}`),o.emissiveMap!==null){n.addProperty(`color3f inputs:emissiveColor.connect = </Materials/Material_${o.id}/Texture_${o.emissiveMap.id}_emissive.outputs:rgb>`);const a=new oe(o.emissive.r*o.emissiveIntensity,o.emissive.g*o.emissiveIntensity,o.emissive.b*o.emissiveIntensity);s(o.emissiveMap,"emissive",a).forEach(A=>i.addChild(A))}else o.emissive.getHex()>0&&n.addProperty(`color3f inputs:emissiveColor = ${Lc(o.emissive)}`);if(o.normalMap!==null&&(n.addProperty(`normal3f inputs:normal.connect = </Materials/Material_${o.id}/Texture_${o.normalMap.id}_normal.outputs:rgb>`),s(o.normalMap,"normal").forEach(r=>i.addChild(r))),o.aoMap!==null){n.addProperty(`float inputs:occlusion.connect = </Materials/Material_${o.id}/Texture_${o.aoMap.id}_occlusion.outputs:r>`);const a=new oe(o.aoMapIntensity,o.aoMapIntensity,o.aoMapIntensity);s(o.aoMap,"occlusion",a).forEach(A=>i.addChild(A))}if(o.roughnessMap!==null){n.addProperty(`float inputs:roughness.connect = </Materials/Material_${o.id}/Texture_${o.roughnessMap.id}_roughness.outputs:g>`);const a=new oe(o.roughness,o.roughness,o.roughness);s(o.roughnessMap,"roughness",a).forEach(A=>i.addChild(A))}else n.addProperty(`float inputs:roughness = ${o.roughness}`);if(o.metalnessMap!==null){n.addProperty(`float inputs:metallic.connect = </Materials/Material_${o.id}/Texture_${o.metalnessMap.id}_metallic.outputs:b>`);const a=new oe(o.metalness,o.metalness,o.metalness);s(o.metalnessMap,"metallic",a).forEach(A=>i.addChild(A))}else n.addProperty(`float inputs:metallic = ${o.metalness}`);if(o.alphaMap!==null?(n.addProperty(`float inputs:opacity.connect = </Materials/Material_${o.id}/Texture_${o.alphaMap.id}_opacity.outputs:r>`),n.addProperty("float inputs:opacityThreshold = 0.0001"),s(o.alphaMap,"opacity").forEach(r=>i.addChild(r))):n.addProperty(`float inputs:opacity = ${o.opacity}`),o.isMeshPhysicalMaterial){if(o.clearcoatMap!==null){n.addProperty(`float inputs:clearcoat.connect = </Materials/Material_${o.id}/Texture_${o.clearcoatMap.id}_clearcoat.outputs:r>`);const a=new oe(o.clearcoat,o.clearcoat,o.clearcoat);s(o.clearcoatMap,"clearcoat",a).forEach(A=>i.addChild(A))}else n.addProperty(`float inputs:clearcoat = ${o.clearcoat}`);if(o.clearcoatRoughnessMap!==null){n.addProperty(`float inputs:clearcoatRoughness.connect = </Materials/Material_${o.id}/Texture_${o.clearcoatRoughnessMap.id}_clearcoatRoughness.outputs:g>`);const a=new oe(o.clearcoatRoughness,o.clearcoatRoughness,o.clearcoatRoughness);s(o.clearcoatRoughnessMap,"clearcoatRoughness",a).forEach(A=>i.addChild(A))}else n.addProperty(`float inputs:clearcoatRoughness = ${o.clearcoatRoughness}`);n.addProperty(`float inputs:ior = ${o.ior}`)}return n.addProperty("int inputs:useSpecularWorkflow = 0"),n.addProperty("token outputs:surface"),i.addChild(n),i.addProperty(`token outputs:surface.connect = </Materials/Material_${o.id}/PreviewSurface.outputs:surface>`),i}function Lc(o){return`(${o.r}, ${o.g}, ${o.b})`}function om(o){return`(${o.r}, ${o.g}, ${o.b}, 1.0)`}function Fc(o){return`(${o.x}, ${o.y})`}function rm(o,e){const t=mh(o,e),i=Ch(o.matrix);o.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",o);const s=new Be(t,"Camera");s.addProperty(`matrix4d xformOp:transform = ${i}`),s.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]');const n=o.isOrthographicCamera?"orthographic":"perspective";s.addProperty(`token projection = "${n}"`);const a=`(${o.near.toPrecision(be)}, ${o.far.toPrecision(be)})`;s.addProperty(`float2 clippingRange = ${a}`);let r;o.isOrthographicCamera?r=((Math.abs(o.left)+Math.abs(o.right))*10).toPrecision(be):r=o.getFilmWidth().toPrecision(be),s.addProperty(`float horizontalAperture = ${r}`);let A;if(o.isOrthographicCamera?A=((Math.abs(o.top)+Math.abs(o.bottom))*10).toPrecision(be):A=o.getFilmHeight().toPrecision(be),s.addProperty(`float verticalAperture = ${A}`),o.isPerspectiveCamera){const c=o.getFocalLength().toPrecision(be);s.addProperty(`float focalLength = ${c}`);const h=o.focus.toPrecision(be);s.addProperty(`float focusDistance = ${h}`)}return s}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am=o=>e=>{try{const t=st(e),i=(t.length?t[0].terms:[]).filter(s=>s&&s.type==="ident").map(s=>s.value).filter(s=>o.indexOf(s)>-1);return new Set(i)}catch{}return new Set};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};let kc=!1,_c=!1;const Nc="#model-viewer-no-ar-fallback",cm=Am(["quick-look","scene-viewer","webxr","none"]),lm="webxr scene-viewer quick-look",Se={QUICK_LOOK:"quick-look",SCENE_VIEWER:"scene-viewer",WEBXR:"webxr",NONE:"none"},We=Symbol("arButtonContainer"),Gc=Symbol("enterARWithWebXR"),Uc=Symbol("openSceneViewer"),Oc=Symbol("openIOSARQuickLook"),hm=Symbol("canActivateAR"),Ti=Symbol("arMode"),ka=Symbol("arModes"),ts=Symbol("arAnchor"),Ri=Symbol("preload"),Mi=Symbol("onARButtonContainerClick"),_a=Symbol("onARStatus"),Na=Symbol("onARTracking"),Ga=Symbol("onARTap"),_s=Symbol("selectARMode"),Ua=Symbol("triggerLoad"),um=o=>{var e,t,i,s,n,a,r,A,c,h;class l extends o{constructor(){super(...arguments),this.ar=!1,this.arScale="auto",this.arUsdzMaxTextureSize="auto",this.arPlacement="floor",this.arModes=lm,this.iosSrc=null,this.xrEnvironment=!1,this[e]=!1,this[t]=this.shadowRoot.querySelector(".ar-button"),this[i]=document.createElement("a"),this[s]=new Set,this[n]=Se.NONE,this[a]=!1,this[r]=u=>{u.preventDefault(),this.activateAR()},this[A]=({status:u})=>{(u===lt.NOT_PRESENTING||this[K].arRenderer.presentedScene===this[x])&&(this.setAttribute("ar-status",u),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:u}})),u===lt.NOT_PRESENTING?this.removeAttribute("ar-tracking"):u===lt.SESSION_STARTED&&this.setAttribute("ar-tracking",ro.TRACKING))},this[c]=({status:u})=>{this.setAttribute("ar-tracking",u),this.dispatchEvent(new CustomEvent("ar-tracking",{detail:{status:u}}))},this[h]=u=>{u.data=="_apple_ar_quicklook_button_tapped"&&this.dispatchEvent(new CustomEvent("quick-look-button-tapped"))}}get canActivateAR(){return this[Ti]!==Se.NONE}connectedCallback(){super.connectedCallback(),this[K].arRenderer.addEventListener("status",this[_a]),this.setAttribute("ar-status",lt.NOT_PRESENTING),this[K].arRenderer.addEventListener("tracking",this[Na]),this[ts].addEventListener("message",this[Ga])}disconnectedCallback(){super.disconnectedCallback(),this[K].arRenderer.removeEventListener("status",this[_a]),this[K].arRenderer.removeEventListener("tracking",this[Na]),this[ts].removeEventListener("message",this[Ga])}update(u){super.update(u),u.has("arScale")&&(this[x].canScale=this.arScale!=="fixed"),u.has("arPlacement")&&(this[x].updateShadow(),this[ne]()),u.has("arModes")&&(this[ka]=cm(this.arModes)),(u.has("ar")||u.has("arModes")||u.has("src")||u.has("iosSrc")||u.has("arUsdzMaxTextureSize"))&&this[_s]()}async activateAR(){switch(this[Ti]){case Se.QUICK_LOOK:await this[Oc]();break;case Se.WEBXR:await this[Gc]();break;case Se.SCENE_VIEWER:this[Uc]();break;default:console.warn("No AR Mode can be activated. This is probably due to missing configuration or device capabilities");break}}async[(e=hm,t=We,i=ts,s=ka,n=Ti,a=Ri,r=Mi,A=_a,c=Na,h=Ga,_s)](){var u;let g=Se.NONE;if(this.ar){if(this.src!=null)for(const p of this[ka]){if(p==="webxr"&&ll&&!kc&&await this[K].arRenderer.supportsPresentation()){g=Se.WEBXR;break}if(p==="scene-viewer"&&!_c&&(Ou||navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&(!((u=(await navigator.userAgentData.getHighEntropyValues(["formFactor"])).formFactor)===null||u===void 0)&&u.includes("XR")))){g=Se.SCENE_VIEWER;break}if(p==="quick-look"&&ir){g=Se.QUICK_LOOK;break}}g===Se.NONE&&this.iosSrc!=null&&ir&&(g=Se.QUICK_LOOK)}if(g!==Se.NONE)this[We].classList.add("enabled"),this[We].addEventListener("click",this[Mi]);else if(this[We].classList.contains("enabled")){this[We].removeEventListener("click",this[Mi]),this[We].classList.remove("enabled");const p=lt.FAILED;this.setAttribute("ar-status",p),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:p}}))}this[Ti]=g}async[Gc](){console.log("Attempting to present in AR with WebXR..."),await this[Ua]();try{this[We].removeEventListener("click",this[Mi]);const{arRenderer:u}=this[K];u.placeOnWall=this.arPlacement==="wall",await u.present(this[x],this.xrEnvironment)}catch(u){console.warn("Error while trying to present in AR with WebXR"),console.error(u),await this[K].arRenderer.stopPresenting(),kc=!0,console.warn("Falling back to next ar-mode"),await this[_s](),this.activateAR()}finally{this[_s]()}}async[Ua](){this.loaded||(this[Ri]=!0,this[hs](),await $u(this,"load"),this[Ri]=!1)}[fs](){return super[fs]()||this[Ri]}[Uc](){const u=self.location.toString(),g=new URL(u),p=new URL(this.src,u);p.hash&&(p.hash="");const f=new URLSearchParams(p.search);if(g.hash=Nc,f.set("mode","ar_preferred"),f.has("disable_occlusion")||f.set("disable_occlusion","true"),this.arScale==="fixed"&&f.set("resizable","false"),this.arPlacement==="wall"&&f.set("enable_vertical_placement","true"),f.has("sound")){const C=new URL(f.get("sound"),u);f.set("sound",C.toString())}if(f.has("link")){const C=new URL(f.get("link"),u);f.set("link",C.toString())}const m=`intent://arvr.google.com/scene-viewer/1.2?${f.toString()+"&file="+encodeURIComponent(p.toString())}#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=${encodeURIComponent(g.toString())};end;`,I=()=>{self.location.hash===Nc&&(_c=!0,self.history.back(),console.warn("Error while trying to present in AR with Scene Viewer"),console.warn("Falling back to next ar-mode"),this[_s]())};self.addEventListener("hashchange",I,{once:!0}),this[ts].setAttribute("href",m),console.log("Attempting to present in AR with Scene Viewer..."),this[ts].click()}async[Oc](){const u=!this.iosSrc;this[We].classList.remove("enabled");const g=u?await this.prepareUSDZ():this.iosSrc,p=new URL(g,self.location.toString());if(u){const I=self.location.toString(),C=new URL(I),E=new URL(this.src,C);E.hash&&(p.hash=E.hash)}this.arScale==="fixed"&&(p.hash&&(p.hash+="&"),p.hash+="allowsContentScaling=0");const f=this[ts];f.setAttribute("rel","ar");const m=document.createElement("img");f.appendChild(m),f.setAttribute("href",p.toString()),u&&f.setAttribute("download","model.usdz"),f.style.display="none",f.isConnected||this.shadowRoot.appendChild(f),console.log("Attempting to present in AR with Quick Look..."),f.click(),f.removeChild(m),u&&URL.revokeObjectURL(g),this[We].classList.add("enabled")}async prepareUSDZ(){const u=this[_t].beginActivity("usdz-conversion");await this[Ua]();const{model:g,shadow:p,target:f}=this[x];if(g==null)return"";let m=!1;p!=null&&(m=p.visible,p.visible=!1),u(.2);const I=new Yf;f.remove(g),g.position.copy(f.position),g.updateWorldMatrix(!1,!0);const C=await I.parseAsync(g,{maxTextureSize:isNaN(this.arUsdzMaxTextureSize)?1/0:Math.max(parseInt(this.arUsdzMaxTextureSize),16)});g.position.set(0,0,0),f.add(g);const E=new Blob([C],{type:"model/vnd.usdz+zip"}),b=URL.createObjectURL(E);return u(1),p!=null&&(p.visible=m),b}}return wt([_({type:Boolean,attribute:"ar"})],l.prototype,"ar",void 0),wt([_({type:String,attribute:"ar-scale"})],l.prototype,"arScale",void 0),wt([_({type:String,attribute:"ar-usdz-max-texture-size"})],l.prototype,"arUsdzMaxTextureSize",void 0),wt([_({type:String,attribute:"ar-placement"})],l.prototype,"arPlacement",void 0),wt([_({type:String,attribute:"ar-modes"})],l.prototype,"arModes",void 0),wt([_({type:String,attribute:"ios-src"})],l.prototype,"iosSrc",void 0),wt([_({type:Boolean,attribute:"xr-environment"})],l.prototype,"xrEnvironment",void 0),l};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oa=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const dm=100,gm="https://www.gstatic.com/draco/versioned/decoders/1.5.6/",pm="https://www.gstatic.com/basis-universal/versioned/2021-04-15-ba1c3e4/",fm="https://cdn.jsdelivr.net/npm/three@0.149.0/examples/jsm/loaders/LottieLoader.js",Pa={AUTO:"auto",MANUAL:"manual"},Pc={AUTO:"auto",LAZY:"lazy",EAGER:"eager"},ss=Symbol("defaultProgressBarElement"),Ha=Symbol("posterContainerElement"),is=Symbol("defaultPosterElement"),Ns=Symbol("shouldDismissPoster"),qa=Symbol("hidePoster"),Di=Symbol("modelIsRevealed"),ja=Symbol("updateProgressBar"),mm=Symbol("ariaLabelCallToAction"),$a=Symbol("onProgress"),bm=o=>{var e,t,i,s,n,a,r,A;class c extends o{static set dracoDecoderLocation(l){pe.setDRACODecoderLocation(l)}static get dracoDecoderLocation(){return pe.getDRACODecoderLocation()}static set ktx2TranscoderLocation(l){pe.setKTX2TranscoderLocation(l)}static get ktx2TranscoderLocation(){return pe.getKTX2TranscoderLocation()}static set meshoptDecoderLocation(l){pe.setMeshoptDecoderLocation(l)}static get meshoptDecoderLocation(){return pe.getMeshoptDecoderLocation()}static set lottieLoaderLocation(l){ke.singleton.textureUtils.lottieLoaderUrl=l}static get lottieLoaderLocation(){return ke.singleton.textureUtils.lottieLoaderUrl}static mapURLs(l){ke.singleton.loader[Qt].manager.setURLModifier(l)}dismissPoster(){this.loaded?this[qa]():(this[Ns]=!0,this[hs]())}showPoster(){const l=this[Ha];if(l.classList.contains("show"))return;l.classList.add("show"),this[Fe].classList.remove("show");const d=this[is];d.removeAttribute("tabindex"),d.removeAttribute("aria-hidden");const u=this.modelIsVisible;this[Di]=!1,this[an](u)}getDimensions(){return ht(this[x].size)}getBoundingBoxCenter(){return ht(this[x].boundingBox.getCenter(new G))}constructor(...l){super(...l),this.poster=null,this.reveal=Pa.AUTO,this.loading=Pc.AUTO,this[e]=!1,this[t]=!1,this[i]=this.shadowRoot.querySelector(".slot.poster"),this[s]=this.shadowRoot.querySelector("#default-poster"),this[n]=this.shadowRoot.querySelector("#default-progress-bar > .bar"),this[a]=this[is].getAttribute("aria-label"),this[r]=qu(f=>{const m=this[ss].parentNode;requestAnimationFrame(()=>{this[ss].style.transform=`scaleX(${f})`,f===0&&(m.removeChild(this[ss]),m.appendChild(this[ss])),this[ss].classList.toggle("hide",f===1)})},dm),this[A]=f=>{const m=f.detail.totalProgress,I=f.detail.reason;m===1&&(this[ja].flush(),this.loaded&&(this[Ns]||this.reveal===Pa.AUTO)&&this[qa]()),this[ja](m),this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:m,reason:I}}))};const d=self.ModelViewerElement||{},u=d.dracoDecoderLocation||gm;pe.setDRACODecoderLocation(u);const g=d.ktx2TranscoderLocation||pm;pe.setKTX2TranscoderLocation(g),d.meshoptDecoderLocation&&pe.setMeshoptDecoderLocation(d.meshoptDecoderLocation);const p=d.lottieLoaderLocation||fm;ke.singleton.textureUtils.lottieLoaderUrl=p}connectedCallback(){super.connectedCallback(),this.loaded||this.showPoster(),this[_t].addEventListener("progress",this[$a])}disconnectedCallback(){super.disconnectedCallback(),this[_t].removeEventListener("progress",this[$a])}async updated(l){super.updated(l),l.has("poster")&&this.poster!=null&&(this[is].style.backgroundImage=`url(${this.poster})`),l.has("alt")&&this[is].setAttribute("aria-label",this[uo]),(l.has("reveal")||l.has("loading"))&&this[hs]()}[(e=Di,t=Ns,i=Ha,s=is,n=ss,a=mm,r=ja,A=$a,fs)](){return!!this.src&&(this[Ns]||this.loading===Pc.EAGER||this.reveal===Pa.AUTO&&this[Tt])}[qa](){this[Ns]=!1;const l=this[Ha];if(!l.classList.contains("show"))return;l.classList.remove("show"),this[Fe].classList.add("show");const d=this.modelIsVisible;this[Di]=!0,this[an](d);const u=this.getRootNode();u&&u.activeElement===this&&this[Fe].focus();const g=this[is];g.setAttribute("aria-hidden","true"),g.tabIndex=-1,this.dispatchEvent(new CustomEvent("poster-dismissed"))}[Nt](){return super[Nt]()&&this[Di]}}return Oa([_({type:String})],c.prototype,"poster",void 0),Oa([_({type:String})],c.prototype,"reveal",void 0),Oa([_({type:String})],c.prototype,"loading",void 0),c};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Va=function(o,e,t,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var r=o.length-1;r>=0;r--)(a=o[r])&&(n=(s<3?a(n):s>3?a(e,t,n):a(e,t))||n);return s>3&&n&&Object.defineProperty(e,t,n),n};const Im=Math.PI/32,Em=3e3,Cm={basis:[En(le(Im,"rad"))],keywords:{auto:[null]}},ns=Symbol("autoRotateStartTime"),za=Symbol("radiansPerSecond"),Hc=Symbol("syncRotationRate"),Ka=Symbol("onCameraChange"),Bm=o=>{var e,t,i;class s extends o{constructor(){super(...arguments),this.autoRotate=!1,this.autoRotateDelay=Em,this.rotationPerSecond="auto",this[e]=performance.now(),this[t]=0,this[i]=a=>{this.autoRotate&&a.detail.source==="user-interaction"&&(this[ns]=performance.now())}}connectedCallback(){super.connectedCallback(),this.addEventListener("camera-change",this[Ka]),this[ns]=performance.now()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("camera-change",this[Ka]),this[ns]=performance.now()}updated(a){super.updated(a),a.has("autoRotate")&&(this[ns]=performance.now())}[(e=ns,t=za,Hc)](a){this[za]=a[0]}[He](a,r){if(super[He](a,r),!this.autoRotate||!this[Nt]()||this[K].isPresenting)return;const A=Math.min(r,a-this[ns]-this.autoRotateDelay);A>0&&(this[x].yaw=this.turntableRotation+this[za]*A*.001)}get turntableRotation(){return this[x].yaw}resetTurntableRotation(a=0){this[x].yaw=a}}return i=Ka,Va([_({type:Boolean,attribute:"auto-rotate"})],s.prototype,"autoRotate",void 0),Va([_({type:Number,attribute:"auto-rotate-delay"})],s.prototype,"autoRotateDelay",void 0),Va([rt({intrinsics:Cm,updateHandler:Hc}),_({type:String,attribute:"rotation-per-second"})],s.prototype,"rotationPerSecond",void 0),s};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym=Ff(gf(Bm(Yu(xp(um(bm(Lf(ai))))))));customElements.define("model-viewer",ym);export{lu as CanvasTexture,Lt as FileLoader,Eo as Loader,ym as ModelViewerElement,Ot as NearestFilter};
